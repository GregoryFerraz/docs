<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Reading and Parsing PDF Files &mdash; BPA/OpenIAP Docs 1.0.2 documentation</title>








  <script type="text/javascript" src="../../static/js/modernizr.min.js"></script>


  <script type="text/javascript" id="documentation_options" data-url_root="../../"
    src="../../static/documentation_options.js"></script>
  <script src="../../static/jquery.js"></script>
  <script src="../../static/underscore.js"></script>
  <script src="../../static/doctools.js"></script>
  <script src="../../static/language_data.js"></script>

  <script type="text/javascript" src="../../static/js/theme.js"></script>




  <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../static/styles.css" type="text/css" />
  <link rel="index" title="Index" href="../../genindex.html" />
  <link rel="search" title="Search" href="../../search.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">



          <a href="../../index.html" class="icon icon-home"> BPA/OpenIAP Docs



          </a>







          <div role="search">
            <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
              <input type="text" name="q" placeholder="Search docs" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
          </div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






          <ul>
            <li class="toctree-l1"><a class="reference internal" href="../../rpa.html">1. <strong>Introduction to
                  RPA</strong></a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../openflow.html">2.
                <strong>OpenFlow</strong></a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../openrpa.html">3.
                <strong>OpenRPA</strong></a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../node_red.html">4.
                <strong>Node-RED</strong></a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../appendix_a.html">5. <strong>Appendix
                  A</strong></a></li>
            <li class="toctree-l1"><a class="reference internal" href="../../appendix_b.html">6. <strong>Appendix
                  B</strong></a></li>
          </ul>
          <ul>
            <li class="toctree-l1"><a class="reference internal" href="../../license.html">1. License</a></li>
          </ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">BPA/OpenIAP Docs</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">

















          <div role="navigation" aria-label="breadcrumbs navigation">

            <ul class="wy-breadcrumbs">

              <li><a href="../../index.html">Docs</a> &raquo;</li>

              <li>Reading and Parsing PDF Files</li>


              <li class="wy-breadcrumbs-aside">



              </li>

            </ul>


            <hr />
          </div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div itemprop="articleBody">

              <div class="section" id="reading-and-parsing-pdf-files">
                <h1>Reading and Parsing PDF Files<a class="headerlink" href="#reading-and-parsing-pdf-files"
                    title="Permalink to this headline">¶</a></h1>
                <p>In this example, the user will create a <code
                    class="docutils literal notranslate"><span class="pre">Workflow</span></code> that extracts data
                  from a <code
                    class="docutils literal notranslate"><span class="pre">PDF</span> <span class="pre">file</span></code>,
                  processes the data gathered using <a class="reference external"
                    href="https://ryanstutorials.net/regular-expressions-tutorial/">Regular Expressions</a> (<code
                    class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/regular-expressions-tutorial/</span></code>)
                  and saves the data into a <code
                    class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">file</span></code>.
                </p>
                <p>First the user needs to download the invoice file which will be used to extract the data from. It is
                  available on <a class="reference external"
                    href="https://drive.google.com/file/d/1jCSvQ42ABkeJVcWksUNUftfiPSjZBlSs/view?usp=sharing">this
                    link</a> (<code
                    class="docutils literal notranslate"><span class="pre">https://drive.google.com/file/d/1jCSvQ42ABkeJVcWksUNUftfiPSjZBlSs/view?usp=sharing</span></code>).
                </p>
                <p>The steps are listed below:</p>
                <ol class="arabic simple">
                  <li>
                    <p>Extract text data from PDF.</p>
                  </li>
                  <li>
                    <p>Match Regular Expression groups.</p>
                  </li>
                  <li>
                    <p>Create <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> to
                      store results.</p>
                  </li>
                  <li>
                    <p>Add row to <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>.
                    </p>
                  </li>
                  <li>
                    <p>Save <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> into
                      CSV.</p>
                  </li>
                </ol>
                <div class="section" id="extract-data-from-pdf">
                  <h2>Extract data from PDF<a class="headerlink" href="#extract-data-from-pdf"
                      title="Permalink to this headline">¶</a></h2>
                  <p>In this section the user will learn how to extract text data from a PDF and save it into a
                    variable.</p>
                  <p>First of all, the user should drag a <strong>ReadPDF</strong> activity into the main sequence.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_readpdf.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_readpdf.png" />
                  </div>
                  <p>Then, click the <code class="docutils literal notranslate"><span class="pre">...</span></code>
                    button to select the file from which data will read. That is the invoice file just downloaded.</p>
                  <p>The user also needs to create a variable which will be used to hold the text generated by the
                    extraction with the <strong>ReadPDF</strong> activity. In this case, the variable is <code
                      class="docutils literal notranslate"><span class="pre">result</span></code>. It must be set inside
                    the <code class="docutils literal notranslate"><span class="pre">AllText</span></code> parameter,
                    available inside the <strong>Properties box</strong>.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_readpdf.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_readpdf.png" />
                  </div>
                  <div class="admonition note">
                    <p class="admonition-title">Note</p>
                    <p>OpenRPA is able to automatically create a new variable with the correct type required for the
                      Activity/property. While creating a new variable in the <strong>Properties box</strong>, after
                      typing the variable name and with the caret still inside the input field, by pressing <code
                        class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
                  </div>
                </div>
                <div class="section" id="match-regular-expression-groups">
                  <h2>Match Regular Expression groups<a class="headerlink" href="#match-regular-expression-groups"
                      title="Permalink to this headline">¶</a></h2>
                  <p>Now the user will use the <strong>Matches</strong> Activity to extract groups of data from the
                    string returned by <strong>ReadPDF</strong>.</p>
                  <p>First of all, the user should drag a <strong>Matches</strong> Activity into the main sequence.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_matches.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_matches.png" />
                  </div>
                  <p>In the first input box, containing the placeholder <code
                      class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">input</span> <span class="pre">string</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">against</span></code>,
                    the user will insert the content of the variable, that is, the text captured in the previous
                    section.</p>
                  <p>In the second input box, the user will insert the <strong>RegEx pattern</strong> used to divide
                    data into groups. The one used here is <code
                      class="docutils literal notranslate"><span class="pre">(\b[a-zA-Z0-9$.\-()</span> <span class="pre">]*)</span></code>.
                    For a thorough explanation on <strong>Regular Expressions</strong>, please refer to <a
                      class="reference external"
                      href="https://ryanstutorials.net/regular-expressions-tutorial/">RyansTutorials Regular
                      Expressions</a> (<code
                      class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/regular-expressions-tutorial/</span></code>).
                    It is interesting to remind the user that, since the <strong>RegEx pattern</strong> is captured as a
                    string, it must be enclosed in quotes. It is also recommended using the <a
                      class="reference external" href="https://regex101.com/">Regex101</a> (<code
                      class="docutils literal notranslate"><span class="pre">https://regex101.com/</span></code>) for
                    matching the groups and testing the pattern if needed.</p>
                  <p>The user must also configure the variable to which the matches will be saved (in this example,
                    <code class="docutils literal notranslate"><span class="pre">invoiceResults</span></code>) inside
                    the <code class="docutils literal notranslate"><span class="pre">Results</span></code> parameter in
                    the <strong>Properties box</strong>. It will be configured with type <strong>Match list</strong>, or
                    simply <code class="docutils literal notranslate"><span class="pre">Match[]</span></code>. As seen
                    in the image below.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_matches.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_matches.png" />
                  </div>
                </div>
                <div class="section" id="create-datatable-to-store-results">
                  <h2>Create DataTable to store results<a class="headerlink" href="#create-datatable-to-store-results"
                      title="Permalink to this headline">¶</a></h2>
                  <p>In this section, the user will create the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> used to store the
                    results and configure its header.</p>
                  <p>First, the user will drag a <strong>CreateDataTable</strong> activity to the sequence inside the
                    <strong>Matches</strong> activity.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_createdatatable.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_createdatatable.png" />
                  </div>
                  <p>Now, the user must create the variable in which the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> will be saved
                    inside the <cite>New DataTable variable</cite> placeholder. In this example, the variable is named
                    <code class="docutils literal notranslate"><span class="pre">invoiceDataTable</span></code>.</p>
                  <div class="admonition note">
                    <p class="admonition-title">Note</p>
                    <p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to
                      automatically create the variable when entering it upon an input field. Otherwise, the user can
                      create it manually by clicking the <strong>Variables box</strong> under the bottom part of the
                      screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
                  </div>
                  <p>The user must also define its headers inside the <cite>Array of DataTable columns</cite>
                    placeholder. Since in this example only three fields from the invoice are captured, namely <code
                      class="docutils literal notranslate"><span class="pre">Company</span> <span class="pre">Name</span></code>,
                    <code
                      class="docutils literal notranslate"><span class="pre">Invoice</span> <span class="pre">Number</span></code>
                    and <code
                      class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">Balance</span></code>,
                    the header will be defined as <code
                      class="docutils literal notranslate"><span class="pre">{&quot;Company</span> <span class="pre">Name&quot;,</span> <span class="pre">&quot;Invoice</span> <span class="pre">Number&quot;</span> <span class="pre">and</span> <span class="pre">&quot;Total</span> <span class="pre">Balance&quot;}</span></code>.
                  </p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_config_createdatatable.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_config_createdatatable.png" />
                  </div>
                  <div class="admonition note">
                    <p class="admonition-title">Note</p>
                    <p>A <code
                        class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code>
                      corresponds to one table of in-memory data contained in a <code
                        class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code>
                      from the class equally named. When you read an <code
                        class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>,
                      it is automatically assigned to a <code
                        class="docutils literal notranslate"><span class="pre">DataSet</span></code> class and all the
                      <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into
                      <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes -
                      numbered from 0 to the quantity of sheets inside the <code
                        class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>.
                      Here it is reminded that <code
                        class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case
                      sensitive.</p>
                  </div>
                </div>
                <div class="section" id="add-row-to-datatable">
                  <h2>Add row to DataTable<a class="headerlink" href="#add-row-to-datatable"
                      title="Permalink to this headline">¶</a></h2>
                  <p>Here the user will add the data gathered from the <code
                      class="docutils literal notranslate"><span class="pre">PDF</span> <span class="pre">file</span></code>
                    into the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>
                    defined in the previous section.</p>
                  <p>First, drag a <strong>AddDataRow</strong> activity into the sequence contained inside the
                    <strong>Matches</strong> activity.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_adddatarow.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_adddatarow.png" />
                  </div>
                  <p>Now, the user must insert the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> to which the data
                    will be inserted to inside the <cite>DataTable to insert to</cite> placeholder.</p>
                  <p>The user must also define the data that will be inserted.</p>
                  <p>The <code
                      class="docutils literal notranslate"><span class="pre">Company</span> <span class="pre">Name</span></code>
                    is the <code
                      class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code>
                    of no. 1 inside the <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will
                    be assigned as <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults(0).ToString</span></code>.
                  </p>
                  <p>The <code class="docutils literal notranslate"><span class="pre">invoiceNumber</span></code> is the
                    <code
                      class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code>
                    of no. 2 inside the <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will
                    be assigned as <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults(2).ToString</span></code>.
                  </p>
                  <p>The <code class="docutils literal notranslate"><span class="pre">invoiceTotalBalance</span></code>
                    is the <code
                      class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code>
                    of no. 3 inside the <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will
                    be assigned as <code
                      class="docutils literal notranslate"><span class="pre">invoiceResults(44).ToString</span></code>.
                  </p>
                  <p>Therefore, the row which will be added inside the <cite>Array of DataTable columns</cite>
                    placeholder is <code
                      class="docutils literal notranslate"><span class="pre">{invoiceResults(0).ToString,</span> <span class="pre">invoiceResults(2).ToString,</span> <span class="pre">invoiceResults(44).ToString}</span></code>.
                    It is shown below.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_adddatarow.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_configure_adddatarow.png" />
                  </div>
                </div>
                <div class="section" id="save-datatable-into-csv">
                  <h2>Save DataTable into CSV<a class="headerlink" href="#save-datatable-into-csv"
                      title="Permalink to this headline">¶</a></h2>
                  <p>The user will now save the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> created in a CSV
                    file.</p>
                  <p>First, drag a <strong>WriteCSV</strong> file into the main sequence.</p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_writecsv.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_read_and_parsing_pdf_drag_writecsv.png" />
                  </div>
                  <p>Now, click the <code class="docutils literal notranslate"><span class="pre">...</span></code>
                    button to insert the <code
                      class="docutils literal notranslate"><span class="pre">filepath</span></code> of the CSV file
                    which the data will be saved to - in this example, <code
                      class="docutils literal notranslate"><span class="pre">invoice1.csv</span></code>.</p>
                  <p>Then, insert the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> which was captured
                    into the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> inside
                    its <strong>Properties box</strong>. In this example, this variable is the <code
                      class="docutils literal notranslate"><span class="pre">DataTable</span></code> defined in the
                    previous section - i.e., <code
                      class="docutils literal notranslate"><span class="pre">invoiceDataTable</span></code>.</p>
                  <p>Finally, change the <code
                      class="docutils literal notranslate"><span class="pre">Delimiter</span></code> parameter to <code
                      class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code>.</p>
                </div>
                <div class="section" id="workflow-finished">
                  <h2>Workflow Finished<a class="headerlink" href="#workflow-finished"
                      title="Permalink to this headline">¶</a></h2>
                  <p>A <code
                      class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">file</span></code>
                    is generated, which can be opened on <strong>Excel</strong> application or <strong>Notepad</strong>.
                  </p>
                  <div class="figure align-center">
                    <img
                      alt="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_workflow_finished_csv.png"
                      src="adam_package_02b\done\images/reading_and_parsing_pdf_files/openrpa_workflow_example_workflow_finished_csv.png" />
                  </div>
                </div>
              </div>


            </div>

          </div>
          <footer>


            <hr />

            <div role="contentinfo">
              <p>
                &copy; Copyright 2020, Paulo Veras, Thiago Pestitschek, Diego Thijssen

              </p>
            </div>
            Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a
              href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a
              href="https://readthedocs.org">Read the Docs</a>.
            <p>Powered by <a href="https://bpatechnologies.com/">BPA Technologies</a></p>



          </footer>

        </div>
      </div>

    </section>

  </div>



  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.Navigation.enable(true);
    });
  </script>





  <h4>>Powered by BPA Technologies - bpatechnologies.com</h4>


</body>

</html>
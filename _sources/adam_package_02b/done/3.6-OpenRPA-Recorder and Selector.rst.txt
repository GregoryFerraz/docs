.. 3.6.
***************************
 **Recorder and Selectors**
***************************
Recording is the recommended method to create Workflows inside **OpenRPA**. Instead of endlessly dragging activities into the Designer, it is preferable that the user records the steps by using the **Recorder**.

Using the **Recorder** is very easy, all the user has to do is click the **Recorder** button and do the task which will be automated as usual. If during the recording the user finds interesting to fill, lets say, an input field with some specific variable content, the user may use a dummy text and, after closing the **Recorder**, change these dummy texts to variables by using the Assign activity.

**Selectors** go hand in hand with the **Recorder**. The **Recorder** basically builds a **Selector** for the user, given what is clicked. Selector is set of criteria and, with it, **OpenRPA** is expected to be able to find an element, unambiguously.
Notice that the user is free to create a **Selectors** from scratch, although it is **NOT** recommended (not only it is harder but also prone to errors and typos).

.. figure:: images/chap_recorder/openrpa_recorder_what_is_selector.png
   :align: center

A thorough example showing how to automate using the **Recorder** is shown in the :ref:`Windows Automation` section.

**OpenRPA** allows some configuration related to the **Recorder** to be customized, such as to highlight elements while the recording is happening or to change how the **Recorder** add activities to the Designer. See more at :ref:`Parameters`, specially ``recording_add_to_designer`` and ``record_overlay``.

.. 3.6.1.
Difference between technologies (NM, SAP, Windows, ...)
=======================================================
At first, when clicking any element during a recording, the **Recorder** will assume that the element clicked belongs to a Windows UI element. Then, it will process some logic and check if there are any better technologies that would fit into whatever action the user is attempting to record. If it finds one, the **Recorder** will automatically replace the technology from "Windows" to the most appropriate technology and will suggest an Activity that better handles the automation, be it clicking on a WebElement, filling an input field in SAP or writing data to an Excel sheet. If the logic to find a different technology fails, i.e., does not find anything more useful, the **Recorder** will build a **Selector** for a ``Windows UI Element``.

In simpler words, when using the **Recorder** and clicking an Excel cell, the **Recorder** will first assume that the element is a ``Windows UI element``, but then it will realize that it is an ``Excel element`` and then will automatically replace the Activity from ``Windows.GetElement`` to ``Office.Activities.WriteCell``, since that would be better fitting for the task.

There are many technologies already implemented, such as **SAP**, **IE**, **Java**, **Image** and **NM** (NativeMessaging: Chrome, Firefox, Edge) and many more to come!

.. 3.6.2.
Returning multiple elements
===========================
Sometimes it is needed to retrieve multiple elements instead of a single one and that can be achieved by adjusting the **Selector**. E.g.: After doing a search on Google, many results are presented and the user wants to manipulate all of them, not only first one.

Here is a quick example of how it can be done. Still on the Google search example, using the **Recorder**, select an entry from any of the results.

.. figure:: images/chap_recorder/openrpa_recorder_click_element.png
   :align: center

Notice how the **Recorder** assumed that you only wanted that specific entry and how the **Selector** was built considering that.

.. figure:: images/chap_recorder/openrpa_recorder_change_selector.png
   :align: center

To make it return not only one but multiple elements, first change the ``MaxResults`` property to a number higher than 1 (there is not a upper limit).

.. figure:: images/chap_recorder/openrpa_recorder_add_max_results_and_click_open_selector.png
   :align: center

Now, the **Selector** criteria must be changed so it returns an array of elements and not a single one. When working with WebElements, that can be done by changing the ``xpath`` such that it return broader results.

.. figure:: images/chap_recorder/openrpa_recorder_change_selector_2.png
   :align: center

Now, to make the Activity loop each element of this broader array of elements, include another ``GetElement`` Activity inside the sequence that was originally created by the **Recorder**.

.. note ::
   Use the GetElement Activity related to the technology that the Recorder is working with. If using Windows elements, it should be Windows.GetElement. Same applies to other technologies: OpenRPA.IE.GetElement, OpenRPA.Image.GetElement, OpenRPA.NM.GetElement etc.

.. figure:: images/chap_recorder/openrpa_recorder_add_get_element.png
   :align: center

By opening the **Selector** on the newly created ``GetElement``, on the left you will find an ``Element Tree`` which allows you to further select what should be manipulated. Use the ``Highlight`` button to debug and check if you are selecting the right element.

.. figure:: images/chap_recorder/openrpa_recorder_elements_highlighted.png
   :align: center

Now, if further automation is required for each specific entry, add those activities inside the inner ``GetElement``.

.. 3.6.3.
Manually Adjusting Selectors
============================
Working in progress - Coming soon.

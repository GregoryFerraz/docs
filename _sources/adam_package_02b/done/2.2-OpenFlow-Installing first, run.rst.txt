.. 2.2.
**************************
 **Installing, First Run**
**************************
This section's purpose is to help the user install an **OpenFlow** instance **locally**. If you already have an **OpenFlow** URL provided, you may skip this step.

In order to proceed with the local installation, the following are required:

* `NodeJS <https://nodejs.org/en/>`_ (``https://nodejs.org/en/``) - preferably using `nvm <https://github.com/nvm-sh/nvm>`_ (``https://github.com/nvm-sh/nvm``)
* `MongoDB Community Server <https://www.mongodb.com/try/download/community>`_ (``https://www.mongodb.com/try/download/community``)
* `RabbitMQ <https://www.rabbitmq.com/download.html>`_ (``https://www.rabbitmq.com/download.html``).

.. 2.2.1
Quickstart Running OpenFlow using NPM
=====================================
In this section lies a brief and concise description of how to install **OpenFlow** through NPM.

Then, the user must run the following command from a command prompt with escalated privileges ("Run as administrator") in Windows 10.

.. code-block:: powershell

   npm install --global windows-built-tools


If using any GNU/Linux distro which uses the ``APT`` package manager, the following command replaces the one above.

.. code-block:: powershell

   sudo apt-get install gcc g++ make

Then, the user must install the ``openiap`` package.

.. code-block:: powershell

   npm i openiap -g

Then, the user shall create a template configuration file.

.. code-block:: powershell

   openflow-cli --init


Now the user can install the service.

.. code-block:: powershell

   openflow-cli --install openflow

In order to access **OpenFlow**, all that is left to do is access the `OpenFlow page <http://localhost.openrpa.dk>`_ (``http://localhost.openrpa.dk``).

.. 2.2.2.
Developer Setup
===============
If you have interest in creating a developer setup in order to develop some extra features yourself or to debug, in this section you will find a brief and concise description of how to install **OpenFlow** by cloning `OpenFlow's GitHub Repository <https://github.com/open-rpa/openflow>`_ (``https://github.com/open-rpa/openflow``) and running it in **Visual Studio Code**.

Obviously, `Visual Studio Code <https://code.visualstudio.com/download>`_ (``https://code.visualstudio.com/download``) is required.

First, the user must clone the repository.

.. code-block:: powershell

   git clone https://github.com/open-rpa/openflow

Then, the user must initialize a command prompt and redirect it to the directory.

.. code-block:: powershell

   cd openflow

Now the user must install ``gulp`` and ``typescript`` globally.

.. code-block:: powershell

   npm i gulp typescript browserify tsify -gather

And also install the packages mentioned in ``packages.json`` for the project.

.. code-block:: powershell

   npm i

Now the user must do the same for the packages required by **Node-RED**.

.. code-block:: powershell

   cd openflow_node_red_configure_form
   npm i
   cd ..

Now the user will open the working folder in VS Code.

.. code-block:: powershell

   code OpenFlow.code-workspace

And create a folder called ``config`` at the top level of the **OpenFlow** folder. Inside it create a file called ``.env`` - be careful, notice that the file's name starts with a dot!

Lastly, the user shall add the following content to the ``.env`` file:

.. code-block:: powershell

   nodered_id=nodered1
   nodered_sa=nodered1
   port=80
   nodered_port=1880
   nodered_domain_schema=$nodered_id$.localhost.openrpa.dk
   tls_crt=
   tls_key=
   tls_ca=

   signing_crt=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURqRENDQW5TZ0F3SUJBZ0lKQUp5N0tI
   MTE1dkQ4TUEwR0NTcUdTSWIzRFFFQkN3VUFNRnN4Q3pBSkJnTlYKQkFZVEFrUkxNUk13RVFZRFZRUUlEQXBUY
   jIxbExWTjBZWFJsTVNFd0h3WURWUVFLREJoSmJuUmxjbTVsZENCWAphV1JuYVhSeklGQjBlU0JNZEdReEZEQV
   NCZ05WQkFNTUMzTnBaMjVwYm1kalpYSjBNQjRYRFRFNU1EUXdOekUwCk5ETXpORm9YRFRJNU1EUXdOREUwTkR
   Nek5Gb3dXekVMTUFrR0ExVUVCaE1DUkVzeEV6QVJCZ05WQkFnTUNsTnYKYldVdFUzUmhkR1V4SVRBZkJnTlZC
   QW9NR0VsdWRHVnlibVYwSUZkcFpHZHBkSE1nVUhSNUlFeDBaREVVTUJJRwpBMVVFQXd3TGMybG5ibWx1WjJObG
   NuUXdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCCkFRQy9JSkdEaGxLTU9SWkoycXQ
   wSWpjSDZOWUFtZDVxQzQ4dkNJRE54QWZCbmQxQnN4WlVjWkl5dkFlT28yNDcKM3I0eTYwNDgxRHVUS2JaMTBTN
   jRqRU05aW1XTXB1TFlJRnVyQ3BWNzVEWWhxMS85Q0FJVHJqNjlmVDluSkptcwpjM2lxTnJ1Tlg1bDlISXdadWt
   QM1ZNRkJRNWZVd3N1ZnE0YW1NbnVnZmtyUEVzSngxK3VJb0NYU3pyblZvcnZpClZ0ZFh4a3M4N0l1S0ZnMDJIZ
   1RQSzdwc0FXYTBRY3g2ck04bkV5TUhwNUdlR1Rvb1NNbkcyZ1RGNWZOSVFNdTMKVEVoc2p3SWRTYmRwck1Gb1V
   ZV05Bc2FueTJOQk0wREhZRUdjQlZhZ0xWNUhFUW5ySUM3NEhtNjYxdG9HaU5VSAoveW04U3VndTgwWVFiVGxPc
   TFWNnNkaVRBZ01CQUFHalV6QlJNQjBHQTFVZERnUVdCQlMrYWc1NGtITllKZ29pCm9yRnlia293THR5R3ZqQWZ
   CZ05WSFNNRUdEQVdnQlMrYWc1NGtITllKZ29pb3JGeWJrb3dMdHlHdmpBUEJnTlYKSFJNQkFmOEVCVEFEQVFIL
   01BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQTZpZHBYdzdSR2pzcUpNanI2c1YvaQpXeXFsL2xkSy9sa1NCdnN
   BSENieDdQYi9rVUd2NHJNbndYMnBHdTR0YkFnSDc4eStmS3dzazllYkxDeTA4Y1k0Ckt5czhzbUpLenhWN0R6U
   3RVR1NvZmZMaFliVVVMK3UyNU5vVXc0TG1WQU5FU0NaMTZ3aTdPQUdJMkJnNFR6TXoKdnlIUHRaaE9wTXBNV2lz
   M2ZnRXFzV3QxS2VLcXo0Z2M5RnJtZDZPNlQzVVAxWTRBR3VEWnNScnpiU2RQS2JxbApxekprT2tQcGtHOGo3ZjF
   WNkk1ZlkzblZaSWk2YW1TcTM1RTJkQzVMY0dIQXRtT1lWL0c4TEQ3OUFnTVpFUU5vCkF2R2RnV1gvbXBFVkFjM
   mRFQkJlcUN6WjF1aVhWUjdERld2ZDFKTEpsdVRyTm9jMUROc0xNKzNEZFFiQ2JnYVcKLS0tLS1FTkQgQ0VSVElG
   SUNBVEUtLS0tLQo=
   singing_key=LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZB
   QVNDQktjd2dnU2pBZ0VBQW9JQkFRQy9JSkdEaGxLTU9SWkoKMnF0MElqY0g2TllBbWQ1cUM0OHZDSUROeEFmQm
   5kMUJzeFpVY1pJeXZBZU9vMjQ3M3I0eTYwNDgxRHVUS2JaMQowUzY0akVNOWltV01wdUxZSUZ1ckNwVjc1RF
   locTEvOUNBSVRyajY5ZlQ5bkpKbXNjM2lxTnJ1Tlg1bDlISXdaCnVrUDNWTUZCUTVmVXdzdWZxNGFtTW51Z2
   ZrclBFc0p4MSt1SW9DWFN6cm5Wb3J2aVZ0ZFh4a3M4N0l1S0ZnMDIKSGdUUEs3cHNBV2EwUWN4NnJNOG5FeU
   1IcDVHZUdUb29TTW5HMmdURjVmTklRTXUzVEVoc2p3SWRTYmRwck1GbwpVWVdOQXNhbnkyTkJNMERIWUVHY0
   JWYWdMVjVIRVFucklDNzRIbTY2MXRvR2lOVUgveW04U3VndTgwWVFiVGxPCnExVjZzZGlUQWdNQkFBRUNnZ0V
   BVXBjZ1NsV2hGamNWQ3BVVHdmdUhERVB4TmhGSHEwdVRkQitZaVZKTWg3NVAKL2pRRlVqaEJsT3JyMlJlR2F4
   aTEyQXNXby9LU1MrV2Frdzd4d1kzYkFKenRoUG9Zekl3dkVKcGlQa2MvblEwUgpUYVpJUDNqc1k3WGIwQlpn
   MGNTVVAvbW0wbENkWXhNUzk0c21FNXJzWitkdGxPTVlXc2NrU0cxSVB2SlVJV2FZCnl3NC9kaHJ3TWRsREVZS
   2tSbks1aDR1dXR1dzA1Q1VzNkZWN2F5cEJRRStGM3RxVlF3QWxGbWNueXdvZTB5WjQKZW1tWkRvT1dzNUk4cG
   NGbjZCSW1wZjN3UEg5UWhlQXJVaXRqV3YrZmI2cWRVaHJFVDBxMzh4dTZ5M1lJNFNLYQpXME9kUng4L3FTYll
   XdkpzbmxscDR0aUpDWE5IdnV6MVBKSGhxOUprQVFLQmdRRCt2dHlWcVJoaEJZTmd6WWorClFCaDNLcktrNEVqT
   XZaSGhEelhES0pMZ2JEVmJzNExrQkYySWZGOTF0S1k3d09CNVpXcU82Z3FqVVJBVE5hc1YKOExCOGE2TEpXYVJ
   uTklLMnJkd1FwalFYcy92OVBSYnJwc2tTbDRJdUsyZWNBMjBSQkhicW5yNHZ5ZkQ4U3BzaApSdHlTUk5CRGVsaU
   01Z1JDM0JKKzBZbjBVUUtCZ1FEQUVZSUp3Y2xnQloyWmNNTlh1dW1lLzUxdHBHeGppRTJpCjZ3SDNsOHNTVDN1U
   1A4MHdndGdHaVFsUTRsR3BmSThqWkl4N0pwcGw0Qko1ZEtuVnpIS1dqMzA3YXYxcjdpU3QKLzJOVDNobzdaYkNl
   YzlhMHlJU2E3dTNGZGxzZ0VPcE45dURmbG5GQVQ3ZmIrM2d4Sk9DUWp1TkFCZXZaK2pScwpZY0ZhQWhGNW93S0J
   nUUNGUG9HVVNsRDFGblFrWXYwL3QzalVnK0hTK1hrNmxnRkNqYmthTGhPOURQeFB6Ykl0CjM5YW9lQjFhTExZeV
   ZPMVVzZVl0Z0Y4MkUwVnNOc3NZKzc3a0pVeU5NclVhUWs0SWpTR3BGN1h4bS9PMi9vZ0oKbEVCaDJCdUFXTFdsM
   WVqcldNRjJjTGVidVcyeUdMZlJqUVg3LzhCTE95Z3I4bmZTSE5nVHV6Z0VNUUtCZ0JrZgpNUjhObGNWVmRyT25L
   Q1hGY09FM0ZlUk5hVS9yZUJ3akdQTEZpKzR0TDBDRno5VFVpR1R5YjZHQXVLV3VnUnBrCkFHdnJOSzYyakRRT3F
   sZ29rYVJYeUUySlJQUmxCYThzaEZWbjY0NXhVcFNuR2lJelNBVHIwM1hNY1ViVWI1RWIKQlhhNU9yN3FybVc3a3
   BENi9kUnFuQmEzcjQyblNFd1V6VEYwcTh4NUFvR0FIcXdRSyt1R0NTdlNsNENJUGhyRQpDREIvcytDK2NJNXVCe
   FJCMHVlNjc3L2lpdGZPSU9lOUNiTHE3R0tib0w4RVg3eXhKNVRLWjlYQmh5LzNCWmVNCllydEx3M2JicTNTN2hp
   UGFYSmE1dXZma3BWR1RnNEdzTnBJQ3VNTEJUaXJ6M0ZRV25UNFNZbzkrREVoalhEeVQKWlVOMERtUkJVNjNjWjR
   SUlXd2xWUTA9Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
   NODE_ENV=development

   saml_federation_metadata=http://localhost.openrpa.dk/issue/FederationMetadata/2007-06/FederationMetadata.xml
   saml_issuer=uri:localhost.openrpa.dk
   # saml_entrypoint=http://localhost.openrpa.dk/issue
   # saml_baseurl=http://localhost.openrpa.dk:1880/

   allow_personal_nodered=false
   allow_user_registration=true
   # mongodb_url=mongodb://localhost:27017
   # mongodb_db=openflow

   # api_bypass_perm_check=true
   update_acl_based_on_groups=true
   multi_tenant=false

   websocket_max_package_count=1048576

   api_ws_url=ws://localhost.openrpa.dk
   domain=localhost.openrpa.dk
   protocol=http
   amqp_url=amqp://localhost
   aes_secret=7TXsxf7cn9EkUqm5h4MEWGjzkxkNCk2K
   auto_create_users=true
   auto_create_domains=
   skip_history_collections=audit,jslog

If using **Windows 10**, allow Powershell Scripts to run by changing the Execution Policy using the following command in a Powershell Prompt with escalated privileges.

.. code-block:: powershell

   Set-ExecutionPolicy Bypass --Force

Finally, run ``OpenFlow`` by pressing ``Ctrl+Shift+D``, selecting ``OpenFlow`` in the dropdown box and clicking the **Play** button.

The user may now access **OpenFlow** by using a browser and navigating to the default URL, which is ``http://localhost.openrpa.dk`` if unchanged.

To properly install and configure **Node-RED**, please refer to the **Installing & First Run** section in the **Node-RED** chapter.



<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Workflow Examples &mdash; BPA/OpenIAP Docs 1.0.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="static/documentation_options.js"></script>
        <script src="static/jquery.js"></script>
        <script src="static/underscore.js"></script>
        <script src="static/doctools.js"></script>
        <script src="static/language_data.js"></script>
    
    <script type="text/javascript" src="static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="static/styles.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> BPA/OpenIAP Docs
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="rpa.html">1. <strong>Introduction to RPA</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="openflow.html">2. <strong>OpenFlow</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="openrpa.html">3. <strong>OpenRPA</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="node_red.html">4. <strong>Node-RED</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_a.html">5. <strong>Appendix A</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix_b.html">6. <strong>Appendix B</strong></a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="license.html">1. License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BPA/OpenIAP Docs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><strong>Workflow Examples</strong></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="workflow-examples">
<h1><strong>Workflow Examples</strong><a class="headerlink" href="#workflow-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="web-automation">
<h2>Web Automation<a class="headerlink" href="#web-automation" title="Permalink to this headline">¶</a></h2>
<p>In this example, the <a class="reference external" href="http://www.rpachallenge.com/">RPA Input Forms Challenge</a> (<code class="docutils literal notranslate"><span class="pre">http://www.rpachallenge.com/</span></code>) will be solved.</p>
<p>As recommended, the Recorder will be used to facilitate the designing process.</p>
<p>The steps are listed below.</p>
<ol class="arabic simple">
<li><p>Download the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>.</p></li>
<li><p>Read the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>.</p></li>
<li><p>Map Start button.</p></li>
<li><p>Loop the DataSet rows.</p></li>
<li><p>Find the respective handle for each WebElement input field.</p></li>
<li><p>Fill all the required fields inside the webpage.</p></li>
<li><p>Map Submit button.</p></li>
</ol>
<div class="section" id="download-the-excel-file">
<h3><strong>Download the Excel file</strong><a class="headerlink" href="#download-the-excel-file" title="Permalink to this headline">¶</a></h3>
<p>To download the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, use the <strong>DownloadFile</strong> activity, found inside the <code class="docutils literal notranslate"><span class="pre">OpenRPA.Utilities</span></code> toolbox.</p>
<p>Drag the activity to the main sequence inside the Designer.</p>
<p>Click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button to select the path of the file to which the archive will be saved or assign the <code class="docutils literal notranslate"><span class="pre">LocalPath</span></code> parameter inside the Properties tab of the activity.</p>
<p>Paste the URL from the archive which you want to fetch. It is useful to remember that, since the URL will be acquired by OpenRPA as a <code class="docutils literal notranslate"><span class="pre">string</span></code>, it must be contained within <code class="docutils literal notranslate"><span class="pre">&quot;</span></code> quotes.</p>
<div class="figure align-center">
<img alt="images/openrpa_rpa_challenge_downloadfile.png" src="images/openrpa_rpa_challenge_downloadfile.png" />
</div>
</div>
<div class="section" id="read-the-excel-file">
<h3><strong>Read the Excel file</strong><a class="headerlink" href="#read-the-excel-file" title="Permalink to this headline">¶</a></h3>
<p>The ReadExcel activity will read from an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> and save it into a variable.</p>
<p>All the steps here are visibly explained at the <strong>How to read from an ``Excel file``</strong>.</p>
<p><strong>How to read from an Excel file</strong></p>
<p>Drag the <strong>ReadExcel</strong> activity, found inside the <code class="docutils literal notranslate"><span class="pre">OpenRPA.Utilities</span></code> toolbox, to the main sequence.</p>
<p>Select the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> which will be read by clicking the <code class="docutils literal notranslate"><span class="pre">...</span></code> button and find the file path in explorer where the sheet you want to read is found.</p>
<p>Then, by clicking the <code class="docutils literal notranslate"><span class="pre">...</span></code> button, the user will be prompted by an explorer window and there select the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> that should be used.</p>
<p>The <strong>ReadExcel</strong> activity will read this <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> and save it into a variable.</p>
<p>As this variable does not exist yet, it must first be created. Remember that variable must be obligatorily set with the type <strong>System.Data.DataSet</strong>. Simply click in the <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> input field inside the <strong>Properties tab</strong>, type the name of the variable you want to use and press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
<p>Now the user may either create the variable inside the <strong>Variables, Arguments &amp; Imports box</strong> or follow the note below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenRPA is able to automatically create a new variable with the correct type required for the Activity/property. To create a new variable in the <strong>Properties box</strong>, type the variable name and with the caret still inside the input field, press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> corresponds to the whole sheet. Each <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">Sheet1</span></code>) corresponds to each sheet inside that <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. The <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class is the object temporarily in-memory cache - created to store all the data consumed from this <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. For more on the <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class, refer to the link to Microsoft’s Documentation on the <a class="reference external" href="https://docs.microsoft.com/en-us/dotnet/api/system.data.dataset?view=netcore-3.1">DataSet Class</a> (<code class="docutils literal notranslate"><span class="pre">https://docs.microsoft.com/en-us/dotnet/api/system.data.dataset?view=netcore-3.1</span></code>).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code> corresponds to one table of in-memory data contained in a <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> from the class equally named. When you read an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, it is automatically assigned to a <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class and all the <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes - numbered from 0 to the quantity of sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. Here it is reminded that <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case sensitive.</p>
</div>
</div>
<div class="section" id="map-the-start-button">
<h3><strong>Map the Start button</strong><a class="headerlink" href="#map-the-start-button" title="Permalink to this headline">¶</a></h3>
<p>The challenge starts by clicking the <strong>Start button</strong>.</p>
<p>To map the process of starting the challenge, simply click the white triangle corresponding to the space below the <strong>Read Excel</strong> activity. Start the Recorder and click the <strong>Start</strong> button inside the browser, as shown in the steps below.</p>
<p>In order to cease recording, simply press the <code class="docutils literal notranslate"><span class="pre">ESC</span></code> button.</p>
<p>It is reminded here that ending the recording is obligatory, else it will record all activities you execute endlessly.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_start_button.png" src="images/openrpa_workflow_example_rpa_challenge_map_start_button.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_start_button_click.png" src="images/openrpa_workflow_example_rpa_challenge_map_start_button_click.png" />
</div>
<p>After successfully mapping the <strong>Start</strong> button, your workflow should look like the last image on the next page.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_start_button_final.png" src="images/openrpa_workflow_example_rpa_challenge_map_start_button_final.png" />
</div>
</div>
<div class="section" id="loop-the-dataset-rows">
<h3><strong>Loop the DataSet rows</strong><a class="headerlink" href="#loop-the-dataset-rows" title="Permalink to this headline">¶</a></h3>
<p>Now it is time to populate the input forms inside the page with the data we’ve gathered from the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>.</p>
<p>Drag the <strong>Foreach DataRow</strong> activity, found inside the <code class="docutils literal notranslate"><span class="pre">OpenRPA</span></code> toolbox. Then inside the <strong>Foreach DataRow</strong> activity, drag a <strong>Sequence</strong> activity, from the <code class="docutils literal notranslate"><span class="pre">System.Activites</span></code> toolbox.</p>
<p>As stated before, each sheet inside the <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> assigned from the <strong>Read Excel</strong> activity is saved in-memory as a collection inside the <code class="docutils literal notranslate"><span class="pre">Tables</span></code> attributes.</p>
<p>Each sheet inside the <code class="docutils literal notranslate"><span class="pre">Tables</span></code> attribute is acquired accordingly to the sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, these sheets are numbered starting from 0. As an example, if you were to add a row to a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> inside that <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, you’d first assign it to a <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">class</span></code> object and use the activity to add that row to the table.</p>
<p>You can acquire each row by assigning a single variable to the one you want to capture, with numbers starting from 0, or you can use the <strong>Foreach DataRow</strong> to automatically loop through each row accordingly. In our case the <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> is assigned to the <code class="docutils literal notranslate"><span class="pre">ds</span></code> variable, that is the one which will be used to retrieve the <code class="docutils literal notranslate"><span class="pre">Table</span></code> from. Since there is only one sheet, the <code class="docutils literal notranslate"><span class="pre">ds.Tables(0)</span></code> is used to assign the <code class="docutils literal notranslate"><span class="pre">Table</span></code> from where the <strong>Foreach DataRow</strong> will retrieve the values.</p>
<p>After assigning the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> where the rows are going to be retrieved from, it is noted here that the columns are mapped to attributes inside the variable assigned to the left-hand side of the <strong>Foreach DataRow</strong> activity - in our case <code class="docutils literal notranslate"><span class="pre">row</span></code> to return or set the value of a <code class="docutils literal notranslate"><span class="pre">DataColumn</span></code>.</p>
<p>The <strong>Foreach DataRow</strong> loop basically iterates through every value in the row (<code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Last</span> <span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Company</span> <span class="pre">Name</span></code>, …) and assign it to the <code class="docutils literal notranslate"><span class="pre">XPath</span></code> selector item inside the webpage where each field belongs. This causes the value inside the <a class="reference external" href="http://www.rpachallenge.com/">RPA Input Forms Challenge</a> (<code class="docutils literal notranslate"><span class="pre">http://www.rpachallenge.com/</span></code>) page to be populated.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DataRow</span> <span class="pre">object</span></code> refers to each row mapped from the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>. By using the <code class="docutils literal notranslate"><span class="pre">DataRow</span></code> object and its properties and methods the user is able to retrieve and evaluate; insert, delete and update the values inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>. The <code class="docutils literal notranslate"><span class="pre">DataRowCollection</span></code> also represents the actual <code class="docutils literal notranslate"><span class="pre">DataRow</span></code> objects inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>. Each column mapped from it can be retrieved by using its index as an attribute of the <code class="docutils literal notranslate"><span class="pre">DataRow</span></code> class object, if you’d like to retrieve the 1st column inside the row, you’d use <code class="docutils literal notranslate"><span class="pre">row(0)</span></code>. For more on the <code class="docutils literal notranslate"><span class="pre">DataRow</span></code> class, refer to the link to Microsoft’s Documentation on the <a class="reference external" href="https://docs.microsoft.com/en-us/dotnet/api/system.data.datarow?view=netcore-3.1">DataRow Class</a> (<code class="docutils literal notranslate"><span class="pre">https://docs.microsoft.com/en-us/dotnet/api/system.data.datarow?view=netcore-3.1</span></code>).</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_loop_through_each_assign_row.png" src="images/openrpa_workflow_example_rpa_challenge_loop_through_each_assign_row.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_excel.png" src="images/openrpa_workflow_example_rpa_challenge_excel.png" />
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="find-the-respective-handle-for-each-webelement-input-field">
<h3><strong>Find the respective handle for each WebElement input field</strong><a class="headerlink" href="#find-the-respective-handle-for-each-webelement-input-field" title="Permalink to this headline">¶</a></h3>
<p>By using the Recorder and clicking on each input field found in the <a class="reference external" href="http://www.rpachallenge.com/">RPA Input Forms Challenge</a> (<code class="docutils literal notranslate"><span class="pre">http://www.rpachallenge.com/</span></code>) page, it is possible to easily find the best handles to each WebElement being clicked.</p>
<p>As this workflow deals with WebElements manipulation, usually the best handles are Element.ID, Element.Name, Element.ClassName and so on. In our case, the <code class="docutils literal notranslate"><span class="pre">ng-reflect-name</span></code> attribute is used along with the <code class="docutils literal notranslate"><span class="pre">XPath</span></code> selector to provide a means of capturing a given element.</p>
<p>Once you start recording, click a single input field inside the <a class="reference external" href="http://www.rpachallenge.com/">RPA Input Forms Challenge</a> (<code class="docutils literal notranslate"><span class="pre">http://www.rpachallenge.com/</span></code>) page. As usual, we recommend capturing the first field - that is - <code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">Name</span></code> and then proceeding to the others.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_web_element.png" src="images/openrpa_workflow_example_rpa_challenge_map_web_element.png" />
</div>
<p>After clicking an input field, a prompt window will appear with the title <code class="docutils literal notranslate"><span class="pre">InsertText</span></code>, simply press <code class="docutils literal notranslate"><span class="pre">Enter</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_web_element_capture_input_field.png" src="images/openrpa_workflow_example_rpa_challenge_map_web_element_capture_input_field.png" />
</div>
<p>In order to cease recording of the current input field, simply press the <code class="docutils literal notranslate"><span class="pre">ESC</span></code> button.</p>
<p>It is reminded here that ending the recording is obligatory, or else it will record all activities you execute endlessly.</p>
<p>Then, a new <code class="docutils literal notranslate"><span class="pre">OpenRPA.NM.GetElement</span></code> activity will appear inside the <strong>Foreach DataRow</strong> sequence.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_web_element_sequence_after_capture.png" src="images/openrpa_workflow_example_rpa_challenge_map_web_element_sequence_after_capture.png" />
</div>
<p>It is desirable that the user change the name of each activity to the corresponding input field. As shown in the image below.</p>
<div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_2.png" src="images/openrpa_workflow_example_rpa_challenge_finished_2.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To change the name, or  <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> - set inside the activity’s parameters, the user can either click twice in the name of the activity, type the desired name and press <code class="docutils literal notranslate"><span class="pre">RETURN</span></code> or set the parameter <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> inside the <strong>Properties box</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When a WebElement is clicked using the Recorder and OpenRPA determines that the WebElement is capable of receiving input values. A prompt will appear automatically where the user can type string texts and the Recorder will generate the activities as if it were wanted to fill these WebElements with the respective string texts provided. For now, the user may ignore these and fill the prompt with any text, these assigned values will be replaced so they get their values from the DataTable <code class="docutils literal notranslate"><span class="pre">ds</span></code>. The WebElements are automatically assigned to the <code class="docutils literal notranslate"><span class="pre">item</span></code> variable.</p>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_assign_webelement.png" src="images/openrpa_workflow_example_rpa_challenge_assign_webelement.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_highlight_webelement_handle.png" src="images/openrpa_workflow_example_rpa_challenge_highlight_webelement_handle.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_recorder_insert_text.png" src="images/openrpa_workflow_example_rpa_challenge_recorder_insert_text.png" />
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="fill-all-the-required-fields-inside-the-webpage">
<h3><strong>Fill all the required fields inside the webpage.</strong><a class="headerlink" href="#fill-all-the-required-fields-inside-the-webpage" title="Permalink to this headline">¶</a></h3>
<p>Now that the handles are mapped, assign the values of the rows and columns that were obtained in the Excel sheet.</p>
<p>The first input field is <code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">Name</span></code>, and the assignment can be done by using the <strong>Assign</strong> activity found in the <code class="docutils literal notranslate"><span class="pre">RPA.Utilies</span></code> toolbox.</p>
<p>In the left hand side, use the <code class="docutils literal notranslate"><span class="pre">item.Value</span></code> to access the property of the <code class="docutils literal notranslate"><span class="pre">WebElement</span></code> and in the right hand side use the desired input value - in the specific case of the <code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">Name</span></code> column, <code class="docutils literal notranslate"><span class="pre">row(0).ToString</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">FirstName</span></code> is located in the first column, hence <code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_assign_handle_activity.png" src="images/openrpa_workflow_example_rpa_assign_handle_activity.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_assign_handle_value.png" src="images/openrpa_workflow_example_rpa_assign_handle_value.png" />
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Assign</strong> activity is used to reference a value to a variable. To do that, enter in the left-hand side of the activity the name, or alias, of the variable which you want to map a value to. If desired, you can press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable or create it manually. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value of the respective column inside the row is a <code class="docutils literal notranslate"><span class="pre">DataCell</span></code> object. An object temporarily in-memory cache is created to store the column value inside the respective row. Furthermore, as the Excel value may be an object of non-string type, it’s better to be safe and always cast it to a string. Since the need to cast - ie. change its type - to a <code class="docutils literal notranslate"><span class="pre">String</span></code> before assigning it to the <code class="docutils literal notranslate"><span class="pre">item.Value</span></code>, given that the DOM object returned by the <code class="docutils literal notranslate"><span class="pre">Selector</span></code> is of type <code class="docutils literal notranslate"><span class="pre">String</span></code> as well. This is done by using the <code class="docutils literal notranslate"><span class="pre">ToString</span></code> method.</p>
</div>
</div>
<div class="section" id="map-submit-button">
<h3><strong>Map Submit button</strong><a class="headerlink" href="#map-submit-button" title="Permalink to this headline">¶</a></h3>
<p>Each entry - corresponding to each row - must be entered after being filled by clicking the <strong>Submit</strong> button.</p>
<p>To map the process of entering each input - ie. clicking the <strong>Submit button</strong> -, simply click the white triangle corresponding to the space below the last <strong>Assign</strong> activity, start the Recorder and click the <strong>Submit</strong> button inside the browser, as shown in the steps below.</p>
<p>In order to cease recording, simply press the <code class="docutils literal notranslate"><span class="pre">ESC</span></code> button.</p>
<p>It is reminded here that ending the recording is obligatory, or else it will record all activities you execute endlessly.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_submit_button.png" src="images/openrpa_workflow_example_rpa_challenge_map_submit_button.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_submit_button_click.png" src="images/openrpa_workflow_example_rpa_challenge_map_submit_button_click.png" />
</div>
<p>After successfully mapping the <strong>Start</strong> button, your workflow should look like the image below.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rpa_challenge_map_submit_button_final.png" src="images/openrpa_workflow_example_rpa_challenge_map_submit_button_final.png" />
</div>
</div>
<div class="section" id="workflow-finished">
<h3><strong>Workflow Finished</strong><a class="headerlink" href="#workflow-finished" title="Permalink to this headline">¶</a></h3>
<p>The finished workflow should look like the sequence below.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_1.png" src="images/openrpa_workflow_example_rpa_challenge_finished_1.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_2.png" src="images/openrpa_workflow_example_rpa_challenge_finished_2.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_3.png" src="images/openrpa_workflow_example_rpa_challenge_finished_3.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_4.png" src="images/openrpa_workflow_example_rpa_challenge_finished_4.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_5.png" src="images/openrpa_workflow_example_rpa_challenge_finished_5.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rpa_challenge_finished_6.png" src="images/openrpa_workflow_example_rpa_challenge_finished_6.png" />
</div>
</td>
</tr>
</tbody>
</table>
<p><strong>Finished RPA Challenge workflow.</strong></p>
</div>
</div>
<div class="section" id="windows-automation">
<h2>Windows Automation<a class="headerlink" href="#windows-automation" title="Permalink to this headline">¶</a></h2>
<p>In this example, <strong>Skype</strong> will be used to exemplify how easy it is to automate Windows applications.</p>
<p>Our goal is to ask the user for contact info and then the robot will proceed to Skype and send a <code class="docutils literal notranslate"><span class="pre">.PDF</span> <span class="pre">file</span></code> to the specified recipient.</p>
<p>Hence, the <strong>OpenRPA</strong> major features being exposed here are: Detector, Form, Selector and the Recorder.</p>
<p>This example is divided into 3 steps:
The first step refers to <code class="docutils literal notranslate"><span class="pre">Detector</span></code>, which will be used to check if a new file is created in a specific folder.
The second step refers to <code class="docutils literal notranslate"><span class="pre">Form</span></code>, used to prompt the User about the recipient’s contact info (<code class="docutils literal notranslate"><span class="pre">Email</span></code>, <code class="docutils literal notranslate"><span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Username</span></code>)
The final step is <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span> <span class="pre">(Skype</span> <span class="pre">app)/Using</span> <span class="pre">Selector</span></code>, where the user will record the procedure of sending a message and a file to their Skype contact.</p>
<p>If your main interest lies in <strong>Windows UI automation</strong>, you may skip directly to the Windows Automation step.</p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>Detector</dt><dd><ul class="simple">
<li><p>Create Detector in OpenRPA</p></li>
<li><p>Configure Detector node in Node-RED</p></li>
<li><p>Message Manipulation in Node-RED</p></li>
<li><p>Passing a variable from Node-RED to OpenRPA</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Form.</dt><dd><ul class="simple">
<li><p>OpenRPA Forms</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Windows Automation (Skype app)/Using Selector</dt><dd><ul class="simple">
<li><p>Record task</p></li>
<li><p>Configure Selectors</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
<div class="section" id="detector">
<h3>Detector<a class="headerlink" href="#detector" title="Permalink to this headline">¶</a></h3>
<p>Detectors are synonyms to event-listeners. Alas, they wait for some specific condition to happen and then fire a message to <code class="docutils literal notranslate"><span class="pre">Node-RED</span></code> or even to <code class="docutils literal notranslate"><span class="pre">OpenRPA</span></code> itself.</p>
<p>In this section, the user will learn how to create a <code class="docutils literal notranslate"><span class="pre">FileWatcher</span> <span class="pre">Detector</span></code>, which will listen to file changes in a specific directory and will fire an event when a new file is created. For this example, the robot should be firing each time a new <code class="docutils literal notranslate"><span class="pre">PDF/.pdf</span> <span class="pre">file</span></code> is created.</p>
<p><strong>Create Detector in OpenRPA</strong></p>
<p>First, it is needed to configure the <code class="docutils literal notranslate"><span class="pre">FileWatcher</span> <span class="pre">Detector</span></code>.</p>
<p>To do that, the user must first click the <code class="docutils literal notranslate"><span class="pre">Settings</span></code> bar inside OpenRPA’s ribbon.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_click_settings.png"><img alt="images/openrpa_workflow_examples_windows_automation_click_settings.png" src="images/openrpa_workflow_examples_windows_automation_click_settings.png" style="width: 417.0px; height: 326.5px;" /></a>
</div>
<p>Then, click the <code class="docutils literal notranslate"><span class="pre">Detectors</span></code> button inside the ribbon.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_click_detectors.png"><img alt="images/openrpa_workflow_examples_windows_automation_click_detectors.png" src="images/openrpa_workflow_examples_windows_automation_click_detectors.png" style="width: 417.0px; height: 326.5px;" /></a>
</div>
<p>After that, all the user needs is to click the desired detector inside the Detectors ribbon.</p>
<p>For this example, the <code class="docutils literal notranslate"><span class="pre">Detector</span></code> which will be used is the <code class="docutils literal notranslate"><span class="pre">FileWatcherDetectorPlugin</span></code>. Set the Detector’s <code class="docutils literal notranslate"><span class="pre">Name</span></code> - in our case <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span></code> as well as the <code class="docutils literal notranslate"><span class="pre">Path</span></code> which it will listen to - <code class="docutils literal notranslate"><span class="pre">C:\Users\viere\Documents\workflow_example_files\windows_automation\input_files</span></code>, <strong>no quotes</strong>.
Then set the <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">Filter</span></code> to <code class="docutils literal notranslate"><span class="pre">*.pdf</span></code> - the <code class="docutils literal notranslate"><span class="pre">*</span></code> is a wildcard for the filename, that is, any filename will do.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_detector_configured.png"><img alt="images/openrpa_workflow_examples_windows_automation_detector_configured.png" src="images/openrpa_workflow_examples_windows_automation_detector_configured.png" style="width: 416.5px; height: 267.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you can not find a <code class="docutils literal notranslate"><span class="pre">Detector</span></code>, please make sure it has been installed. In case of doubts, simply run the installer <code class="docutils literal notranslate"><span class="pre">.msi</span></code> again and make sure to include it during the installation.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://ryanstutorials.net/linuxtutorial/wildcards.php">Wildcards</a> (<code class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/linuxtutorial/wildcards.php</span></code>) is a set of building blocks that allow you to create a pattern defining a set of files or directories. As you would remember, whenever we refer to a file or directory on the command line, we are actually referring to a string path. Whenever we refer to a path we may also use wildcards in that path to turn it into a set of files or directories..</p>
</div>
<p><strong>Configure Detector node in Node-RED</strong></p>
<p>Now the user will configure, in Node-RED, a <code class="docutils literal notranslate"><span class="pre">Detector</span></code> node, which will be the starting point for <code class="docutils literal notranslate"><span class="pre">NodeRED</span> <span class="pre">Messages</span></code> when the <code class="docutils literal notranslate"><span class="pre">Detector</span></code> is triggered.</p>
<p>Create a new flow inside Node-RED. Our flow is being named <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span> <span class="pre">-</span> <span class="pre">Workflow</span> <span class="pre">Example</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_create_new_node_red_flow.png"><img alt="images/openrpa_workflow_examples_windows_automation_create_new_node_red_flow.png" src="images/openrpa_workflow_examples_windows_automation_create_new_node_red_flow.png" style="width: 522.5px; height: 309.5px;" /></a>
</div>
<p>Now drag a <code class="docutils literal notranslate"><span class="pre">detector</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_drag_detector_node.png"><img alt="images/openrpa_workflow_examples_windows_automation_drag_detector_node.png" src="images/openrpa_workflow_examples_windows_automation_drag_detector_node.png" style="width: 522.5px; height: 309.0px;" /></a>
</div>
<p>Double-click the <code class="docutils literal notranslate"><span class="pre">detector</span></code> node to set its properties. Select the <code class="docutils literal notranslate"><span class="pre">Detector</span></code> in the dropdown field, which will appear - in our case, <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span></code>. Additionally, you may also give a name to this node such as <code class="docutils literal notranslate"><span class="pre">Filepath</span> <span class="pre">Detector</span></code>, we recommend doing so to keep flows organized.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_set_detector_node_properties.png"><img alt="images/openrpa_workflow_examples_windows_automation_set_detector_node_properties.png" src="images/openrpa_workflow_examples_windows_automation_set_detector_node_properties.png" style="width: 521.5px; height: 307.0px;" /></a>
</div>
<p><strong>Message Manipulation in Node-RED</strong></p>
<p>When the <code class="docutils literal notranslate"><span class="pre">FileWatcher</span> <span class="pre">Detector</span></code> fires, some information will be passed in the <code class="docutils literal notranslate"><span class="pre">NodeRED</span> <span class="pre">Message</span></code>, such as the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> - that is, the name of the file that has been created.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_set_debug_detector.png"><img alt="images/openrpa_workflow_examples_windows_automation_set_debug_detector.png" src="images/openrpa_workflow_examples_windows_automation_set_debug_detector.png" style="width: 682.0px; height: 328.5px;" /></a>
</div>
<p>It is desired to capture this data and then pass it back to the robot as <code class="docutils literal notranslate"><span class="pre">arguments</span></code> for when workflows are invoked.
Remember that <code class="docutils literal notranslate"><span class="pre">arguments</span></code> should be passed to the <strong>Robot</strong> through <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> object.
As our OpenRPA Workflow does not require any other <code class="docutils literal notranslate"><span class="pre">argument</span></code>, we can plug in the <code class="docutils literal notranslate"><span class="pre">FileWatcher</span> <span class="pre">Detector</span></code> node directly to the <code class="docutils literal notranslate"><span class="pre">robot</span></code> node.</p>
<p><strong>Invoking OpenRPA Workflows</strong></p>
<p>Here lies the logic behind passing the variables to and executing the OpenRPA workflow, which will be invoked upon the <code class="docutils literal notranslate"><span class="pre">Detector</span></code>’s positive signaling.</p>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">robot</span></code> node to the workspace. This node enables us to invoke the <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span></code> workflow.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_connect_function_node_to_robot.png"><img alt="images/openrpa_workflow_examples_windows_automation_connect_function_node_to_robot.png" src="images/openrpa_workflow_examples_windows_automation_connect_function_node_to_robot.png" style="width: 522.5px; height: 307.0px;" /></a>
</div>
<p>Once again, it is recommended to properly name the nodes, <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Windows</span> <span class="pre">Automation</span> <span class="pre">Workflow</span></code>.</p>
<p>Double-click and assign the <code class="docutils literal notranslate"><span class="pre">Robot</span> <span class="pre">(or</span> <span class="pre">agent)</span></code> who shall execute the workflow, and obviously, the name of the <code class="docutils literal notranslate"><span class="pre">Workflow</span></code> that should be executed (this example, <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Automation</span></code>). You may leave the field <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">Queue</span></code> blank.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_set_robot_node_properties.png"><img alt="images/openrpa_workflow_examples_windows_automation_set_robot_node_properties.png" src="images/openrpa_workflow_examples_windows_automation_set_robot_node_properties.png" style="width: 521.5px; height: 307.5px;" /></a>
</div>
<p>Now, the user must deploy the flow created by clicking the red Deploy button at the screen’s top-left side.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_click_deploy_button.png"><img alt="images/openrpa_workflow_examples_windows_automation_click_deploy_button.png" src="images/openrpa_workflow_examples_windows_automation_click_deploy_button.png" style="width: 682.5px; height: 326.5px;" /></a>
</div>
<p>After that, the user should define a new argument inside the OpenRPA workflow by clicking <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Argument</span></code>.
As you may have seen in the <code class="docutils literal notranslate"><span class="pre">debug</span></code> node, the parameter being passed is called <code class="docutils literal notranslate"><span class="pre">filepath</span></code> and, therefore, the <code class="docutils literal notranslate"><span class="pre">argument</span></code> should be the exact same. As the <code class="docutils literal notranslate"><span class="pre">argument</span></code> is an input, set its <code class="docutils literal notranslate"><span class="pre">Direction</span></code> to <code class="docutils literal notranslate"><span class="pre">In</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_define_pathFile_argument.png"><img alt="images/openrpa_workflow_examples_windows_automation_define_pathFile_argument.png" src="images/openrpa_workflow_examples_windows_automation_define_pathFile_argument.png" style="width: 413.5px; height: 255.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user wants to avoid using Node-RED completely, an infinite <strong>While loop</strong> activity (condition: true=true) with a <strong>Try Block</strong> is suggested along with the <strong>Detector</strong> activity containing the detector defined previously. The user may also use the <strong>Assign</strong> activity to assign a fixed <code class="docutils literal notranslate"><span class="pre">filepath</span></code> for the file which will be sent to the <strong>Skype</strong> contact. By using the loop, every time an iteration finishes, the robot is always back to the start waiting on the <code class="docutils literal notranslate"><span class="pre">Detector</span></code> to fire once more and, in case anything extraordinary happens, the <strong>Try Block</strong> assures that the <strong>Workflow</strong> will keep running.</p>
</div>
</div>
<div class="section" id="form">
<h3>Form<a class="headerlink" href="#form" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to create a <code class="docutils literal notranslate"><span class="pre">Form</span></code> to capture the <code class="docutils literal notranslate"><span class="pre">Email</span></code>, <code class="docutils literal notranslate"><span class="pre">Skype</span> <span class="pre">contact</span></code> and <code class="docutils literal notranslate"><span class="pre">Contact</span> <span class="pre">name</span></code> which will be used to pass the attachment and template message using the <strong>Skype</strong> application.</p>
<p><strong>OpenRPA Forms</strong></p>
<p>Here the user creates a dynamic WPF Form to gather the values mentioned above from the client.</p>
<p>First, drag a <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Formula</span></code> snippet to the main sequence.</p>
<p>Now click <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">designer</span></code> to open the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_click_open_designer_button.png"><img alt="images/openrpa_workflow_examples_windows_automation_click_open_designer_button.png" src="images/openrpa_workflow_examples_windows_automation_click_open_designer_button.png" style="width: 413.5px; height: 254.0px;" /></a>
</div>
<p>Clear all example code and add the code snippet below to the designer code editor.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Skype Automation Form<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">heading</span><span class="p">&gt;</span>Invoice Details<span class="p">&lt;/</span><span class="nt">heading</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;string&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;email&#39;</span>
         <span class="na">label</span><span class="o">=</span><span class="s">&#39;Email&#39;</span>
         <span class="na">tooltip</span><span class="o">=</span><span class="s">&#39;Enter the email address here.&#39;</span>
         <span class="na">icon</span><span class="o">=</span><span class="s">&#39;pencil&#39;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">validate</span> <span class="na">must</span><span class="o">=</span><span class="s">&#39;NotBeEmpty&#39;</span> <span class="na">message</span><span class="o">=</span><span class="s">&#39;Email is mandatory&#39;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;/</span><span class="nt">input</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;string&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;usernameSkype&#39;</span>
         <span class="na">label</span><span class="o">=</span><span class="s">&#39;Skype contact&#39;</span> <span class="na">icon</span><span class="o">=</span><span class="s">&#39;pencil&#39;</span>
         <span class="na">tooltip</span><span class="o">=</span><span class="s">&#39;Enter the Skype contact to which the file will be sent here.&#39;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">validate</span> <span class="na">must</span><span class="o">=</span><span class="s">&#39;NotBeEmpty&#39;</span> <span class="na">message</span><span class="o">=</span><span class="s">&#39;Skype contact is mandatory&#39;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;/</span><span class="nt">input</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#39;string&#39;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;name&#39;</span>
         <span class="na">label</span><span class="o">=</span><span class="s">&#39;Contact name&#39;</span> <span class="na">icon</span><span class="o">=</span><span class="s">&#39;pencil&#39;</span>
         <span class="na">tooltip</span><span class="o">=</span><span class="s">&#39;Enter the contact name to which the file will be sent here.&#39;</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">validate</span> <span class="na">must</span><span class="o">=</span><span class="s">&#39;NotBeEmpty&#39;</span> <span class="na">message</span><span class="o">=</span><span class="s">&#39;Contact name is mandatory&#39;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;/</span><span class="nt">input</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">action</span> <span class="na">name</span><span class="o">=</span><span class="s">&#39;submit&#39;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#39;START SKYPE AUTOMATION&#39;</span> <span class="na">icon</span><span class="o">=</span><span class="s">&#39;check&#39;</span> <span class="na">validates</span><span class="o">=</span><span class="s">&#39;true&#39;</span> <span class="na">ClosesDialog</span><span class="o">=</span><span class="s">&#39;true&#39;</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_openrpa_forms_filled_designer.png"><img alt="images/openrpa_workflow_examples_windows_automation_openrpa_forms_filled_designer.png" src="images/openrpa_workflow_examples_windows_automation_openrpa_forms_filled_designer.png" style="width: 395.0px; height: 223.5px;" /></a>
</div>
<p>If youâ€™re used to HTML or any other markup language, you might understand whatâ€™s happening behind the scenes here. If you donâ€™t, do not worry and refer to the <strong>OpenRPA Forms</strong> section.</p>
<p>By pressing the <strong>Build form</strong> button, the user can build and see a preview of the WPF form in the leftâ€‘side panel of the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code>.</p>
<p>After that, the user can press the <strong>Create variables</strong> button so all variables defined inside the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code> will be automatically created. Easy-peasy, isn’t it?</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_openrpa_forms_create_variables.png"><img alt="images/openrpa_workflow_examples_windows_automation_openrpa_forms_create_variables.png" src="images/openrpa_workflow_examples_windows_automation_openrpa_forms_create_variables.png" style="width: 415.5px; height: 255.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user wants to avoid using <code class="docutils literal notranslate"><span class="pre">OpenRPA</span> <span class="pre">Forms</span></code>, they can simply use the <strong>Assign</strong> activity to assign values to the variables <code class="docutils literal notranslate"><span class="pre">email</span></code>, <code class="docutils literal notranslate"><span class="pre">usernameSkype</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code>, which will be used further to send the attachment and template message to the desired client.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code> is the place where the user can create his desired WPF forms to gather input from the client. On the right-side of it, a preview of the input form is shown. On the left-side of it, the user enters the code used to design the input form. After adding code to the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code>, always press the <strong>Build form</strong> button to save changes and visualize the preview.</p>
</div>
</div>
<div class="section" id="windows-automation-skype-app-using-selectors">
<h3>Windows Automation (Skype app) / Using Selectors<a class="headerlink" href="#windows-automation-skype-app-using-selectors" title="Permalink to this headline">¶</a></h3>
<p>Now comes the greatest part of our journey so far in this workflow example. The built-in Recorder will be used to record the task that an user would normally do to effectively achieve the task described in this section’s introduction effectively.</p>
<p><strong>Record task</strong></p>
<p>Here the user will record the task usually done, namely search for a contact inside the <strong>Skype</strong> application, select - or click - that contact and send a message containing the attachment.</p>
<p>The first step is to open the <strong>Skype</strong> application.</p>
<p>Now, with the <strong>Skype</strong> application open, the user will start the Recorder inside OpenRPA by clicking in the button inside OpenRPA’s ribbon and execute the task as if done manually.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_examples_windows_automation_skype_app_click_recorder.png"><img alt="images/openrpa_workflow_examples_windows_automation_skype_app_click_recorder.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_click_recorder.png" style="width: 413.0px; height: 314.5px;" /></a>
</div>
<p>Now, with the Recorder started, the user must click the <code class="docutils literal notranslate"><span class="pre">Search</span></code> tab, containing the placeholder <code class="docutils literal notranslate"><span class="pre">People,</span> <span class="pre">groups</span> <span class="pre">&amp;</span> <span class="pre">messages</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_click_search_tab.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_click_search_tab.png" />
</div>
<p>An input field will appear inside the <code class="docutils literal notranslate"><span class="pre">Search</span></code> tab containing the placeholder <code class="docutils literal notranslate"><span class="pre">Search</span> <span class="pre">Skype</span></code>. Click that input field, an <code class="docutils literal notranslate"><span class="pre">InsertText</span></code> input field will appear. The user should enter an existing contact which will be used as a dummy to assign the proper <code class="docutils literal notranslate"><span class="pre">Selector</span></code> further in this section. After waiting for <strong>Skype</strong>’s own autocomplete feature to find the user, the user shall click the desired contact.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_input_field.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_input_field.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_input_field_filled.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_input_field_filled.png" />
</div>
<p>After clicking the desired contact, the <code class="docutils literal notranslate"><span class="pre">Messages</span></code> tab will open open for that specific contact.</p>
<p>The user must now click the <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">File</span></code> button in the lower right section.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_click_add_file_button.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_click_add_file_button.png" />
</div>
<p>Now a file dialog appears, where the user can select the desired file, and an input dialog from OpenRPA titled <code class="docutils literal notranslate"><span class="pre">InsertText</span></code> where you can again insert dummy text. The <code class="docutils literal notranslate"><span class="pre">Selector</span></code> will act upon this dialog to choose the file which will be sent, as is seen in the next section. Then click the <code class="docutils literal notranslate"><span class="pre">Open</span></code> button.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_select_file.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_select_file.png" />
</div>
<p>Now click the input field containing the <code class="docutils literal notranslate"><span class="pre">Type</span> <span class="pre">a</span> <span class="pre">message</span></code> placeholder, another input dialog with the <code class="docutils literal notranslate"><span class="pre">InsertText</span></code> title will appear. You can again enter any dummy text.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_click_type_a_message.png" src="images/openrpa_workflow_examples_windows_automation_click_type_a_message.png" />
</div>
<p>Then, the user shall click the blue <strong>Send</strong> button.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_click_send_button.png" src="images/openrpa_workflow_examples_windows_automation_click_send_button.png" />
</div>
<p>Finally, click the <strong>X</strong> button inside the <code class="docutils literal notranslate"><span class="pre">Search</span></code> tab to close the search dialogue and exit the Recorder by pressing the <code class="docutils literal notranslate"><span class="pre">ESC</span></code> button.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_close_search_tab.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_close_search_tab.png" />
</div>
<p><strong>Configure Selectors</strong></p>
<p>Now the <code class="docutils literal notranslate"><span class="pre">Selector</span></code> for the many <strong>GetElement</strong> activities that appeared inside OpenRPA’s designer is configured.</p>
<p>First, configure the first <code class="docutils literal notranslate"><span class="pre">Selector</span></code> for the first element to be clicked inside the <strong>Skype</strong> application pane. That is the one with the <code class="docutils literal notranslate"><span class="pre">People,</span> <span class="pre">groups</span> <span class="pre">&amp;</span> <span class="pre">messages</span></code> placeholder. In our case, we changed its <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> from <code class="docutils literal notranslate"><span class="pre">Search</span> <span class="pre">for</span> <span class="pre">people,</span> <span class="pre">groups</span> <span class="pre">&amp;</span> <span class="pre">messages</span></code> to <code class="docutils literal notranslate"><span class="pre">Search</span> <span class="pre">Contact</span> <span class="pre">GetElement</span></code>, to ease the viewing process by a 3rd-party which may be interested in the workflow.</p>
<p>Click the <strong>Open Selector</strong> button inside the <strong>GetElement</strong> activity that was generated for that specific field.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector.png" />
</div>
<p>In this image, the user notices a <strong>Type Text</strong> activity, which corresponds to the dummy username that was typed. The user can remove that activity from the workspace, since it’ll be replaced with another activity in the following steps.</p>
<p>The user will notice that upon clicking the <strong>Highlight</strong> button inside the new window and with the <strong>Skype</strong> application window open, no elements inside the screen will be highlighted. Then, we must select the given element manually.</p>
<p>To do that, the user can first double-click the element <code class="docutils literal notranslate"><span class="pre">Pane</span> <span class="pre">Skype</span></code> -&gt;  <code class="docutils literal notranslate"><span class="pre">Document</span> <span class="pre">Skype</span> <span class="pre">XXXXXXXXXX</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Button</span> <span class="pre">Search</span> <span class="pre">for</span> <span class="pre">people,</span> <span class="pre">groups</span> <span class="pre">&amp;</span> <span class="pre">messages</span></code> and right-click this last element and click the <strong>Select Element</strong> button that appears. Below is a picture of this element highlighted.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector_element_highlighted.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector_element_highlighted.png" />
</div>
<p>Now, the user is going to change the <code class="docutils literal notranslate"><span class="pre">filename</span></code> attribute in the first selector, where there may be <code class="docutils literal notranslate"><span class="pre">&quot;%ProgramFiles%\\WindowsApps\\Microsoft.SkypeApp_15.61.100.0_x86__XXXXX\\Skype\\Skype.exe&quot;</span></code>, the user wants to crop the version of skype and the hash which follows it - specified here as <code class="docutils literal notranslate"><span class="pre">{XXXXX}</span></code>. To do that, simply change it to <a href="#id4"><span class="problematic" id="id5">``</span></a>”%ProgramFiles%\WindowsApps\Microsoft.SkypeApp_*”<a href="#id6"><span class="problematic" id="id7">``</span></a>Â¹.</p>
<p>Now the user must also deselect the fourth selector. All the changes made so far are shown in the image below.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector_finished.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_people_groups_messages_selector_finished.png" />
</div>
<p>After that, simply click the <strong>Ok</strong> button on the lower-left side of the screen. It is recommended that the user check once more whether the proper <code class="docutils literal notranslate"><span class="pre">Selector</span></code> was configured by clicking the <strong>Highlight</strong> button inside the activity.</p>
<p>Now the user must do the same steps specified above inside the <strong>GetElement</strong> activity responsible for capturing the <code class="docutils literal notranslate"><span class="pre">Search</span></code> tab input. Select the element inside <code class="docutils literal notranslate"><span class="pre">Pane</span> <span class="pre">Skype</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Document</span> <span class="pre">Skype</span> <span class="pre">XXXXXXXXX</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">Search</span> <span class="pre">Skype</span></code>. It is important to remark that the <code class="docutils literal notranslate"><span class="pre">Search</span></code> tab must be visible inside the <strong>Skype</strong> application before opening the selector so OpenRPA can recognize it as an element inside the window.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_selector_finished.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_selector_finished.png" />
</div>
<p>The user must also change the right-hand value of the <strong>Assign</strong> activity, inside the current <strong>GetElement</strong> activity, to the variable which is going to hold the <code class="docutils literal notranslate"><span class="pre">username</span></code> of the desired contact. In our case, that variable is <code class="docutils literal notranslate"><span class="pre">usernameSkype</span></code>, as previously defined in the <strong>Forms</strong> section.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_assign_properties_tab.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_search_tab_assign_properties_tab.png" />
</div>
<p>Now the user will add a <strong>Delay</strong> activity to the workflow. Set the <strong>Delay</strong>’s <code class="docutils literal notranslate"><span class="pre">Duration</span></code> property to <code class="docutils literal notranslate"><span class="pre">00:00:05</span></code>, which means this delay will last for 5 seconds. This is explicitly needed because of the autocomplete function built-in in the <strong>Skype</strong> application. It is a hard-coded constraint in which the robot must wait for the autocomplete function to complete before proceeding to the next steps.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_skype_app_delay.png" src="images/openrpa_workflow_examples_windows_automation_skype_app_delay.png" />
</div>
<p>Then, the user must repeat the steps specified above inside the <strong>GetElement</strong> activity responsible for capturing the <code class="docutils literal notranslate"><span class="pre">Contact</span></code> button.  Select the element inside <code class="docutils literal notranslate"><span class="pre">Pane</span> <span class="pre">Skype</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Document</span> <span class="pre">Skype</span> <span class="pre">XXXXXXXXX</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Group</span> <span class="pre">PEOPLE</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Button</span> <span class="pre">{Contact</span> <span class="pre">Name},</span> <span class="pre">{Status},</span> <span class="pre">{Chatted</span> <span class="pre">Last},</span> <span class="pre">{Skype</span> <span class="pre">Name}</span></code> - namely, in our case, <code class="docutils literal notranslate"><span class="pre">Paulo</span> <span class="pre">Veras</span></code>, <code class="docutils literal notranslate"><span class="pre">Away</span></code>, <code class="docutils literal notranslate"><span class="pre">Chatted</span> <span class="pre">23</span> <span class="pre">minutes</span> <span class="pre">ago</span></code>, <code class="docutils literal notranslate"><span class="pre">Skype</span> <span class="pre">Name</span></code>.  It is important to remark that the <code class="docutils literal notranslate"><span class="pre">Contact</span></code> button must be visible inside the <strong>Skype</strong> application before opening the selector so OpenRPA can recognize it as an element inside the window. Below is the <code class="docutils literal notranslate"><span class="pre">Selector</span></code> properly set up and an image of the button highlighted.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_desired_contact_selector_finished.png" src="images/openrpa_workflow_examples_windows_automation_desired_contact_selector_finished.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_desired_contact_selector_highlighted.png" src="images/openrpa_workflow_examples_windows_automation_desired_contact_selector_highlighted.png" />
</div>
<p>Now add a <strong>post wait</strong> by using the <code class="docutils literal notranslate"><span class="pre">Post</span> <span class="pre">Wait</span></code> properties inside the <strong>Click Element</strong> activity which is contained inside the <strong>GetElement</strong> activity responsible for capturing the <code class="docutils literal notranslate"><span class="pre">Contact</span></code> button.  This value should be set to <code class="docutils literal notranslate"><span class="pre">00:00:02</span></code>. The <strong>post wait</strong> is used so, after clicking the desired contact button which appears in the left pane of the <strong>Skype</strong> window, the application itself will wait for the <code class="docutils literal notranslate"><span class="pre">Messages</span></code> tab to load. Since we have added the <strong>post wait</strong>, the <strong>Delay</strong> activity is not needed.</p>
<p>The user must now repeat the steps specified for selecting the proper <code class="docutils literal notranslate"><span class="pre">Selector</span></code> for the remaining activities and assure that the elements inside the screen are highlighted when properly configured. Remember, you may have to open a window in the <strong>Add file</strong> button to select the elements correctly.</p>
<p>Now set the proper value for the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> for the file which will be sent through the <strong>Skype</strong> app. Assign the appropriate value inside the respective <strong>Assign</strong> activity, which corresponds to the input field where the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> is going to be set. If you haven’t created the <code class="docutils literal notranslate"><span class="pre">argument</span></code> yet, now is the time to do it - remember it must have its <code class="docutils literal notranslate"><span class="pre">Direction</span></code> set as <code class="docutils literal notranslate"><span class="pre">In</span></code>. Below it is shown how to set this argument properly.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_set_filepath_inside_getelement.png" src="images/openrpa_workflow_examples_windows_automation_set_filepath_inside_getelement.png" />
</div>
<p>Finally, check whether the configs are correct for the element inside the <code class="docutils literal notranslate"><span class="pre">Selector</span></code> corresponding to <code class="docutils literal notranslate"><span class="pre">Pane</span> <span class="pre">Skype</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Document</span> <span class="pre">Skype</span> <span class="pre">XXXXXXXXX</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Edit</span> <span class="pre">Type</span> <span class="pre">a</span> <span class="pre">message</span></code> and alter item.value to item.SendKeys inside the <strong>Assign</strong> activity included in the <strong>GetElement</strong> activity.</p>
<p>If the user refrains from doing so, OpenRPA will attempt to directly set the value of Skype’s edit field to the contents of the variable templateMessage. The problem is: Skype does not like that! The Skype app assumes that the user would type a letter at a time instead of changing the edit field value directly, otherwise the UI gets messed up with the placeholder “Type a message ” ending on top of the actual text message.</p>
<p>The correct way to mimic a user typing a letter at a time is to use item.SendKeys method.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">Detector</span></code> is appropriately set, the user can now test the workflow example by inserting a <code class="docutils literal notranslate"><span class="pre">.PDF</span></code> file inside the directory previously defined. Else, they can follow the note below.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user hasn’t set the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> argument to be acquired from the <code class="docutils literal notranslate"><span class="pre">FileWatcherDetectorPlugin</span></code>, as seen in the 1st step in this workflow example, they must set its value manually by using an <strong>Assign</strong> activity.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To change the name, or  <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> - inside the activity’s parameters, the user can either click twice in the name of the activity, type the desired name and press <code class="docutils literal notranslate"><span class="pre">RETURN</span></code> or set the parameter <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> inside the <strong>Properties box</strong>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Â¹ - <a class="reference external" href="https://ryanstutorials.net/linuxtutorial/wildcards.php">Wildcards</a> (<code class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/linuxtutorial/wildcards.php</span></code>) is a set of building blocks that allow you to create a pattern defining a set of files or directories. As you would remember, whenever we refer to a file or directory on the command line we are actually referring to a path. Whenever we refer to a path we may also use wildcards in that path to turn it into a set of files or directories..</p>
</div>
</div>
<div class="section" id="id9">
<h3>Workflow Finished<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Here lie the images showing the output of the workflow both in the <strong>Skype</strong> application and in Node-RED.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_workflow_finished.png" src="images/openrpa_workflow_examples_windows_automation_workflow_finished.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_windows_automation_workflow_finished_nodered.png" src="images/openrpa_workflow_examples_windows_automation_workflow_finished_nodered.png" />
</div>
</div>
</div>
<div class="section" id="image-search-ocr">
<h2>Image Search / OCR<a class="headerlink" href="#image-search-ocr" title="Permalink to this headline">¶</a></h2>
<p>In this example, the user can practice OCR on an image loaded from a file and then check the results against a validation standard.</p>
<p>To reduce the scope of the activity, this workflow example’s only purpose is to check whether the detected document is a driver’s license or not.</p>
<p>The validation procedure is as follows: if the text “DRIVER” is located within the image, OpenRPA will assume this document is indeed a driver’s license.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As well known, OCR is <strong>not</strong> guaranteed to work 100% of the time, as text readability and image quality both play a crucial role in its success rate.</p>
</div>
<div class="section" id="load-image-from-file">
<h3>Load Image from File<a class="headerlink" href="#load-image-from-file" title="Permalink to this headline">¶</a></h3>
<p>Drag the <strong>Load From File</strong> activity to the main sequence.</p>
<p>Click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button to select the image to be loaded.</p>
<p>Open the <strong>Properties tab</strong> and assign a variable to the <code class="docutils literal notranslate"><span class="pre">Result</span></code> parameter, which will carry the <code class="docutils literal notranslate"><span class="pre">ImageElement</span></code> created by the activity.</p>
<p>It is useful to remind the user that everything captured from an activity that returns any kind of <code class="docutils literal notranslate"><span class="pre">Element</span></code> is automatically mapped to the <code class="docutils literal notranslate"><span class="pre">item</span></code> Element.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenRPA is able to automatically create a new variable with the correct type required for the Activity/property. While creating a new variable in the <strong>Properties box</strong>, after typing the variable name and with the caret still inside the input field, by pressing <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_image_search_ocr_load_from_file.png" src="images/openrpa_workflow_example_image_search_ocr_load_from_file.png" />
</div>
</div>
<div class="section" id="get-text">
<h3>Get Text<a class="headerlink" href="#get-text" title="Permalink to this headline">¶</a></h3>
<p>Drag <strong>Get Text</strong> activity to the sequence inside the <strong>Load From File</strong> activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_image_search_ocr_get_text.png" src="images/openrpa_workflow_example_image_search_ocr_get_text.png" />
</div>
</div>
<div class="section" id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">¶</a></h3>
<p>Drag an <strong>If</strong> activity to the sequence inside the <strong>Get Text</strong> activity. Here the user will implement the whole validation logic.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">Condition</span></code> input field, insert <code class="docutils literal notranslate"><span class="pre">item.Value.Contains(&quot;DRIVER&quot;)</span></code>. Here it is checked whether any of the text acquired using the <strong>Get Text</strong> activity - ie. inside <code class="docutils literal notranslate"><span class="pre">item.Value</span></code> - contains the word <code class="docutils literal notranslate"><span class="pre">DRIVER</span></code>.</p>
<p>Drag an <strong>Assign</strong> activity to the <code class="docutils literal notranslate"><span class="pre">Then</span></code> sequence inside the <strong>If</strong> activity.  Assign the variable <code class="docutils literal notranslate"><span class="pre">containsDriverLicense</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. This means that if the workflow finds any instances of the values that contains <code class="docutils literal notranslate"><span class="pre">DRIVER</span></code> it will automatically change the value of the variable <code class="docutils literal notranslate"><span class="pre">containsDriverLicense</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Else, it will keep executing, since there is nothing contained inside the <code class="docutils literal notranslate"><span class="pre">Else</span></code> sequence.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <strong>Assign</strong> activity is used to reference a value to a variable. To do that, enter in the left-hand side of the activity the name, or alias, of the variable which you want to map a value to. If desired, you can press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable or create it manually. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_image_search_ocr_if_clause.png" src="images/openrpa_workflow_example_image_search_ocr_if_clause.png" />
</div>
</div>
<div class="section" id="show-notification">
<h3><strong>Show Notification</strong><a class="headerlink" href="#show-notification" title="Permalink to this headline">¶</a></h3>
<p>Now drag a <strong>Show Notification</strong> activity to the end of the main sequence. This will be the way of showing to the user whether the validation has been successful or not.</p>
<p>Inside the <code class="docutils literal notranslate"><span class="pre">Message</span></code> input field, in the activityÂ´s dialogue or in the <strong>Properties box</strong>, insert the text <code class="docutils literal notranslate"><span class="pre">&quot;Is</span> <span class="pre">the</span> <span class="pre">document</span> <span class="pre">a</span> <span class="pre">Driver's</span> <span class="pre">License?</span> <span class="pre">&quot;</span> <span class="pre">+</span> <span class="pre">containsDriverLicense.ToString</span></code>.</p>
<p>Here we cast the value of <code class="docutils literal notranslate"><span class="pre">containsDriverLicense</span></code>, which is a <code class="docutils literal notranslate"><span class="pre">bool</span></code>, to a <code class="docutils literal notranslate"><span class="pre">string</span></code> so it can be printed in the <strong>Show Notification</strong> activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_image_search_ocr_show_notif.png" src="images/openrpa_workflow_example_image_search_ocr_show_notif.png" />
</div>
</div>
<div class="section" id="id10">
<h3>Workflow Finished<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>Here’s a preview of how the workflow will look like after running it - the Output window is obviously detached for exhibiting the data.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_image_search_ocr_finished_1.png" src="images/openrpa_workflow_example_image_search_ocr_finished_1.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_image_search_ocr_finished_2.png" src="images/openrpa_workflow_example_image_search_ocr_finished_2.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_image_search_ocr_finished_3.png" src="images/openrpa_workflow_example_image_search_ocr_finished_3.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_image_search_ocr_finished_output.png" src="images/openrpa_workflow_example_image_search_ocr_finished_output.png" />
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="excel-read">
<h2>Excel Read<a class="headerlink" href="#excel-read" title="Permalink to this headline">¶</a></h2>
<p>In this example, the user will read a couple of invoices contained in <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">files</span> <span class="pre">(.xlsx)</span></code>, capture the data inside them and generate a new <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> with the merged data.</p>
<p>The invoices which will be used to demonstrate this example can be found here <a class="reference external" href="https://drive.google.com/file/d/1WkBjsWhA5Dm_fp5zg_kdlBh9oe2vKnTO/view?usp=sharing">Invoices</a> (<code class="docutils literal notranslate"><span class="pre">https://drive.google.com/file/d/1WkBjsWhA5Dm_fp5zg_kdlBh9oe2vKnTO/view?usp=sharing</span></code>).</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_invoice_example.png" src="images/openrpa_workflow_example_read_excel_invoice_example.png" />
</div>
<p>Unpack the <code class="docutils literal notranslate"><span class="pre">.rar</span></code> file at the desired directory and save the folder path somewhere, it shall be used later on.</p>
<p>The following steps are followed to accomplish this workflow example.</p>
<ol class="arabic simple">
<li><p>Create an Empty DataTable.</p></li>
<li><dl class="simple">
<dt>For each Invoice.</dt><dd><ul class="simple">
<li><p>Read Individual Cells</p></li>
<li><p>Read Table Cells (“items”)</p></li>
<li><p>Add this iteration’s invoice to DataTable</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Write Excel from DataTable</p></li>
</ol>
<div class="section" id="create-an-empty-datatable">
<h3><strong>Create an Empty DataTable.</strong><a class="headerlink" href="#create-an-empty-datatable" title="Permalink to this headline">¶</a></h3>
<p>All the Excel data that will be read from the invoices will be saved into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>.</p>
<p>Drag the <strong>CreateDataTable</strong> activity to the end of the main sequence.</p>
<p>In the first input field, assign the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> name as <code class="docutils literal notranslate"><span class="pre">invoicesDataTable</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenRPA can automatically create a new variable with the correct type required for the Activity/property. While creating a new variable in the <strong>Properties box</strong>, after typing the variable name and with the caret still inside the input field, press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
</div>
<p>In our case, the fields which are going to be assigned to the second input field are headers. Therefore our second input field should contain <code class="docutils literal notranslate"><span class="pre">{&quot;Invoice</span> <span class="pre">Number&quot;,</span> <span class="pre">&quot;Company</span> <span class="pre">Name&quot;,</span> <span class="pre">&quot;Shipping</span> <span class="pre">Address&quot;,</span> <span class="pre">&quot;Shipping</span> <span class="pre">Tel.</span> <span class="pre">Number&quot;,</span> <span class="pre">&quot;Due</span> <span class="pre">Date&quot;,</span> <span class="pre">&quot;Qty.</span> <span class="pre">of</span> <span class="pre">Items&quot;,</span> <span class="pre">&quot;Due</span> <span class="pre">Balance&quot;}</span></code> as its content.</p>
<p>It is advisable to rename the <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> for each activity to something meaningful, and that helps you keep track of what each part of the workflow does! Considering that, rename this activity to “Create Empty DataTable”.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_create_empty_data_table.png" src="images/openrpa_workflow_example_read_excel_create_empty_data_table.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In OpenRPA, a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> corresponds to a 2-dimensional non-serializable object used to hold values. Think of it as a matrix with <code class="docutils literal notranslate"><span class="pre">i</span></code> rows and <code class="docutils literal notranslate"><span class="pre">j</span></code> columns. The <code class="docutils literal notranslate"><span class="pre">i</span></code> rows are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Rows(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the row - starting from 0 - which you want to access. The <code class="docutils literal notranslate"><span class="pre">j</span></code> columns are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Item(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the column - starting from 0 - which you want to access. It is useful to remind here that the user must have accessed the <code class="docutils literal notranslate"><span class="pre">Rows</span></code> attribute, therefore, if the user wanted to access the 2nd column on the 3rd row of the data table they would use <code class="docutils literal notranslate"><span class="pre">.Rows(2).Item(1)</span></code> attribute.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the .NET API, a <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code> corresponds to one table of in-memory data contained in a <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> from the class equally named. When you read an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, it is automatically assigned to a <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class, and all the <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes - numbered from 0 to the number of sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. Here it is reminded that <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case sensitive.</p>
</div>
</div>
<div class="section" id="for-each-invoice">
<h3><strong>For each Invoice</strong><a class="headerlink" href="#for-each-invoice" title="Permalink to this headline">¶</a></h3>
<p>The first activity will loop a directory and will return all filenames contained in it.</p>
<p>First drag the <strong>Assign</strong> activity to assign the absolute path of the directory you want to loop through to a variable - ie. <code class="docutils literal notranslate"><span class="pre">path</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_assign_path.png" src="images/openrpa_workflow_example_read_excel_assign_path.png" />
</div>
<p>Drag the <strong>ForEachWithBodyFactory&lt;&gt;</strong> activity to the main sequence.</p>
<p>Set the proper <code class="docutils literal notranslate"><span class="pre">TypeArgument</span></code> parameter inside the <strong>Properties box</strong> to <code class="docutils literal notranslate"><span class="pre">String</span></code>. This is done because the directory which will be iterated through contain filepaths, which are returned as values of <code class="docutils literal notranslate"><span class="pre">String</span></code> type.</p>
<p>In the right-hand side of the activity change the <code class="docutils literal notranslate"><span class="pre">item</span></code> variable assigned to <code class="docutils literal notranslate"><span class="pre">filePath</span></code>.</p>
<p>In the left-hand side of the activity, insert <code class="docutils literal notranslate"><span class="pre">System.IO.Path.GetFiles(path)</span></code>.</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">filePath</span></code> now contains the <code class="docutils literal notranslate"><span class="pre">String</span></code> to each respective invoice full filepath.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_for_each_with_body_factory.png" src="images/openrpa_workflow_example_read_excel_for_each_with_body_factory.png" />
</div>
<p><strong>Read Individual Cells</strong></p>
<p>Here the robot will read individual cells of fields that contain only a single value - these fields are static (the number of rows is fixed - one).</p>
<p>As these steps are quite repetitive, we will be reproducing only the steps of the <code class="docutils literal notranslate"><span class="pre">invoiceNumber</span></code> variable. If you want to practice further, we strongly recommend doing the same to the other variables as well, namely <code class="docutils literal notranslate"><span class="pre">companyName</span></code>, <code class="docutils literal notranslate"><span class="pre">shippingAddress</span></code>, <code class="docutils literal notranslate"><span class="pre">shippingTelephoneNumber</span></code> and <code class="docutils literal notranslate"><span class="pre">dueDate</span></code>.</p>
<p>Use the Recorder to select the cell or drag the <strong>ReadCell</strong> activity, found inside the <code class="docutils literal notranslate"><span class="pre">OpenRPA.Utilities</span></code> toolbox, to the sequence inside the <strong>ForEachWithBodyFactory&lt;&gt;</strong> activity.</p>
<p>If the Recorder wasn’t used, the user must follow a few more steps in order to use this activity. First, assign the <code class="docutils literal notranslate"><span class="pre">Filename</span></code> parameter inside the <strong>Properties box</strong> to the <code class="docutils literal notranslate"><span class="pre">filePath</span></code> variable to select the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> which will be read. Enter the cell, which will be captured into the <code class="docutils literal notranslate"><span class="pre">Cell</span></code> parameter. In our case, it is <code class="docutils literal notranslate"><span class="pre">&quot;H3&quot;</span></code>, which corresponds to the invoice number.</p>
<p>The <strong>ReadCell activity</strong> will read from an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> and save the cell into a <code class="docutils literal notranslate"><span class="pre">String</span></code> variable by default. The user can change the type of the data captured by changing the <code class="docutils literal notranslate"><span class="pre">ArgumentType</span></code> parameter inside the <strong>Properties tab</strong>.</p>
<p>Since this variable does not exist yet, we must first create it. A reminder that the variable must be obligatorily set with the type <strong>System.Data.String</strong>.</p>
<p>Simply click in the <code class="docutils literal notranslate"><span class="pre">Result</span></code> input field inside the <strong>Properties tab</strong> and type the name of the variable you want to use. In this case, it is <code class="docutils literal notranslate"><span class="pre">invoiceNumber</span></code>.</p>
<p>Now repeat the procedure above for the remaining variables.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_read_individual_cell.png" src="images/openrpa_workflow_example_read_excel_read_individual_cell.png" />
</div>
</div></blockquote>
<p>Remember that it is needed to change the variables <code class="docutils literal notranslate"><span class="pre">Scope</span></code> to the outermost sequence to be able to capture all the values gathered in here and save them into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> later on.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_change_scope.png" src="images/openrpa_workflow_example_read_excel_change_scope.png" />
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While creating a new variable in the <strong>Properties box</strong>, after typing the variable name and with the caret still inside the input field, by pressing <code class="docutils literal notranslate"><span class="pre">'K</span></code> OpenRPA will automatically create this new variable with the correct type required for the activity.</p>
</div>
<p><strong>Read Table Cells (“items”)</strong></p>
<p>Here the robot will read a ‘table’ inside the invoice, and differently to reading individual cells, tables are usually dynamic (the number of rows may vary) or. This is done in a programmatic manner that allows the developer to read a specific range of cells, which would be simply too huge as to permit him to add the <strong>ReadCell</strong> activity for each variable manually.</p>
<p>This ‘table’ will be stored in a new <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> called ‘itemsDataTable’ and some logic will be applied as well, such as removing empty columns, summing and counting values.</p>
<p>Drag a <strong>Sequence</strong> activity and name it <code class="docutils literal notranslate"><span class="pre">Items</span> <span class="pre">Processing</span> <span class="pre">Logic</span></code>.</p>
<p>Inside this sequence, drag a <strong>CreateDataTable</strong> activity and create a table named <code class="docutils literal notranslate"><span class="pre">itemsDataTable</span></code>.</p>
<p>The headers for this <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> shall be <code class="docutils literal notranslate"><span class="pre">{&quot;itemName&quot;,</span> <span class="pre">&quot;quantity&quot;,</span> <span class="pre">&quot;rate&quot;,</span> <span class="pre">&quot;subTotal&quot;}</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_read_items_processing_logic_create_data_table.png" src="images/openrpa_workflow_example_read_excel_read_items_processing_logic_create_data_table.png" />
</div>
<p>For the assignments, we will be using columns 0, 3, 5, 7, if you take a look at the invoice template, these are the indexes for the columns that contain data.</p>
<p>By using the <code class="docutils literal notranslate"><span class="pre">Read</span> <span class="pre">Range</span></code> activity, we will get the table contents into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>.</p>
<p>First, enter the filepath of the file from which the activity will read from inside the <code class="docutils literal notranslate"><span class="pre">Filename</span></code> input field.</p>
<p>Enter the cells you want to capture in the <code class="docutils literal notranslate"><span class="pre">Cells</span></code> field inside the <strong>Properties box</strong>. In our case, those are <code class="docutils literal notranslate"><span class="pre">&quot;A14:H18&quot;</span></code>.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_range_cells.png" src="images/openrpa_workflow_example_read_excel_range_cells.png" />
</div>
</div></blockquote>
<p>The indexes <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">5</span></code>, and <code class="docutils literal notranslate"><span class="pre">7</span></code> refer to the indexed objects inside the current <code class="docutils literal notranslate"><span class="pre">row</span></code>, ie. the columns.</p>
<p>Enter the name for the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> you want to save it to inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> field inside the <strong>Properties box</strong>. In our case, this <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> is <code class="docutils literal notranslate"><span class="pre">items</span></code>.</p>
<p>In the <strong>Properties box</strong>, you may find the property <code class="docutils literal notranslate"><span class="pre">IgnoreEmptyRows</span></code>, set this value to <code class="docutils literal notranslate"><span class="pre">True</span></code>. Since our table does not contain a header, set the <code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">Header</span> <span class="pre">Row</span></code> property to <code class="docutils literal notranslate"><span class="pre">False</span></code> - this will ensure the activity reads the first row of the data (row 14).</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_items_processing_read_range.png" src="images/openrpa_workflow_example_read_excel_items_processing_read_range.png" />
</div>
<p>And by looping the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> with a <strong>ForEach DataRow</strong> activity, the <strong>Add DataRow</strong> activity is used to loop through each item information to our ‘itemsDataTable’</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_items_processing_for_each_and_add_data_row.png" src="images/openrpa_workflow_example_read_excel_items_processing_for_each_and_add_data_row.png" />
</div>
<p>Now comes the logic for calculating the subtotal value and adding this value to the total value which will be described in the final <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">sheet</span></code>.</p>
<p>Declare a new variable <code class="docutils literal notranslate"><span class="pre">quantity</span></code> with type <code class="docutils literal notranslate"><span class="pre">System.Decimal</span></code>. Using the <strong>Assign</strong> activity, assign its value to <code class="docutils literal notranslate"><span class="pre">quantity</span> <span class="pre">+</span> <span class="pre">Convert.ToDecimal(row(3).ToString)</span></code> - this will cause the variable to increment its value for each item iteration.</p>
<p>Declare a new variable <code class="docutils literal notranslate"><span class="pre">currentQuantity</span></code> with type <code class="docutils literal notranslate"><span class="pre">System.Decimal</span></code>. Using the <strong>Assign</strong> activity, assign its value to <code class="docutils literal notranslate"><span class="pre">Convert.ToDecimal(row(3).ToString)</span></code></p>
<p>Do the step above for the variable <code class="docutils literal notranslate"><span class="pre">currentRate</span></code> as well, using <code class="docutils literal notranslate"><span class="pre">row(5)</span></code> as its base-value.</p>
<p>Declare a new variable <code class="docutils literal notranslate"><span class="pre">subTotal</span></code> with type <code class="docutils literal notranslate"><span class="pre">System.Decimal</span></code>. Using the <strong>Assign</strong> activity, assign its value to <code class="docutils literal notranslate"><span class="pre">currentQuantity*currentRate</span></code>.</p>
<p>Finally, declare a new variable <code class="docutils literal notranslate"><span class="pre">dueBalance</span></code> with type <code class="docutils literal notranslate"><span class="pre">System.Decimal</span></code>. Using the <strong>Assign</strong> activity, assign its value to <code class="docutils literal notranslate"><span class="pre">dueBalance</span> <span class="pre">+</span> <span class="pre">currentQuantity*currentRate</span></code>.</p>
<p>It is useful to remark that the user must change the variables <code class="docutils literal notranslate"><span class="pre">Scope</span></code> to the outermost sequence to be able to capture all the values gathered in here and save them into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> later on.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_items_logic_assign_variables.png" src="images/openrpa_workflow_example_read_excel_items_logic_assign_variables.png" />
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the <strong>Read Range</strong> activity, the <code class="docutils literal notranslate"><span class="pre">:</span></code> colon symbol is used to delimit the area you want to capture, the cell to the left-hand side of it is the starting cell, and the cell to the right-hand side of it is the ending cell.</p>
</div>
</div>
<div class="section" id="add-this-iteration-s-invoice-to-datatable">
<h3><strong>Add this iteration’s invoice to DataTable</strong><a class="headerlink" href="#add-this-iteration-s-invoice-to-datatable" title="Permalink to this headline">¶</a></h3>
<p>Now that we’ve gathered all the important data from this iteration’s invoice, we want to add this info to the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> we created on step 1.</p>
<p>Drag the <strong>AddDataRow</strong> activity to the end of the sequence inside the <strong>ForEachWithBodyFactory&lt;&gt;</strong> activity.</p>
<p>In the first input field, insert <code class="docutils literal notranslate"><span class="pre">invoicesDataTable</span></code>.</p>
<p>In the second input field, insert <code class="docutils literal notranslate"><span class="pre">{invoiceNumber,</span> <span class="pre">companyName,</span> <span class="pre">shippingAddress,</span> <span class="pre">shippingTelephoneNumber,</span> <span class="pre">dueDate,</span> <span class="pre">quantity,</span> <span class="pre">total}</span></code>.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_add_invoices_data_table.png" src="images/openrpa_workflow_example_read_excel_add_invoices_data_table.png" />
</div>
</div></blockquote>
</div>
<div class="section" id="write-excel-from-datatable">
<h3><strong>Write Excel from DataTable</strong><a class="headerlink" href="#write-excel-from-datatable" title="Permalink to this headline">¶</a></h3>
<p>This is the last part of the workflow. Here the user will finally write the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> containing all the data gathered.</p>
<p>Drag a <strong>WriteExcel</strong> activity into the end of the main sequence.</p>
<p>Click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button to select the filename to which the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> will be saved to. Enter the filename inside the <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">name</span></code> input field on the explorer window, which will appear. Then press <code class="docutils literal notranslate"><span class="pre">Save</span></code> to finally assign it.</p>
<p>Assign the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> from which the data gathered will be saved into the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> by entering its name inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> property inside the <strong>Properties box</strong>.</p>
<p>Enter the theme which will be used to stylize the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code> in the <code class="docutils literal notranslate"><span class="pre">Theme</span></code> property inside the <strong>Properties box</strong>.</p>
<blockquote>
<div><div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_write_excel.png" src="images/openrpa_workflow_example_read_excel_write_excel.png" />
</div>
</div></blockquote>
</div>
<div class="section" id="id11">
<h3><strong>Workflow Finished</strong><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>Here’s a preview of how the workflow will look like after completing it.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_workflow_finished_1.png" src="images/openrpa_workflow_example_read_excel_workflow_finished_1.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_excel_workflow_finished_2.png" src="images/openrpa_workflow_example_read_excel_workflow_finished_2.png" />
</div>
</div>
</div>
<div class="section" id="mongodb-entities-manipulation">
<h2>MongoDB Entities Manipulation<a class="headerlink" href="#mongodb-entities-manipulation" title="Permalink to this headline">¶</a></h2>
<p>Coming soon - Work in progress</p>
</div>
<div class="section" id="file-manipulation">
<h2>File Manipulation<a class="headerlink" href="#file-manipulation" title="Permalink to this headline">¶</a></h2>
<p>In this example, users will find how to manipulate files in <strong>OpenRPA</strong>. All basic procedures will be covered, such as saving, moving and deleting files, as well as some basic diretory manipulation.</p>
<p>Let’s assume there is a directory with files of different types. The first task is to separate these files according to their extension into different subdirectories. Files that are not .txt will be deleted.</p>
<p>After that, the robot will access the .txt files and search for a given keyword. The ideia here is to simulate an automation of product’s description classification. If the file does have the keyword, it will be moved to a specific subdirectory.</p>
<p>After each action, the robot will write a new line to a log Excel sheet, with information such as the name of the file, its creation date, besides the product’s information present in the files (type, price and discount).</p>
<p>The steps are the following:</p>
<ol class="arabic simple">
<li><p>Create new directories</p></li>
<li><p>Create a DataTable</p></li>
<li><p>Iterate over Files in Directory</p></li>
<li><p>Get File Name</p></li>
<li><p>Separate Files according to Extension</p></li>
<li><p>Read File</p></li>
<li><p>Get File Creation Date</p></li>
<li><p>Check File’s Content (Matches) and Extract Information</p></li>
<li><p>Move File</p></li>
<li><p>Rename File</p></li>
<li><p>Add Information to DataTable</p></li>
<li><p>Delete File</p></li>
<li><p>Save DataTable to Excel File</p></li>
</ol>
<div class="section" id="creating-new-directories">
<h3>Creating new directories<a class="headerlink" href="#creating-new-directories" title="Permalink to this headline">¶</a></h3>
<p>The first step is indicating the directory the files are in (a.k.a. root directory). To do this, the user will start a new Sequence and drag an <code class="docutils literal notranslate"><span class="pre">Assign</span></code> Activity into it. In the “To” field, the user will indicate an already existing argument. This arguments’s type must be “String”, since the path to the directory will be assigned to this argument as text (that is, it will be between quotation marks).</p>
<p>The next step is creating the subdirectories where the files will be moved to. Three directories will be created in this example: one for files that contain product information (“Product Info”), another one for files that do not have products information (“Other txt files”) and a third one for the log file (“Logs”). The procedure of creating will be same the same for all, the only difference being the name of each.</p>
<p>To create a new directory, the user will drag an <code class="docutils literal notranslate"><span class="pre">Assign</span></code> Activity into the Sequence. In the first field, the user will indicate another argument. The type of this argument will be found in the “Browse for Types…” option. The user may browse it or simply type “System.IO.DirectoryInfo”. It means that this argument will not store a string or integer; it will receive an expression that will create the new directory. Please note that the name of the argument will not be the name of the directory, it is only for use of the robot.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_createdirectories.png" src="images/openrpa_manipulatingfiles_createdirectories.png" />
</div>
<p>In the second field (i.e., “Enter a VB expression”), the user will type “System.IO.Directory.CreateDirectory(path of the new directory)”. Inside the parentheses, the user will type the path of the root directory plus the name of the new directory, as if it already existed. Again, the path must be between quotation marks. For example:</p>
<p>If the root directory is “C:example”, the user should type “C:examplesubdirectoryName” in order to create the subdirectory.</p>
</div>
<div class="section" id="creating-datatable">
<h3>Creating DataTable<a class="headerlink" href="#creating-datatable" title="Permalink to this headline">¶</a></h3>
<p>One more step is necessary before moving on to the files. Since a Log Excel file will be saved after the execution of the <code class="docutils literal notranslate"><span class="pre">Workflow</span></code>, a Datatable must be created in order to store the data during the process. It will be created at point of the <code class="docutils literal notranslate"><span class="pre">Workflow</span></code> in order to store the values globally.</p>
<p>This topic is already covered in other example of this documentation. Please follow <span class="xref std std-ref">Create an Empty DataTable</span> and keep in mind that the names of the Variables will not be same.</p>
</div>
<div class="section" id="iterating-over-files-in-directory">
<h3>Iterating over Files in Directory<a class="headerlink" href="#iterating-over-files-in-directory" title="Permalink to this headline">¶</a></h3>
<p>Since the task is classifing each file in the root directory, it is necessary to iterate over them.</p>
<p>The user will drag a <code class="docutils literal notranslate"><span class="pre">ForEachWithBodyFactor&lt;&gt;</span></code> Activity into the main Sequence, below the creation of the DataTable. In the first field, the user will find the word “item”, that represent each of the files in the directory. This name can be changed - any name will work.</p>
<p>The most important is the second field (“in”). Here the user will type the expression <code class="docutils literal notranslate"><span class="pre">System.IO.Directory.GetFiles(path)</span></code>, where “path” is the Argument already set with the path of the root directory at the beginning of the main Sequence (“path”). This expression will return a list of the full paths of the files in that directory. So the <code class="docutils literal notranslate"><span class="pre">ForEach</span></code> Activity will iterate over this list.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_iteratedirectory.png" src="images/openrpa_manipulatingfiles_iteratedirectory.png" />
</div>
<p>The third field is the Body, where Activities will be done with each file of the list. The following Activities will be performed inside this Body.</p>
</div>
<div class="section" id="get-file-name">
<h3>Get File Name<a class="headerlink" href="#get-file-name" title="Permalink to this headline">¶</a></h3>
<p>The first Activity inside the Body will be getting the file’s name. Please note that the <code class="docutils literal notranslate"><span class="pre">System.IO.Directory.GetFiles()</span></code> expression returns a list of full paths. In order to proceed with later Activities, the user must get the file name only.</p>
<p>The most simple way to achieve that is by using a VB expression. The user will drag a <code class="docutils literal notranslate"><span class="pre">Assign</span></code> Activity into the Body. In this example, the name of the Variable will be “file_name”. The expression is <code class="docutils literal notranslate"><span class="pre">System.IO.Path.GetFileName()</span></code> and the full path of the file must inserted inside the parentheses, i.e., the Variable “item”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here the user must use a Variable, not an Argument, since this value will change according to the file of the iteration. Please note that the scope of this Variable must be the Sequence inside the Body of the <code class="docutils literal notranslate"><span class="pre">ForEachWithBodyFactor&lt;&gt;</span></code> (here named “Iterate over files”). The type of this Variable will be “string”.</p>
</div>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_getfilename.png" src="images/openrpa_manipulatingfiles_getfilename.png" />
</div>
</div>
<div class="section" id="separate-files-according-to-extension">
<h3>Separate files according to Extension<a class="headerlink" href="#separate-files-according-to-extension" title="Permalink to this headline">¶</a></h3>
<p>After that, the user will drag an <code class="docutils literal notranslate"><span class="pre">If</span></code> Activity, right after the last step. The ideia here is to separate files according to their extension. In this example, only .txt files will be read, so any other extension will not be considered.</p>
<p>Inside the “”Condition” field, the user will type <code class="docutils literal notranslate"><span class="pre">System.IO.Path.GetExtension(file_name</span> <span class="pre">OR</span> <span class="pre">full</span> <span class="pre">path)</span> <span class="pre">=</span> <span class="pre">&quot;.txt&quot;</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is not the only way to get the extension of a file. The user could also use the VB expression “file_name.EndsWith(“.txt”)”. Note that this expression looks for strings inside strings, so it must be between quotation marks.</p>
</div>
<p>That is, IF the extension of the file is “.txt”, THEN the robot will proceed to the “Then” field; otherwise, the robot will proceed to the “Else” field.</p>
</div>
<div class="section" id="read-file">
<h3>Read File<a class="headerlink" href="#read-file" title="Permalink to this headline">¶</a></h3>
<p>Here the Sequence is split in two. Let’s first consider what will happen to the text files.</p>
<p>The first Activity performed with the text file will be reading its content. Again, the user will drag an <code class="docutils literal notranslate"><span class="pre">Assign</span></code> Activity into the “Then” field and use a Variable. In this example, the Variable’s name is “content” and its type is “string”.</p>
<p>The expression used to read the file is <code class="docutils literal notranslate"><span class="pre">System.IO.File.ReadAllText(file_name)</span></code>. The content will be stored in the Variable assigned.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_readfile.png" src="images/openrpa_manipulatingfiles_readfile.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ones that are not .txt are to be deleted in this example. It will be explained further in this tutorial.</p>
</div>
</div>
<div class="section" id="get-file-creation-date">
<h3>Get File Creation Date<a class="headerlink" href="#get-file-creation-date" title="Permalink to this headline">¶</a></h3>
<p>The next step is getting the file’s creation date. The procedure is much alike the previous one (Read File). That is, the user will use the <code class="docutils literal notranslate"><span class="pre">Assign</span></code> Activity in order to store the content of the VB expression.</p>
<p>In this case, the expression will be <code class="docutils literal notranslate"><span class="pre">System.IO.File.GetCreationTime(file_name).ToShortTimeString</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_getcreationdate.png" src="images/openrpa_manipulatingfiles_getcreationdate.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are other possibilities here. The user may get the Hour, Day, Month or even other information about the creation of the file. In order to this, the user must change the last part of the expression to the type of information required (e.g., <code class="docutils literal notranslate"><span class="pre">System.IO.File.GetCreationTime(file_name).Month</span></code>).</p>
</div>
</div>
<div class="section" id="check-file-s-content-matches-and-extract-information">
<h3>Check File’s Content (Matches) and Extract Information<a class="headerlink" href="#check-file-s-content-matches-and-extract-information" title="Permalink to this headline">¶</a></h3>
<p>In this example, before moving the file, some actions were added in order to extract information from the text file to add to the log file. The <code class="docutils literal notranslate"><span class="pre">Matches</span></code> Activitity was employed and users must pay attention to three of its properties: “Input”, “Pattern” and “Results”.</p>
<p>The first one, “Input”, is the string or Variable storing a string where the “Pattern” will be searched.</p>
<p>“Pattern” is the RegEx expression that will searched in the “Input” (please note that it must be between quotation marks).</p>
<p>Finally, “Results” is the Variable or Argument where the results are going to be stored (in this case, it must be a Variable).</p>
<p>Users must be aware that the type of this Variable must be <code class="docutils literal notranslate"><span class="pre">System.Text.RegularExpressions.Match</span></code>. It will be a list of the results. In this example, there is going to be only one result per match. In order to get this result, users must use the following syntax: variablename.First.ToString, that is, the first item of the list will be converted to string.</p>
</div>
<div class="section" id="move-files">
<h3>Move files<a class="headerlink" href="#move-files" title="Permalink to this headline">¶</a></h3>
<p>Once those steps are completed, the robot will classify the files according to their content. In this example, the criterion is the presence of product information.</p>
<p>The user will drag another <code class="docutils literal notranslate"><span class="pre">If</span></code> Activity into this Sequence (the Body of the previous <code class="docutils literal notranslate"><span class="pre">If</span></code> statement). The Variable “content”, that stores the content of the file, will be used here. The method is <code class="docutils literal notranslate"><span class="pre">.Contains(&quot;string&quot;)</span></code> and the syntax is the following: <code class="docutils literal notranslate"><span class="pre">content.Contains(&quot;product&quot;)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the searched term must be between quotation marks, since it is a string.</p>
</div>
<p>If the file has such term, the robot will proceed to the “Then” field; otherwise, it will proceed to the “Else”. In other words, this Activity is separating the files into two categories. This is a simple example, but more complex terms may be searched.</p>
<p>Considering the first possibility (that the file has product information), the robot will move it to the “Product Info” directory. In order to this, it is necessary to drag another Activity into the Sequence, a <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Code</span></code>. Moving files through <code class="docutils literal notranslate"><span class="pre">Assign</span></code> is not possible, since this action does not generate any value to be stored in an Argument or Variable.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_movefile.png" src="images/openrpa_manipulatingfiles_movefile.png" />
</div>
<p>The user will, then, click on “Open editor” to edit the code to be invoked. The user is free to choose whatever programming language of their preference. In this example, VB is used. The syntax of the expression is the following: <code class="docutils literal notranslate"><span class="pre">System.IO.File.Move(full</span> <span class="pre">path</span> <span class="pre">of</span> <span class="pre">origin,</span> <span class="pre">full</span> <span class="pre">path</span> <span class="pre">of</span> <span class="pre">destination)</span></code>. It is important to remark that the full path is required, i.e., including the name of the file.</p>
<p>The full path of the origin than be accessed through the Variable that stores the full path of the file (in this example, the “item” of the iteration). Another way to do that is by using the Argument that stores the path of the root directory (in this example, named “path”) and concatenate it with another string that contains the subdirectory plus the name of the file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The way to concatenate two or more strings is by using “&amp;”.</p>
</div>
</div>
<div class="section" id="rename-files">
<h3>Rename files<a class="headerlink" href="#rename-files" title="Permalink to this headline">¶</a></h3>
<p>In order to rename the files when moving them, the only thing users have to do is assiging a new name to the destination full path.</p>
<p>In this example, files were renamed by adding a new word to the beginning of their names, but any name could be set. When writing the expression to move the file, users must make sure the new name is written in the expression and concatenated to the path of the directory.</p>
</div>
<div class="section" id="add-information-to-datatable">
<h3>Add Information to DataTable<a class="headerlink" href="#add-information-to-datatable" title="Permalink to this headline">¶</a></h3>
<p>The next step is adding the information gathered about the file to the DataTable created in the beginning of the <code class="docutils literal notranslate"><span class="pre">Workflow</span></code>. User will drag a <code class="docutils literal notranslate"><span class="pre">AddDataRow</span></code> to the end of each sub workflow (i.e., to the text files that have product information, to the text files that do not have product information and also to the other files) in order to keep a record of each file processed.</p>
<p>The name of the DataTable must the one created previously so as to reference the new row to the correct DataTable. In the RowData, users will add the Variables’ name they want to add, following the syntax of a dictionary, that is, {variable, variable, variable}.</p>
<p>Further details can be found at <span class="xref std std-ref">Add this iterationâ€™s invoice to DataTable</span>. Please note taht this is another examples, so the names of the Variables must be changed according to this present example.</p>
</div>
<div class="section" id="delete-files">
<h3>Delete files<a class="headerlink" href="#delete-files" title="Permalink to this headline">¶</a></h3>
<p>Since only text files are being considered in this example, other files will be deleted. Here is not possible to use Variables nor Arguments, once this action does not generate any value to be stored in a Variable. So, users must use <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Code</span></code> Activity once again.</p>
<p>In this example, only the files that are not .txt will be deleted. That is, this Activity will be dropped to the ELSE field of the file’s extension filter.</p>
<p>The shortest way to delete a file is by adding the following line of code to the editor: <code class="docutils literal notranslate"><span class="pre">System.IO.File.Delete(file_name)</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_manipulatingfiles_deletefile.png" src="images/openrpa_manipulatingfiles_deletefile.png" />
</div>
</div>
<div class="section" id="save-datatable-to-excel-file">
<h3>Save DataTable to Excel file<a class="headerlink" href="#save-datatable-to-excel-file" title="Permalink to this headline">¶</a></h3>
<p>After all iterations run, the DataTable must be saved into an Excel file.</p>
<p>Please refer to <span class="xref std std-ref">Write Excel from DataTable</span>.</p>
</div>
</div>
<div class="section" id="soap-service">
<h2>SOAP Service<a class="headerlink" href="#soap-service" title="Permalink to this headline">¶</a></h2>
<p>In this  example, the user will create a Workflow that connects to a <strong>SOAP Service</strong> - <a class="reference external" href="https://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl">VIES VAT Validation</a> (<code class="docutils literal notranslate"><span class="pre">https://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl</span></code>) - using <code class="docutils literal notranslate"><span class="pre">Windows</span> <span class="pre">Powershell</span></code> and gather data from it using <code class="docutils literal notranslate"><span class="pre">WSDL</span></code> to capture the input data and exhibit the data gathered inside the <strong>Output bar</strong>.</p>
<ol class="arabic simple">
<li><p>Visualize how the SOAP Service is defined</p></li>
<li><p>Define Input and Output Variables</p></li>
<li><p>Connect to the SOAP Service and map the data inside Invoke Code</p></li>
<li><p>Exhibit the data gathered</p></li>
<li><p>Workflow Finished - Output</p></li>
</ol>
<div class="section" id="visualize-how-the-soap-service-is-defined">
<h3>Visualize how the SOAP Service is defined<a class="headerlink" href="#visualize-how-the-soap-service-is-defined" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will access the <code class="docutils literal notranslate"><span class="pre">WSDL</span></code> definition of the SOAP Service that will be connected to and define the input and output variables.</p>
<p>First, go to the <a class="reference external" href="https://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl">VIES VAT Validation</a> (<code class="docutils literal notranslate"><span class="pre">https://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl</span></code>) webservice page so we can check which class is going to be used to gather data.</p>
<p>As can be seen per the schema defined in the <code class="docutils literal notranslate"><span class="pre">.wsdl</span></code> file, the <code class="docutils literal notranslate"><span class="pre">targetNamespace</span></code> defined is <code class="docutils literal notranslate"><span class="pre">urn:ec.europa.eu:taxud:vies:services:checkVat:types</span></code>. That means the remaining elements which will be defined in the remaining of the template are types inherited from the <code class="docutils literal notranslate"><span class="pre">checkVat</span></code> class. This is the class which will be used to gather data from.</p>
<p>The main function inside the class is the <code class="docutils literal notranslate"><span class="pre">checkVat</span></code> function as well, this function receives two input parameters - <code class="docutils literal notranslate"><span class="pre">countryCode</span></code> and <code class="docutils literal notranslate"><span class="pre">vatNumber</span></code>. After it is called, it returns the contents of the <code class="docutils literal notranslate"><span class="pre">checkVatResponse</span></code> function - namely, <code class="docutils literal notranslate"><span class="pre">countryCode</span></code>, <code class="docutils literal notranslate"><span class="pre">vatNumber</span></code>, <code class="docutils literal notranslate"><span class="pre">requestDate</span></code>, <code class="docutils literal notranslate"><span class="pre">valid</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code>. That is, it returns the input parameters of <code class="docutils literal notranslate"><span class="pre">checkVat</span></code> (<code class="docutils literal notranslate"><span class="pre">countryCode</span></code>, <code class="docutils literal notranslate"><span class="pre">vatNumber</span></code>) and the output parameters of the call to the <code class="docutils literal notranslate"><span class="pre">checkVat</span></code> function (<code class="docutils literal notranslate"><span class="pre">requestDate</span></code>, <code class="docutils literal notranslate"><span class="pre">valid</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code>). The user is only going to use the <code class="docutils literal notranslate"><span class="pre">valid</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code> to exhibit the data returned.</p>
</div>
<div class="section" id="define-input-and-output-variables">
<h3>Define Input and Output Variables<a class="headerlink" href="#define-input-and-output-variables" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will define the input variables which will be passed to the <strong>SOAP Service</strong> and the output variables which will be used to store the contents of the call to the <strong>SOAP Service</strong>.</p>
<p>First, drag in an <strong>Assign</strong> activity to the main sequence. Enter the variable <code class="docutils literal notranslate"><span class="pre">countryCode</span></code> inside the <code class="docutils literal notranslate"><span class="pre">To</span></code> input field and <code class="docutils literal notranslate"><span class="pre">&quot;DK&quot;</span></code> inside the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">expression</span></code> field.</p>
<p>Now, drag in an <strong>Assign</strong> activity to the main sequence. Enter the variable <code class="docutils literal notranslate"><span class="pre">vatNumber</span></code> inside the <code class="docutils literal notranslate"><span class="pre">To</span></code> input field and  <code class="docutils literal notranslate"><span class="pre">&quot;40400230&quot;</span></code> inside the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">expression</span></code> field.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field or create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<div class="figure align-default">
<img alt="images/check_soap_service_define_input_variables.png" src="images/check_soap_service_define_input_variables.png" />
</div>
<p>Now, we must manually define the other output variables which will be returned - namely, <code class="docutils literal notranslate"><span class="pre">valid</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code>. <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code> are <code class="docutils literal notranslate"><span class="pre">String</span></code> variables, whereas <code class="docutils literal notranslate"><span class="pre">valid</span></code> is a <code class="docutils literal notranslate"><span class="pre">Boolean</span></code> variable. This is easily seen in the definition of the <code class="docutils literal notranslate"><span class="pre">checkVatResponse</span></code> function inside the <code class="docutils literal notranslate"><span class="pre">WSDL</span></code> file. For the definition of the <code class="docutils literal notranslate"><span class="pre">valid</span></code> variable, the <code class="docutils literal notranslate"><span class="pre">&lt;xsd:element&gt;</span></code>’s <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter is seen as <code class="docutils literal notranslate"><span class="pre">xsd:boolean</span></code> and for the two other ones, their type is seen as <code class="docutils literal notranslate"><span class="pre">xsd:string</span></code>.</p>
<div class="figure align-center">
<img alt="images/check_soap_service_response_class.png" src="images/check_soap_service_response_class.png" />
</div>
<p>All that is needed to do now is create these output variables inside the <strong>Variables, Imports &amp; Arguments box</strong>, in the <code class="docutils literal notranslate"><span class="pre">Variables</span> <span class="pre">section</span></code>.</p>
<div class="figure align-center">
<img alt="images/check_soap_service_create_output_variables.png" src="images/check_soap_service_create_output_variables.png" />
</div>
</div>
<div class="section" id="connect-to-the-soap-service-and-map-the-data-inside-invoke-code">
<h3>Connect to the SOAP Service and map the data inside Invoke Code<a class="headerlink" href="#connect-to-the-soap-service-and-map-the-data-inside-invoke-code" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to map data to the <strong>Invoke Code</strong> activity and how to execute a call to a <strong>SOAP Service</strong> by using the <code class="docutils literal notranslate"><span class="pre">Powershell</span></code> language.</p>
<p>First, drag an <strong>Invoke Code</strong> activity into the main sequence. Open the editor by clicking the <strong>Open Editor</strong> button and set its language as <code class="docutils literal notranslate"><span class="pre">PowerShell</span></code>.</p>
<div class="figure align-center">
<img alt="images/check_soap_service_drag_invoke_code.png" src="images/check_soap_service_drag_invoke_code.png" />
</div>
<div class="figure align-center">
<img alt="images/check_soap_service_open_editor.png" src="images/check_soap_service_open_editor.png" />
</div>
<p>Now, insert the following code into the editor:</p>
<div class="highlight-Powershell notranslate"><div class="highlight"><pre><span></span> <span class="nv">$Client</span> <span class="p">=</span> <span class="nb">New-WebServiceProxy</span> <span class="n">-Uri</span> <span class="s2">&quot;http://ec.europa.eu/taxation_customs/vies/checkVatService.wsdl&quot;</span> <span class="n">-Class</span> <span class="s2">&quot;checkVat&quot;</span>
<span class="nv">$DateChecked</span> <span class="p">=</span> <span class="nv">$Client</span><span class="p">.</span><span class="n">checkVat</span><span class="p">(</span><span class="no">[ref]</span><span class="nv">$countryCode</span><span class="p">,</span> <span class="no">[ref]</span><span class="nv">$vatNumber</span><span class="p">,</span> <span class="no">[ref]</span><span class="nv">$valid</span><span class="p">,</span> <span class="no">[ref]</span><span class="nv">$name</span><span class="p">,</span> <span class="no">[ref]</span><span class="nv">$address</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">$Client</span></code> line connects to the <cite>VIES VAT Validation</cite> webservice and defines the <code class="docutils literal notranslate"><span class="pre">class</span></code> that will be used to gather data from: <code class="docutils literal notranslate"><span class="pre">checkVat</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">$DateChecked</span></code> line executes the <code class="docutils literal notranslate"><span class="pre">checkVat</span></code> defined, as has been seen in the past section and maps the variables which will be returned - <code class="docutils literal notranslate"><span class="pre">countryCode</span></code>, <code class="docutils literal notranslate"><span class="pre">vatNumber</span></code>, <code class="docutils literal notranslate"><span class="pre">valid</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">address</span></code> - by using <a class="reference external" href="https://ss64.com/ps/syntax-ref.html">Reference Variables</a> (<code class="docutils literal notranslate"><span class="pre">https://ss64.com/ps/syntax-ref.html</span></code>).</p>
</div>
<div class="section" id="exhibit-the-data-gathered">
<h3>Exhibit the data gathered<a class="headerlink" href="#exhibit-the-data-gathered" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will view the data gathered through the <strong>Output bar</strong> by using the <strong>Write Line</strong> activity.</p>
<p>First, drag in a <strong>WriteLine</strong> activity to the main sequence and type <code class="docutils literal notranslate"><span class="pre">valid.ToString</span></code> inside the <code class="docutils literal notranslate"><span class="pre">Text</span></code> input field.</p>
<p>Now, drag in a <strong>WriteLine</strong> activity to the main sequence and type <code class="docutils literal notranslate"><span class="pre">name</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> input field.</p>
<p>Finally, drag in a <strong>WriteLine</strong> activity to the main sequence and type <code class="docutils literal notranslate"><span class="pre">address</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> input field.</p>
<div class="figure align-center">
<img alt="images/check_soap_service_writeline.png" src="images/check_soap_service_writeline.png" />
</div>
</div>
<div class="section" id="workflow-finished-output">
<h3>Workflow Finished - Output<a class="headerlink" href="#workflow-finished-output" title="Permalink to this headline">¶</a></h3>
<p>Here’s a snippet of the contents of the output of this workflow example.</p>
<div class="figure align-center">
<img alt="images/check_soap_service_finished.png" src="images/check_soap_service_finished.png" />
</div>
</div>
</div>
<div class="section" id="rest-service-integration-with-node-red">
<h2>REST Service (integration with Node-RED)<a class="headerlink" href="#rest-service-integration-with-node-red" title="Permalink to this headline">¶</a></h2>
<p>In this example, the user will create a workflow that connects to the <a class="reference external" href="https://api.chucknorris.io/">Chuck Norris Jokes API</a> (<code class="docutils literal notranslate"><span class="pre">https://api.chucknorris.io/</span></code>) and captures a joke.</p>
<p>The user will also create a dialog box using <a class="reference external" href="https://github.com/WPF-Forge/Forge.Forms">Forge.Forms dynamic WPF forms</a> (<code class="docutils literal notranslate"><span class="pre">https://github.com/WPF-Forge/Forge.Forms</span></code>) where a category for the joke can be selected.</p>
<p>A simple validation method is also used to check whether the message is a Chuck Norris joke or not.</p>
<p>The steps are listed below.</p>
<ol class="arabic simple">
<li><p>Configure Variable Passing To/From in Node-RED</p></li>
<li><p>Message Manipulation in Nodeâ€‘RED</p></li>
<li><p>OpenRPA Forms</p></li>
<li><p>Invoke Workflow through openrpa</p></li>
<li><p>Create Joke Failed Workflow</p></li>
<li><p>Evaluate Chuck Norris Joke</p></li>
<li><p>Invoke Joke Failed Workflow</p></li>
<li><p>Setting Evaluation Failure case in Node-RED</p></li>
<li><p>Output logic</p></li>
<li><p>Workflow Finished</p></li>
</ol>
<div class="section" id="configure-variable-passing-to-from-in-node-red">
<h3>Configure Variable Passing To/From in Node-RED<a class="headerlink" href="#configure-variable-passing-to-from-in-node-red" title="Permalink to this headline">¶</a></h3>
<p>Here lies the logic behind receiving data from the robot, querying the Chuck Norris API, and then returning the values back to the robot.</p>
<p><strong>Workflow Logic</strong></p>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_in_drag.png"><img alt="images/openrpa_workflow_example_rest_workflow_in_drag.png" src="images/openrpa_workflow_example_rest_workflow_in_drag.png" style="width: 526.5px; height: 329.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_in_workspace.png"><img alt="images/openrpa_workflow_example_rest_workflow_in_workspace.png" src="images/openrpa_workflow_example_rest_workflow_in_workspace.png" style="width: 524.0px; height: 328.0px;" /></a>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">Queue</span> <span class="pre">name</span></code> to define the queue that the OpenFlow workflow will assign to in <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code>’s properties. The queue name is completely arbitrary, the user can choose for any name they wish to. In our case, it is set as <code class="docutils literal notranslate"><span class="pre">chuckapi</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To access any node’s properties inside the Node-RED workspace, simply double click the given node. The <strong>Properties box</strong> for the node, containing each input field required by itself, will then appear.</p>
</div>
<p>Check the <code class="docutils literal notranslate"><span class="pre">RPA</span></code> checkbox to allow this flow’s workflow to be invoked from OpenRPA agents.</p>
<p>Set the name for the workflow in the <code class="docutils literal notranslate"><span class="pre">Name</span></code> input field. In our case, it is set as <code class="docutils literal notranslate"><span class="pre">ChuckAPI</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_in_double_click.png"><img alt="images/openrpa_workflow_example_rest_workflow_in_double_click.png" src="images/openrpa_workflow_example_rest_workflow_in_double_click.png" style="width: 524.0px; height: 328.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_in_set_properties.png"><img alt="images/openrpa_workflow_example_rest_workflow_in_set_properties.png" src="images/openrpa_workflow_example_rest_workflow_in_set_properties.png" style="width: 525.5px; height: 328.0px;" /></a>
</div>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">Request</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_http_request_drag.png"><img alt="images/openrpa_workflow_example_rest_http_request_drag.png" src="images/openrpa_workflow_example_rest_http_request_drag.png" style="width: 524.5px; height: 329.5px;" /></a>
</div>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code> node to the <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">Request</span></code> node.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_http_request_nodes_connect.png"><img alt="images/openrpa_workflow_example_rest_http_request_nodes_connect.png" src="images/openrpa_workflow_example_rest_http_request_nodes_connect.png" style="width: 525.5px; height: 329.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_http_request_nodes_connected.png"><img alt="images/openrpa_workflow_example_rest_http_request_nodes_connected.png" src="images/openrpa_workflow_example_rest_http_request_nodes_connected.png" style="width: 522.0px; height: 328.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To easily connect a node, simply press the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key while clicking in the grey rectangles - called ports - in each node’s the outer part. The user can also click and hold to connect the nodes, but the author finds it more feasible simply using the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key.</p>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">Method</span></code> for the request as <code class="docutils literal notranslate"><span class="pre">GET</span></code>.</p>
<p>Set the desired <code class="docutils literal notranslate"><span class="pre">URL</span></code> for the API, which the request will be sent to. In our case, <code class="docutils literal notranslate"><span class="pre">https://api.chucknorris.io/jokes/random?category={{category}}</span></code>.</p>
<p>The variable inside the <a class="reference external" href="https://mustache.github.io/mustache.5.html">Mustache</a> (<a class="reference external" href="https://mustache.github.io/mustache.5.html">https://mustache.github.io/mustache.5.html</a>), ie. <code class="docutils literal notranslate"><span class="pre">category</span></code> is arbitrarily named as well.</p>
<p>This variable will be used by OpenRPA to pass the value of choice captured from the user. The user may name it as per his own option.</p>
<p>Set the desired <code class="docutils literal notranslate"><span class="pre">Return</span></code> type, which will be returned. In our case, it’s <code class="docutils literal notranslate"><span class="pre">parsed</span> <span class="pre">JSON</span> <span class="pre">object</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_http_request_set_properties.png"><img alt="images/openrpa_workflow_example_rest_http_request_set_properties.png" src="images/openrpa_workflow_example_rest_http_request_set_properties.png" style="width: 526.0px; height: 328.5px;" /></a>
</div>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">Out</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_out_drag.png"><img alt="images/openrpa_workflow_example_rest_workflow_out_drag.png" src="images/openrpa_workflow_example_rest_workflow_out_drag.png" style="width: 526.5px; height: 329.0px;" /></a>
</div>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">Request</span></code> node to the <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">Out</span></code> node.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_out_nodes_connect.png"><img alt="images/openrpa_workflow_example_rest_workflow_out_nodes_connect.png" src="images/openrpa_workflow_example_rest_workflow_out_nodes_connect.png" style="width: 526.5px; height: 329.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_workflow_out_nodes_connected.png"><img alt="images/openrpa_workflow_example_rest_workflow_out_nodes_connected.png" src="images/openrpa_workflow_example_rest_workflow_out_nodes_connected.png" style="width: 526.5px; height: 328.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To easily connect a node simply press the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key while clicking in the grey rectangles - called ports - in each node’s the outer part. The user can also click and hold to connect the nodes but the author finds it more feasible simply using the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key.</p>
</div>
<p>Deploy your flow by clicking the red Deploy button at the top-left side of the screen.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_chuck_api_deploy.png"><img alt="images/openrpa_workflow_example_rest_chuck_api_deploy.png" src="images/openrpa_workflow_example_rest_chuck_api_deploy.png" style="width: 682.5px; height: 328.0px;" /></a>
</div>
</div>
<div class="section" id="message-manipulation-in-node-red">
<h3>Message Manipulation in Node-RED<a class="headerlink" href="#message-manipulation-in-node-red" title="Permalink to this headline">¶</a></h3>
<p>Now we want to send a parameter from OpenRPA to Node-RED so that our workflow is not so static.</p>
<p>This parameter contains a <code class="docutils literal notranslate"><span class="pre">category</span></code> to which the <code class="docutils literal notranslate"><span class="pre">Chuck</span> <span class="pre">Norris</span> <span class="pre">API</span></code>’s joke will relate.</p>
<p>Changing parameters from a variable gathered through a workflow inside Node-RED is easily done through the <code class="docutils literal notranslate"><span class="pre">Function</span></code> node and its properties.</p>
<p>Robots <code class="docutils literal notranslate"><span class="pre">In/Out</span></code> arguments always are passed to the <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> attribute (in Node-RED) and it is easy to manipulate these by using the <code class="docutils literal notranslate"><span class="pre">Function</span></code> node.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rest_function_node.png" src="images/openrpa_workflow_example_rest_function_node.png" />
</div>
<p>Simply drag a <code class="docutils literal notranslate"><span class="pre">Function</span></code> node to the workflow, between the <strong>ChuckAPI</strong> <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code> node and <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">Request</span></code> node.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To automatically add a node and bind it to the sequence, drag it while pressing the <code class="docutils literal notranslate"><span class="pre">Shift</span></code> key. This way, the node is automatically entered in-between the sequence already established before it was dragged.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_parameter_passing_function_drag.png"><img alt="images/openrpa_workflow_example_rest_parameter_passing_function_drag.png" src="images/openrpa_workflow_example_rest_parameter_passing_function_drag.png" style="width: 526.0px; height: 328.5px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_parameter_passing_function_workspace.png"><img alt="images/openrpa_workflow_example_rest_parameter_passing_function_workspace.png" src="images/openrpa_workflow_example_rest_parameter_passing_function_workspace.png" style="width: 526.0px; height: 328.0px;" /></a>
</div>
<p>In our example, the parameters needed are <code class="docutils literal notranslate"><span class="pre">msg.category</span></code> - which will be gathered as <code class="docutils literal notranslate"><span class="pre">msg.payload.category</span></code> from the <code class="docutils literal notranslate"><span class="pre">category</span></code> argument passed by the OpenRPA workflow.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_parameter_passing_function_double_click.png"><img alt="images/openrpa_workflow_example_rest_parameter_passing_function_double_click.png" src="images/openrpa_workflow_example_rest_parameter_passing_function_double_click.png" style="width: 526.0px; height: 328.0px;" /></a>
</div>
<p>In the <code class="docutils literal notranslate"><span class="pre">Function</span></code> node’s properties, set <code class="docutils literal notranslate"><span class="pre">msg.category</span> <span class="pre">=</span> <span class="pre">msg.payload.category</span></code>.</p>
<p>This is used so we can set the <code class="docutils literal notranslate"><span class="pre">category</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">HTTP</span> <span class="pre">Request</span></code> node, captured from the OpenRPA workflow, which the user will build next.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_parameter_passing_function_set_properties.png"><img alt="images/openrpa_workflow_example_rest_parameter_passing_function_set_properties.png" src="images/openrpa_workflow_example_rest_parameter_passing_function_set_properties.png" style="width: 526.0px; height: 328.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this example, the user could use the <code class="docutils literal notranslate"><span class="pre">Change</span></code> node to set the <code class="docutils literal notranslate"><span class="pre">msg.category</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">msg.payload.category</span></code> as well, or simply pass <code class="docutils literal notranslate"><span class="pre">msg.payload.category</span></code> directly to the HTTP Request, which will be discussed further on.</p>
</div>
</div>
<div class="section" id="openrpa-forms">
<h3>OpenRPA Forms<a class="headerlink" href="#openrpa-forms" title="Permalink to this headline">¶</a></h3>
<p>Now the user creates a dynamic WPF form to gather the <code class="docutils literal notranslate"><span class="pre">category</span></code> value from the client.</p>
<p>First, drag a <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Formula</span></code> snippet to the main sequence.</p>
<p>Now click <code class="docutils literal notranslate"><span class="pre">Open</span> <span class="pre">designer</span></code> to open the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_openrpa_forms_click_open_designer_button.png"><img alt="images/openrpa_workflow_example_rest_openrpa_forms_click_open_designer_button.png" src="images/openrpa_workflow_example_rest_openrpa_forms_click_open_designer_button.png" style="width: 464.5px; height: 267.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code> is the place where the user can create his desired WPF forms to gather input from the client. On the right-side of it, a preview of the input form is shown. On the left-side of it, the user enters the code used to design the input form. After adding code to the <code class="docutils literal notranslate"><span class="pre">Form</span> <span class="pre">Designer</span></code>, always press the <strong>Build form</strong> button to save changes and visualize the preview.</p>
</div>
<p>Clear all example code and add the code snippet below to the designer code editor. Then press the <strong>Build form</strong> button to update the form.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_openrpa_forms_empty_designer.png"><img alt="images/openrpa_workflow_example_rest_openrpa_forms_empty_designer.png" src="images/openrpa_workflow_example_rest_openrpa_forms_empty_designer.png" style="width: 394.0px; height: 222.5px;" /></a>
</div>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">form-designer</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Choose Chuck Norris API Category<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
 <span class="p">&lt;</span><span class="nt">heading</span><span class="p">&gt;</span>
Please enter the desired category number inside the input field. The returned joke will be related to the selected category.
<span class="p">&lt;/</span><span class="nt">heading</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;category&quot;</span> <span class="na">label</span><span class="o">=</span><span class="s">&quot;Choose the desired category&quot;</span><span class="p">&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;animal&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;career&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;celebrity&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;dev&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;explicit&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;fashion&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;food&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;history&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;money&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;movie&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;music&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;political&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;region&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;science&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;sport&quot;</span> <span class="p">/&gt;</span>
   <span class="p">&lt;</span><span class="nt">option</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;travel&quot;</span> <span class="p">/&gt;</span>
<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">action</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#39;SUBMIT&#39;</span> <span class="na">icon</span><span class="o">=</span><span class="s">&#39;check&#39;</span> <span class="na">validates</span><span class="o">=</span><span class="s">&#39;true&#39;</span> <span class="na">ClosesDialog</span><span class="o">=</span><span class="s">&#39;true&#39;</span> <span class="p">&gt;&lt;/</span><span class="nt">action</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">form-designer</span><span class="p">&gt;</span>
</pre></div>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_openrpa_forms_filled_designer.png"><img alt="images/openrpa_workflow_example_rest_openrpa_forms_filled_designer.png" src="images/openrpa_workflow_example_rest_openrpa_forms_filled_designer.png" style="width: 394.0px; height: 222.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>After adding the code snippet, all the variables used in the WPF form can be automatically created by pressing the <strong>Create variables</strong> button.</p>
</div>
<p>In our case, the workflow is unable to use a <code class="docutils literal notranslate"><span class="pre">Variable</span></code>. Since the value will be consumed by Node-RED, it must obligatorily be set as an <code class="docutils literal notranslate"><span class="pre">Argument</span></code> with <strong>Direction</strong> set as <code class="docutils literal notranslate"><span class="pre">In/Out</span></code> or <code class="docutils literal notranslate"><span class="pre">Out</span></code> and type <code class="docutils literal notranslate"><span class="pre">String</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_openrpa_forms_arguments_box.png"><img alt="images/openrpa_workflow_example_rest_openrpa_forms_arguments_box.png" src="images/openrpa_workflow_example_rest_openrpa_forms_arguments_box.png" style="width: 466.0px; height: 267.5px;" /></a>
</div>
<p>Now, to guarantee that the value gathered from the WPF form has the correct type, the user will cast it to a <code class="docutils literal notranslate"><span class="pre">String</span></code> using the <strong>Assign</strong> activity.</p>
</div>
<div class="section" id="invoke-workflow-through-openrpa">
<h3>Invoke Workflow through OpenRPA<a class="headerlink" href="#invoke-workflow-through-openrpa" title="Permalink to this headline">¶</a></h3>
<p>Now its time to finally invoke the workflow through OpenRPA and devise the processing logic.</p>
<p>Since the flow is already deployed, it is needed that the user synchronizes the workflows with the OpenFlow repository.</p>
<p>To do the task as mentioned before, click the <strong>Reload</strong> button inside OpenRPA’s ribbon. This will refresh all workflows contained inside the OpenFlow repository to OpenRPA.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_invoke_openflow_click_reload_button.png"><img alt="images/openrpa_workflow_example_rest_invoke_openflow_click_reload_button.png" src="images/openrpa_workflow_example_rest_invoke_openflow_click_reload_button.png" style="width: 683.0px; height: 340.0px;" /></a>
</div>
<p>Drag an <strong>Invoke OpenFlow</strong> activity to the main sequence inside OpenRPA’s Designer.</p>
<p>Select the <strong>RPA Workflow</strong>, which you want to invoke. In our case <code class="docutils literal notranslate"><span class="pre">ChuckAPI</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_invoke_openflow_drag_activity.png"><img alt="images/openrpa_workflow_example_rest_invoke_openflow_drag_activity.png" src="images/openrpa_workflow_example_rest_invoke_openflow_drag_activity.png" style="width: 465.0px; height: 267.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_invoke_openflow_chuck_api_selected.png"><img alt="images/openrpa_workflow_example_rest_invoke_openflow_chuck_api_selected.png" src="images/openrpa_workflow_example_rest_invoke_openflow_chuck_api_selected.png" style="width: 465.0px; height: 267.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note: When Node-RED finishes executing the flow, whatever is set in the msg.payload will return back to the robot. Variables are automatically mapped between the two applications: if msg.payload.person exists in NodeRED, whatever returns in there will automatically go in the variable named “person” inside OpenRPA.</p>
</div>
</div>
<div class="section" id="create-joke-failed-workflow">
<h3>Create Joke Failed Workflow<a class="headerlink" href="#create-joke-failed-workflow" title="Permalink to this headline">¶</a></h3>
<p>Now that the ChuckAPI process is set, the user can proceed to set a workflow which will be executed in case any failures occur upon execution of the usual process.</p>
<p>Create a new workflow; in our case the name <code class="docutils literal notranslate"><span class="pre">REST</span> <span class="pre">Workflow</span> <span class="pre">Example</span> <span class="pre">-</span> <span class="pre">Joke</span> <span class="pre">Failed</span></code> is used to specify the workflow.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_create_joke_failed_empty_workflow.png"><img alt="images/openrpa_workflow_example_rest_create_joke_failed_empty_workflow.png" src="images/openrpa_workflow_example_rest_create_joke_failed_empty_workflow.png" style="width: 682.0px; height: 281.5px;" /></a>
</div>
<p>Drag a <strong>WriteLine</strong> activity to the main sequence.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_create_joke_failed_drag_write_line.png"><img alt="images/openrpa_workflow_example_rest_create_joke_failed_drag_write_line.png" src="images/openrpa_workflow_example_rest_create_joke_failed_drag_write_line.png" style="width: 464.5px; height: 267.0px;" /></a>
</div>
<p>Now it is needed to create the default variable - inside the <strong>Variables, Arguments &amp; Imports box</strong> - from which the entry containing the <code class="docutils literal notranslate"><span class="pre">Chuck</span> <span class="pre">Norris</span> <span class="pre">API</span></code> joke content is returned. This variable alias is <code class="docutils literal notranslate"><span class="pre">value</span></code>, as shown in <a class="reference external" href="https://api.chucknorris.io/jokes/random">Chuck Norris API Random Joke</a> (<code class="docutils literal notranslate"><span class="pre">https://api.chucknorris.io/jokes/random</span></code>).</p>
<p>Set the output value, in the <code class="docutils literal notranslate"><span class="pre">Text</span></code> input field or through the <strong>Properties box</strong> to a new variable of alias <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_create_joke_failed_set_text_value.png"><img alt="images/openrpa_workflow_example_rest_create_joke_failed_set_text_value.png" src="images/openrpa_workflow_example_rest_create_joke_failed_set_text_value.png" style="width: 464.5px; height: 267.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field or create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<p>This workflow is merely used as an example of the almost endless possibilities within OpenRPA. The user could read the <code class="docutils literal notranslate"><span class="pre">ChuckAPI</span></code> joke into a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> or <code class="docutils literal notranslate"><span class="pre">.xslx</span></code> file, invoke one or many more workflows to deal with the data, pass it into <code class="docutils literal notranslate"><span class="pre">MongoDB</span> <span class="pre">Entities</span></code> - as stated before, there are almost no limits to what the user can accomplish in terms of automation.</p>
</div>
<div class="section" id="evaluate-chuck-norris-joke">
<h3>Evaluate Chuck Norris Joke<a class="headerlink" href="#evaluate-chuck-norris-joke" title="Permalink to this headline">¶</a></h3>
<p>Here we set the evaluation process for check whether the joke captured from the <code class="docutils literal notranslate"><span class="pre">Chuck</span> <span class="pre">Norris</span> <span class="pre">API</span></code> is a joke or not.</p>
<p>The validation standard used here is to check whether the content of the <code class="docutils literal notranslate"><span class="pre">value</span></code> entry in the <code class="docutils literal notranslate"><span class="pre">JSON</span> <span class="pre">Dictionary</span></code> returned contains the string “Chuck Norris” or not.</p>
<p>First, the user needs to create the default variable - inside the <strong>Variables, Arguments &amp; Imports box</strong> - from which the entry containing the <code class="docutils literal notranslate"><span class="pre">Chuck</span> <span class="pre">Norris</span> <span class="pre">API</span></code> joke content is returned. This variable alias is <code class="docutils literal notranslate"><span class="pre">value</span></code>, as it can be seen in <a class="reference external" href="https://api.chucknorris.io/jokes/random">Chuck Norris API Random Joke</a> (<code class="docutils literal notranslate"><span class="pre">https://api.chucknorris.io/jokes/random</span></code>).</p>
<p>In <code class="docutils literal notranslate"><span class="pre">REST</span> <span class="pre">Workflow</span> <span class="pre">Example</span></code> workflow, drag an <strong>If</strong> activity to the Designer.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_drag_if.png"><img alt="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_drag_if.png" src="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_drag_if.png" style="width: 464.5px; height: 266.5px;" /></a>
</div>
<p>Enter <code class="docutils literal notranslate"><span class="pre">value.Contains(&quot;Chuck</span> <span class="pre">Norris&quot;)</span></code> inside the <code class="docutils literal notranslate"><span class="pre">Condition</span></code> input field, shown in the activity itself or inside the <strong>Properties box</strong>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_set_evaluation_condition.png"><img alt="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_set_evaluation_condition.png" src="images/openrpa_workflow_example_rest_evaluate_chuck_norris_joke_set_evaluation_condition.png" style="width: 464.5px; height: 266.0px;" /></a>
</div>
</div>
<div class="section" id="setting-evaluation-failed-process-in-node-red">
<h3>Setting Evaluation Failed process in Node-RED<a class="headerlink" href="#setting-evaluation-failed-process-in-node-red" title="Permalink to this headline">¶</a></h3>
<p>The user must now set the proper flow that will be further executed in case of failure of evaluation of the <code class="docutils literal notranslate"><span class="pre">ChuckAPI</span></code> process.</p>
<p><strong>Workflow Logic</strong></p>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_drag.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_drag.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_drag.png" style="width: 527.0px; height: 328.0px;" /></a>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">Queue</span> <span class="pre">name</span></code> to define the queue that the OpenFlow workflow will be assigned to in <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code>’s properties.</p>
<p>The queue name is completely arbitrary, the user can choose for any name they wish to. In our case, it is set as <code class="docutils literal notranslate"><span class="pre">jokefailed</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To access any node’s properties inside the Node-RED workspace, simply double click the given node. The <strong>Properties box</strong> for the node, containing each input field required by itself, will then appear.</p>
</div>
<p>Check the <code class="docutils literal notranslate"><span class="pre">RPA</span></code> checkbox to allow this flow’s workflow to be invoked from OpenRPA agents.</p>
<p>Set the name for the workflow in the <code class="docutils literal notranslate"><span class="pre">Name</span></code> input field. Again, it is named arbitrarily. In our case, it is set as <code class="docutils literal notranslate"><span class="pre">Joke</span> <span class="pre">Failed</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_double_click.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_double_click.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_double_click.png" style="width: 526.5px; height: 308.0px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_set_properties.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_set_properties.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_in_set_properties.png" style="width: 526.5px; height: 331.5px;" /></a>
</div>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">RPA</span> <span class="pre">Workflow</span></code> or <code class="docutils literal notranslate"><span class="pre">Robot</span></code> node to the workspace. This node enables us to invoke the <code class="docutils literal notranslate"><span class="pre">REST</span> <span class="pre">Workflow</span> <span class="pre">-</span> <span class="pre">Joke</span> <span class="pre">Failed</span></code> workflow upon evaluation failure.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_drag.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_drag.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_drag.png" style="width: 526.5px; height: 327.5px;" /></a>
</div>
<p>Set the <code class="docutils literal notranslate"><span class="pre">Robot</span></code> which will invoke the workflow and the <code class="docutils literal notranslate"><span class="pre">Workflow</span></code> which will be invoked, inside <code class="docutils literal notranslate"><span class="pre">robot</span></code> node’s properties. As well as <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">queue</span> <span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">Name</span></code> for the node.</p>
<p><code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">queue</span> <span class="pre">name</span></code> is arbitrary, it is used to set the queue which will be used for queueing the robot instances.</p>
<p><code class="docutils literal notranslate"><span class="pre">Name</span></code> parameter is used only for displaying purposes inside Node-RED.</p>
<p>In our case, <code class="docutils literal notranslate"><span class="pre">Local</span> <span class="pre">queue</span> <span class="pre">name</span></code> is set as <code class="docutils literal notranslate"><span class="pre">jokefailed</span></code> and <code class="docutils literal notranslate"><span class="pre">Name</span></code> is set as <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Joke</span> <span class="pre">Failed</span> <span class="pre">Workflow</span></code>.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_set_properties.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_set_properties.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_set_properties.png" style="width: 525.5px; height: 328.0px;" /></a>
</div>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">In</span></code> node to the <code class="docutils literal notranslate"><span class="pre">Robot</span></code> node.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connect_node.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connect_node.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connect_node.png" style="width: 525.5px; height: 328.5px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connected_node.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connected_node.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_robot_connected_node.png" style="width: 526.0px; height: 329.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To easily connect a node, simply press the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key while clicking in the grey rectangles - called ports - in each node’s the outer part. The user can also click and hold to connect the nodes, but the author finds it more feasible simply using the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key.</p>
</div>
<p>Drag an <code class="docutils literal notranslate"><span class="pre">Email</span> <span class="pre">Out</span></code> node - the one with the letter icon to the right-most side of the activity - to the workspace. This node will be responsible for sending the <code class="docutils literal notranslate"><span class="pre">msg.payload</span></code> object JSON stringified to the selected email when an error occurs upon evaluation.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_drag.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_drag.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_drag.png" style="width: 526.5px; height: 326.0px;" /></a>
</div>
<p>Connect the top-most port in the <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">Joke</span> <span class="pre">Failed</span> <span class="pre">Workflow</span></code> node to the port outside the <code class="docutils literal notranslate"><span class="pre">email</span></code> node.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To easily connect a node simply press the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key while clicking in the grey rectangles - called ports - in the outer part of each node. The user can also click and hold to connect the nodes but the author finds it more feasible simply using the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connect_node.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connect_node.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connect_node.png" style="width: 526.5px; height: 327.5px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connected_node.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connected_node.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_connected_node.png" style="width: 526.5px; height: 329.0px;" /></a>
</div>
<p>Set the properties for the <code class="docutils literal notranslate"><span class="pre">email</span></code> node.</p>
<p><code class="docutils literal notranslate"><span class="pre">To</span></code> refers to the e-mail address from the receiver.</p>
<p><code class="docutils literal notranslate"><span class="pre">Userid</span></code> is the  UserId from the account, which will send the e-mail. (ie. e-mail without a domain - if the e-mail is <code class="docutils literal notranslate"><span class="pre">admin&#64;openrpa.dk</span></code>, then your UserId is <code class="docutils literal notranslate"><span class="pre">admin</span></code>)</p>
<p><code class="docutils literal notranslate"><span class="pre">Password</span></code> - the password for the email account from the sender.</p>
<p>In our case, a dummy e-mail is set - as <code class="docutils literal notranslate"><span class="pre">admin&#64;gmail.com</span></code>, which will be used to send and receive the message. It is noted here that the user must change the e-mail, or else the workflow obviously won’t work.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_set_properties.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_set_properties.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_email_set_properties.png" style="width: 525.5px; height: 329.5px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the user is using Gmail’s SMTP Server, it is needed that the settings for allowing <strong>Less secure app access</strong> are correct. Else, the user will receive an error message upon the execution of the workflow. To do that, refer to <a class="reference external" href="https://myaccount.google.com/lesssecureapps">Less secure app access</a> (<code class="docutils literal notranslate"><span class="pre">https://myaccount.google.com/lesssecureapps</span></code>) and make sure that the <code class="docutils literal notranslate"><span class="pre">Allow</span> <span class="pre">less</span> <span class="pre">secure</span> <span class="pre">apps</span></code> settings is set to <code class="docutils literal notranslate"><span class="pre">ON</span></code>.</p>
</div>
<p>Drag a <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">Out</span></code> node to the workspace.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_drag.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_drag.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_drag.png" style="width: 526.0px; height: 326.5px;" /></a>
</div>
<p>Connect the <code class="docutils literal notranslate"><span class="pre">Workflow</span> <span class="pre">Out</span></code> node to the <code class="docutils literal notranslate"><span class="pre">email</span></code> - now <code class="docutils literal notranslate"><span class="pre">admin&#64;gmail.com</span></code> - node.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To easily connect a node simply press the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key while clicking in the grey rectangles - called ports - in each node’s the outer part. The user can also click and hold to connect the nodes, but the author finds it more feasible simply using the <code class="docutils literal notranslate"><span class="pre">Ctrl</span></code> key.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connect.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connect.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connect.png" style="width: 526.0px; height: 328.5px;" /></a>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connected.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connected.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_workflow_out_connected.png" style="width: 526.5px; height: 328.5px;" /></a>
</div>
<p>Deploy your flow by clicking the red Deploy button at the top-left side of the screen.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_deploy.png"><img alt="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_deploy.png" src="images/openrpa_workflow_example_rest_evaluate_setting_evaluation_failed_deploy.png" style="width: 683.0px; height: 327.0px;" /></a>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Upon any change inside a Node-RED flow, the user must deploy the given flow, so the changes are propagated throughout robots currently using that given flow.</p>
</div>
</div>
<div class="section" id="invoke-joke-failed-workflow">
<h3>Invoke Joke Failed Workflow<a class="headerlink" href="#invoke-joke-failed-workflow" title="Permalink to this headline">¶</a></h3>
<p>Now it is needed for the workflow to invoke the <code class="docutils literal notranslate"><span class="pre">REST</span> <span class="pre">Workflow</span> <span class="pre">Example</span> <span class="pre">-</span> <span class="pre">Joke</span> <span class="pre">Failed</span></code> in case the <code class="docutils literal notranslate"><span class="pre">ChuckAPI</span></code> process is not properly evaluated.</p>
<p>To do that, drag an <code class="docutils literal notranslate"><span class="pre">Invoke</span> <span class="pre">OpenFlow</span></code> activity to the <code class="docutils literal notranslate"><span class="pre">Else</span></code> sequence, inside the <strong>If</strong> activity.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_drag.png"><img alt="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_drag.png" src="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_drag.png" style="width: 465.5px; height: 266.5px;" /></a>
</div>
<p>Now select <code class="docutils literal notranslate"><span class="pre">Joke</span> <span class="pre">Failed</span></code> as the workflow to be invoked.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_select.png"><img alt="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_select.png" src="images/openrpa_workflow_example_rest_evaluate_invoke_joke_failed_select.png" style="width: 465.5px; height: 266.0px;" /></a>
</div>
<p>This way, the <code class="docutils literal notranslate"><span class="pre">REST</span> <span class="pre">Workflow</span> <span class="pre">Example</span> <span class="pre">-</span> <span class="pre">Joke</span> <span class="pre">Failed</span></code> activity will be automatically invoked upon any failure in the evaluation process.</p>
</div>
<div class="section" id="output-logic">
<h3>Output logic<a class="headerlink" href="#output-logic" title="Permalink to this headline">¶</a></h3>
<p>Drag a <strong>Show Balloon Tip</strong> activity to the <code class="docutils literal notranslate"><span class="pre">Then</span></code> sequence, inside the <strong>If</strong> activity.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_drag.png"><img alt="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_drag.png" src="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_drag.png" style="width: 465.5px; height: 266.5px;" /></a>
</div>
<p>Insert the <code class="docutils literal notranslate"><span class="pre">Title</span></code> for the <strong>Balloon Tip</strong>, which will appear.</p>
<p>Insert the <code class="docutils literal notranslate"><span class="pre">Message</span></code> which will appear to the user. In our case, it is the variable <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field or create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_set.png"><img alt="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_set.png" src="images/openrpa_workflow_example_rest_output_logic_show_balloon_tip_set.png" style="width: 466.5px; height: 266.0px;" /></a>
</div>
</div>
<div class="section" id="id14">
<h3>Workflow Finished<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>A snippet is shown below containing both the output and the end of the workflow. As well as the whole workflow thereafter.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_rest_output.png" src="images/openrpa_workflow_example_rest_output.png" />
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rest_1st_workflow_finished_1.png" src="images/openrpa_workflow_example_rest_1st_workflow_finished_1.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rest_1st_workflow_finished_2.png" src="images/openrpa_workflow_example_rest_1st_workflow_finished_2.png" />
</div>
</td>
<td><div class="figure align-default">
<img alt="images/openrpa_workflow_example_rest_2nd_workflow_finished_1.png" src="images/openrpa_workflow_example_rest_2nd_workflow_finished_1.png" />
</div>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center">
<a class="reference internal image-reference" href="images/openrpa_workflow_example_rest_node-red_flow.png"><img alt="images/openrpa_workflow_example_rest_node-red_flow.png" src="images/openrpa_workflow_example_rest_node-red_flow.png" style="width: 526.5px; height: 308.0px;" /></a>
</div>
</div>
</div>
<div class="section" id="reading-and-parsing-pdf-files">
<h2>Reading and Parsing PDF Files<a class="headerlink" href="#reading-and-parsing-pdf-files" title="Permalink to this headline">¶</a></h2>
<p>In this example, the user will create a <code class="docutils literal notranslate"><span class="pre">Workflow</span></code> that extracts data from a <code class="docutils literal notranslate"><span class="pre">PDF</span> <span class="pre">file</span></code>, processes the data gathered using <a class="reference external" href="https://ryanstutorials.net/regular-expressions-tutorial/">Regular Expressions</a> (<code class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/regular-expressions-tutorial/</span></code>) and saves the data into a <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">file</span></code>.</p>
<p>First, the user needs to download the invoice file, which will be used to extract the data. It is available on <a class="reference external" href="https://drive.google.com/file/d/1jCSvQ42ABkeJVcWksUNUftfiPSjZBlSs/view?usp=sharing">this link</a> (<code class="docutils literal notranslate"><span class="pre">https://drive.google.com/file/d/1jCSvQ42ABkeJVcWksUNUftfiPSjZBlSs/view?usp=sharing</span></code>).</p>
<p>The steps are listed below:</p>
<ol class="arabic simple">
<li><p>Extract text data from PDF.</p></li>
<li><p>Match Regular Expression groups.</p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> to store results.</p></li>
<li><p>Add row to <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>.</p></li>
<li><p>Save <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> into CSV.</p></li>
</ol>
<div class="section" id="extract-data-from-pdf">
<h3>Extract data from PDF<a class="headerlink" href="#extract-data-from-pdf" title="Permalink to this headline">¶</a></h3>
<p>In this section the user will learn how to extract text data from a PDF and save it into a variable.</p>
<p>First of all,  the user should drag a <strong>ReadPDF</strong> activity into the main sequence.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_drag_readpdf.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_drag_readpdf.png" />
</div>
<p>Then, click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button to select the file from which data will read. That is the invoice file just downloaded.</p>
<p>The user also needs to create a variable that will be used to hold the text generated by the extraction with the <strong>ReadPDF</strong> activity. In this case, the variable is <code class="docutils literal notranslate"><span class="pre">result</span></code>. It must be set inside the <code class="docutils literal notranslate"><span class="pre">AllText</span></code> parameter, available inside the <strong>Properties box</strong>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_configure_readpdf.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_configure_readpdf.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>OpenRPA can automatically create a new variable with the correct type required for the Activity/property. While creating a new variable in the <strong>Properties box</strong>, after typing the variable name and with the caret still inside the input field, by pressing <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>.</p>
</div>
</div>
<div class="section" id="match-regular-expression-groups">
<h3>Match Regular Expression groups<a class="headerlink" href="#match-regular-expression-groups" title="Permalink to this headline">¶</a></h3>
<p>Now the user will use the <strong>Matches</strong> Activity to extract groups of data from the string returned by <strong>ReadPDF</strong>.</p>
<p>First of all, the user should drag a <strong>Matches</strong> Activity into the main sequence.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_drag_matches.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_drag_matches.png" />
</div>
<p>In the first input box, containing the placeholder <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">input</span> <span class="pre">string</span> <span class="pre">to</span> <span class="pre">match</span> <span class="pre">against</span></code>, the user will insert the variable’s content, that is, the text captured in the previous section.</p>
<p>In the second input box, the user will insert the <strong>RegEx pattern</strong> used to divide data into groups. The one used here is <code class="docutils literal notranslate"><span class="pre">(\b[a-zA-Z0-9$.\-()</span> <span class="pre">]*)</span></code>. For a thorough explanation of <strong>Regular Expressions</strong>, please refer to <a class="reference external" href="https://ryanstutorials.net/regular-expressions-tutorial/">RyansTutorials Regular Expressions</a> (<code class="docutils literal notranslate"><span class="pre">https://ryanstutorials.net/regular-expressions-tutorial/</span></code>). It is interesting to remind the user that, since the <strong>RegEx pattern</strong> is captured as a string, it must be enclosed in quotes. It is also recommended using the <a class="reference external" href="https://regex101.com/">Regex101</a> (<code class="docutils literal notranslate"><span class="pre">https://regex101.com/</span></code>) for matching the groups and testing the pattern if needed.</p>
<p>The user must also configure the variable to which the matches will be saved (in this example, <code class="docutils literal notranslate"><span class="pre">invoiceResults</span></code>) inside the <code class="docutils literal notranslate"><span class="pre">Results</span></code> parameter in the <strong>Properties box</strong>. It will be configured with type <strong>Match list</strong>, or simply <code class="docutils literal notranslate"><span class="pre">Match[]</span></code>. As seen in the image below.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_configure_matches.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_configure_matches.png" />
</div>
</div>
<div class="section" id="create-datatable-to-store-results">
<h3>Create DataTable to store results<a class="headerlink" href="#create-datatable-to-store-results" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will create the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> used to store the results and configure its header.</p>
<p>First, the user will drag a <strong>CreateDataTable</strong> activity to the sequence inside the <strong>Matches</strong> activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_drag_createdatatable.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_drag_createdatatable.png" />
</div>
<p>Now, the user must create the variable in which the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> will be saved inside the <cite>New DataTable variable</cite> placeholder. In this example, the variable is named <code class="docutils literal notranslate"><span class="pre">invoiceDataTable</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field. Otherwise, the user can create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<p>The user must also define its headers inside the <cite>Array of DataTable columns</cite> placeholder. Since, in this example only three fields from the invoice are captured, namely <code class="docutils literal notranslate"><span class="pre">Company</span> <span class="pre">Name</span></code>, <code class="docutils literal notranslate"><span class="pre">Invoice</span> <span class="pre">Number</span></code> and <code class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">Balance</span></code>, the header will be defined as <code class="docutils literal notranslate"><span class="pre">{&quot;Company</span> <span class="pre">Name&quot;,</span> <span class="pre">&quot;Invoice</span> <span class="pre">Number&quot;</span> <span class="pre">and</span> <span class="pre">&quot;Total</span> <span class="pre">Balance&quot;}</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_config_createdatatable.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_config_createdatatable.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code> corresponds to one table of in-memory data contained in a <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> from the class equally named. When you read an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, it is automatically assigned to a <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class, and all the <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes - number of sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. Here it is reminded that <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case sensitive.</p>
</div>
</div>
<div class="section" id="add-row-to-datatable">
<h3>Add row to DataTable<a class="headerlink" href="#add-row-to-datatable" title="Permalink to this headline">¶</a></h3>
<p>Here the user will add the data gathered from the <code class="docutils literal notranslate"><span class="pre">PDF</span> <span class="pre">file</span></code> into the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> defined in the previous section.</p>
<p>First, drag an <strong>AddDataRow</strong> activity into the sequence inserted inside the <strong>Matches</strong> activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_drag_adddatarow.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_drag_adddatarow.png" />
</div>
<p>Now, the user must insert the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> to which the data will be inserted to inside the <cite>DataTable to insert to</cite> placeholder.</p>
<p>The user must also define the data that will be inserted.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Company</span> <span class="pre">Name</span></code> is the <code class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code> of no. 1 inside the <code class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will be assigned as <code class="docutils literal notranslate"><span class="pre">invoiceResults(0).ToString</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">invoiceNumber</span></code> is the <code class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code> of no. 2 inside the <code class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will be assigned as <code class="docutils literal notranslate"><span class="pre">invoiceResults(2).ToString</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">invoiceTotalBalance</span></code> is the <code class="docutils literal notranslate"><span class="pre">Match</span> <span class="pre">object</span></code> of no. 3 inside the <code class="docutils literal notranslate"><span class="pre">invoiceResults</span></code> list. It will be assigned as <code class="docutils literal notranslate"><span class="pre">invoiceResults(44).ToString</span></code>.</p>
<p>Therefore, the row which will be added inside the <cite>Array of DataTable columns</cite> placeholder is <code class="docutils literal notranslate"><span class="pre">{invoiceResults(0).ToString,</span> <span class="pre">invoiceResults(2).ToString,</span> <span class="pre">invoiceResults(44).ToString}</span></code>. It is shown below.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_configure_adddatarow.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_configure_adddatarow.png" />
</div>
</div>
<div class="section" id="save-datatable-into-csv">
<h3>Save DataTable into CSV<a class="headerlink" href="#save-datatable-into-csv" title="Permalink to this headline">¶</a></h3>
<p>The user will now save the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> created in a CSV file.</p>
<p>First, drag a <strong>WriteCSV</strong> file into the main sequence.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_read_and_parsing_pdf_drag_writecsv.png" src="images/openrpa_workflow_example_read_and_parsing_pdf_drag_writecsv.png" />
</div>
<p>Now, click the <code class="docutils literal notranslate"><span class="pre">...</span></code> button to insert the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> of the CSV file, which the data will be saved to - in this example, <code class="docutils literal notranslate"><span class="pre">invoice1.csv</span></code>.</p>
<p>Then, insert the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>, which was captured into the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> inside its <strong>Properties box</strong>. In this example, this variable is the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> defined in the previous section - i.e., <code class="docutils literal notranslate"><span class="pre">invoiceDataTable</span></code>.</p>
<p>Finally, change the <code class="docutils literal notranslate"><span class="pre">Delimiter</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code>.</p>
</div>
<div class="section" id="id15">
<h3>Workflow Finished<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>A <code class="docutils literal notranslate"><span class="pre">CSV</span> <span class="pre">file</span></code> is generated, which can be opened on <strong>Excel</strong> application or <strong>Notepad</strong>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_example_workflow_finished_csv.png" src="images/openrpa_workflow_example_workflow_finished_csv.png" />
</div>
</div>
</div>
<div class="section" id="openrpa-database-activities-datatable-dataview">
<h2>OpenRPA.Database Activities, DataTable, DataView<a class="headerlink" href="#openrpa-database-activities-datatable-dataview" title="Permalink to this headline">¶</a></h2>
<p>In this example, the user will create a Workflow that reads a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> dataset from AirBnB data and inserts the data into a <code class="docutils literal notranslate"><span class="pre">MySQL</span></code> database. We’ll also use a shortened version of the <code class="docutils literal notranslate"><span class="pre">listings.csv</span></code> <strong>Amsterdam</strong>’s data set file, available at <a class="reference external" href="http://insideairbnb.com/get-the-data.html">Inside AirBnB</a> (<code class="docutils literal notranslate"><span class="pre">http://insideairbnb.com/get-the-data.html</span></code>). Our version, containing only 169 entries, is available <a class="reference external" href="https://drive.google.com/file/d/1pYQiRs_9k4mi7yu41sTVMr2_I2wtZ8AB/view?usp=sharing">here</a> (<code class="docutils literal notranslate"><span class="pre">https://drive.google.com/file/d/1pYQiRs_9k4mi7yu41sTVMr2_I2wtZ8AB/view?usp=sharing</span></code>) and is the one which will be used in this Workflow example.</p>
<p>The authentication method with which <strong>MySQL</strong> was installed must also <strong>NOT BE</strong> encrypted, ie. it must be set as <code class="docutils literal notranslate"><span class="pre">legacy</span> <span class="pre">mode</span></code>, since the  <strong>DataProvider</strong> <code class="docutils literal notranslate"><span class="pre">MySql.Data.MySqlClient</span></code> is used for connecting to the database.</p>
<p>Attention: this is a very complex example and the user is expected to know about database <code class="docutils literal notranslate"><span class="pre">Schemas</span></code> and have a proper <code class="docutils literal notranslate"><span class="pre">MySQL</span> <span class="pre">server</span></code> running. But do not be afraid! You can still learn a lot by just looking by the example, even if you do not try to replicate all the steps by yourself.</p>
<ol class="arabic simple">
<li><p>Download CSV File</p></li>
<li><p>Review types from Dataset using Pandas</p></li>
<li><p>Read dataset from CSV into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code></p></li>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">Schema</span></code> and <code class="docutils literal notranslate"><span class="pre">Table</span></code> which will hold the data inside <code class="docutils literal notranslate"><span class="pre">MySQL</span></code></p></li>
<li><p>Create DataTable to store results</p></li>
<li><p>Add batch number column</p></li>
<li><p>Connect to Database</p></li>
<li><p>Fetch SQL Table to DataTable</p></li>
<li><p>Loop through Dataset</p></li>
<li><p>Incrementing Id and Batch No. variables</p></li>
<li><p>Adding DataRows and updating SQL Table</p></li>
<li><p>Executing Queries into the Data Inserted and visualizing Data</p></li>
<li><p>Using a DataView to filter through the Data</p></li>
</ol>
<div class="section" id="download-csv-file">
<h3>Download CSV File<a class="headerlink" href="#download-csv-file" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to download a file from internet and save it into a folder using a specific <code class="docutils literal notranslate"><span class="pre">filepath</span></code>.</p>
<p>First, drag a <code class="docutils literal notranslate"><span class="pre">DownloadFile</span></code> activity and click the <cite>…</cite> button to type the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> which will contain the dataset - in our case it is <code class="docutils literal notranslate"><span class="pre">&quot;C:\BPA\Workflow</span> <span class="pre">Examples\Using</span> <span class="pre">DataTables\airbnb_review_listings.csv&quot;</span></code> - and click the <strong>Save</strong> button. We’ll also name the activity <code class="docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Dataset</span></code>. In our case, this <code class="docutils literal notranslate"><span class="pre">filepath</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;C:\BPA\Workflow</span> <span class="pre">Examples\Using</span> <span class="pre">DataTables\airbnb_review_listings.csv&quot;</span></code>.</p>
<p>Also insert the <code class="docutils literal notranslate"><span class="pre">URL</span></code> from which the dataset will be downloaded inside the <strong>Properties box</strong> - <code class="docutils literal notranslate"><span class="pre">https://drive.google.com/file/d/1pYQiRs_9k4mi7yu41sTVMr2_I2wtZ8AB/view?usp=sharing</span></code>.</p>
<p>Set the <code class="docutils literal notranslate"><span class="pre">Overwrite</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">True</span></code> as well, just in case you have already downloaded the file to the specified <code class="docutils literal notranslate"><span class="pre">filepath</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_drag_download_file.png" src="images/openrpa_workflow_examples_using_datatables_drag_download_file.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_download_file_select_filepath_click_save.png" src="images/openrpa_workflow_examples_using_datatables_download_file_select_filepath_click_save.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_download_file_insert_url.png" src="images/openrpa_workflow_examples_using_datatables_download_file_insert_url.png" />
</div>
<p>Now click the <strong>Play</strong> button inside OpenRPA’s ribbon to download the file. It is also recommended that the user checks whether the file actually exists in the specified folder.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To change the name, or  <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> - as set inside the activity’s parameters, the user can either click twice in the name of the activity, type the desired name and press <code class="docutils literal notranslate"><span class="pre">RETURN</span></code> or set the parameter <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> inside the <strong>Properties box</strong>.</p>
</div>
</div>
<div class="section" id="review-types-from-dataset-using-pandas">
<h3>Review types from Dataset using Pandas<a class="headerlink" href="#review-types-from-dataset-using-pandas" title="Permalink to this headline">¶</a></h3>
<p>First, let’s take a look at the types which the dataset contains by using <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library - or <strong>Python Data Analysis Library</strong>.</p>
<p>Initialize a Python shell - here we assume you already have <strong>Python</strong> and the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library installed. If you do not have it installed, you can use the <a class="reference external" href="https://colab.research.google.com/">Colab Platform</a> (<a class="reference external" href="https://colab.research.google.com/">https://colab.research.google.com/</a>) created by Google, yet you must upload the file to the <code class="docutils literal notranslate"><span class="pre">Files</span></code> sidebar and use the <code class="docutils literal notranslate"><span class="pre">relative</span> <span class="pre">path</span></code> - ie. <code class="docutils literal notranslate"><span class="pre">./airbnb_review_listings.csv</span></code> instead of the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> set in the previous section, which in our case is <code class="docutils literal notranslate"><span class="pre">&quot;C:\BPA\Workflow</span> <span class="pre">Examples\Using</span> <span class="pre">DataTables\airbnb_review_listings.csv&quot;</span></code>.</p>
<p>Remember to add the escape character - <code class="docutils literal notranslate"><span class="pre">\</span></code>, since we’re using a shell! This leads the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> to point to <code class="docutils literal notranslate"><span class="pre">&quot;C:\\BPA\Workflow</span> <span class="pre">Examples\\Using</span> <span class="pre">DataTables\\airbnb_review_listings.csv&quot;</span></code>.</p>
<p>Execute the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">BPA\Workflow Examples</span><span class="se">\\</span><span class="s2">Using DataTables</span><span class="se">\\</span><span class="s2">airbnb_review_listings.csv&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
<p>This will show all the types contained inside the dataset. As seen in the code snippet below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">dtypes</span>
<span class="go">id                                  int64</span>
<span class="go">name                               object</span>
<span class="go">host_id                             int64</span>
<span class="go">host_name                          object</span>
<span class="go">neighbourhood_group               float64</span>
<span class="go">neighbourhood                      object</span>
<span class="go">latitude                          float64</span>
<span class="go">longitude                         float64</span>
<span class="go">room_type                          object</span>
<span class="go">price                               int64</span>
<span class="go">minimum_nights                      int64</span>
<span class="go">number_of_reviews                   int64</span>
<span class="go">last_review                        object</span>
<span class="go">reviews_per_month                 float64</span>
<span class="go">calculated_host_listings_count      int64</span>
<span class="go">availability_365                    int64</span>
<span class="go">dtype: object</span>
</pre></div>
</div>
<p>This means that the dataset contains 16 <code class="docutils literal notranslate"><span class="pre">features</span></code> - or <code class="docutils literal notranslate"><span class="pre">variables</span></code> with many different types. Some are of type <code class="docutils literal notranslate"><span class="pre">int64</span></code>, some are of type <code class="docutils literal notranslate"><span class="pre">float64</span></code> and some are of type <code class="docutils literal notranslate"><span class="pre">object</span></code> - the latter ones will be treated as if they were <code class="docutils literal notranslate"><span class="pre">String</span></code> objects. It also means that we must create our database with different datatypes and set variables inside <strong>OpenRPA</strong> with the correct given types.</p>
<p>If you do not know what types are, please refer to <a class="reference internal" href="appendix_a.html#what-is-a-type"><span class="std std-ref">What is a type?</span></a>.</p>
</div>
<div class="section" id="read-dataset-from-csv-into-datatable">
<h3>Read dataset from CSV into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code><a class="headerlink" href="#read-dataset-from-csv-into-datatable" title="Permalink to this headline">¶</a></h3>
<p>In this section the user will learn how to read the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code></p>
<p>Now the user must drag a <strong>ReadExcel</strong> activity into the Designer and select the <code class="docutils literal notranslate"><span class="pre">filepath</span></code> of the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file with the <code class="docutils literal notranslate"><span class="pre">...</span></code> button or by directly pasting it into the <code class="docutils literal notranslate"><span class="pre">Filename</span></code> parameter inside the <strong>Properties box</strong>.</p>
<p>Along with the previously set parameter, the user must also set the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> to which the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file will be read into - in our case it is <code class="docutils literal notranslate"><span class="pre">amsterdamdt</span></code>. As well as the <code class="docutils literal notranslate"><span class="pre">Delimiter</span></code> - which defines the delimiter for the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file, in our case it is the <code class="docutils literal notranslate"><span class="pre">&quot;,&quot;</span></code> character.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field. Otherwise, the user can create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_read_csv.png" src="images/openrpa_workflow_examples_using_datatables_read_csv.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_read_csv_select_file.png" src="images/openrpa_workflow_examples_using_datatables_read_csv_select_file.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In OpenRPA, a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> corresponds to a 2-dimensional non-serializable object used to hold values. Think of it as a matrix with <code class="docutils literal notranslate"><span class="pre">i</span></code> rows and <code class="docutils literal notranslate"><span class="pre">j</span></code> columns. The <code class="docutils literal notranslate"><span class="pre">i</span></code> rows are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Rows(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the row - starting from 0 - which you want to access. The <code class="docutils literal notranslate"><span class="pre">j</span></code> columns are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Item(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the column - starting from 0 - which you want to access. It is useful to remind here that the user must have accessed the <code class="docutils literal notranslate"><span class="pre">Rows</span></code> attribute, therefore, if the user wanted to access the 2nd column on the 3rd row of the datatable they would use <code class="docutils literal notranslate"><span class="pre">.Rows(2).Item(1)</span></code> attribute.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the .NET API, a <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code> corresponds to one table of in-memory data contained in a <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> from the class equally named. When you read an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, it is automatically assigned to a <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class and all the <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes - numbered from 0 to the quantity of sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. Here it is reminded that <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case sensitive.</p>
</div>
</div>
<div class="section" id="create-schema-and-table-which-will-hold-the-data-inside-mysql">
<h3>Create <code class="docutils literal notranslate"><span class="pre">Schema</span></code> and <code class="docutils literal notranslate"><span class="pre">Table</span></code> which will hold the data inside <code class="docutils literal notranslate"><span class="pre">MySQL</span></code><a class="headerlink" href="#create-schema-and-table-which-will-hold-the-data-inside-mysql" title="Permalink to this headline">¶</a></h3>
<p>In this section the user creates the <code class="docutils literal notranslate"><span class="pre">database</span></code> and <code class="docutils literal notranslate"><span class="pre">table</span></code> which will hold the data by using <strong>MySQL Workbench</strong>.</p>
<p>Copy and paste the following code section into a new query inside <strong>MySQL Workbench</strong>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">DATABASE</span> <span class="o">`</span><span class="n">using_datatables</span><span class="o">`</span> <span class="cm">/*!40100 DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_0900_ai_ci */</span> <span class="cm">/*!80016 DEFAULT ENCRYPTION=&#39;N&#39; */</span><span class="p">;</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">using_datatables</span><span class="p">.</span><span class="o">`</span><span class="n">airbnbdata</span><span class="o">`</span> <span class="p">(</span>
   <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="nb">int</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
   <span class="o">`</span><span class="n">datasetId</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">placeName</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">hostId</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">hostName</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">neighbourhoodGroup</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">neighbourhood</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">latitude</span><span class="o">`</span> <span class="n">double</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">longitude</span><span class="o">`</span> <span class="n">double</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">room_type</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">price</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">minimum_nights</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">number_of_reviews</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">last_review</span><span class="o">`</span> <span class="nb">varchar</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">reviews_per_month</span><span class="o">`</span> <span class="n">double</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">calculated_host_listings_count</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="o">`</span><span class="n">availability_365</span><span class="o">`</span> <span class="nb">bigint</span> <span class="k">DEFAULT</span> <span class="k">NULL</span><span class="p">,</span>
   <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here you can notice that the features of type <code class="docutils literal notranslate"><span class="pre">object</span></code> inside our dataset are going to be set as <code class="docutils literal notranslate"><span class="pre">varchar(255)</span></code> - which is mapped from the type <code class="docutils literal notranslate"><span class="pre">System.Data.String</span></code> inside OpenRPA. That also occurs with <code class="docutils literal notranslate"><span class="pre">bigint</span></code>, which is mapped from the <code class="docutils literal notranslate"><span class="pre">System.Data.Double</span></code> datatype.</p>
</div>
<p>Now click the <code class="docutils literal notranslate"><span class="pre">Execute</span> <span class="pre">query</span></code> button inside the query panel.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_create_schema_and_table.png" src="images/openrpa_workflow_examples_using_datatables_create_schema_and_table.png" />
</div>
<p>If everything goes well, <strong>MySQL Workbench</strong> should show a message in the <code class="docutils literal notranslate"><span class="pre">Action</span> <span class="pre">Output</span></code> section exactly as below.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_schema_and_table_created.png" src="images/openrpa_workflow_examples_using_datatables_schema_and_table_created.png" />
</div>
<p>That’s it! Now the user is ready to continue.</p>
</div>
<div class="section" id="id16">
<h3>Create DataTable to store results<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will create the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> used to store the results and configure its header.</p>
<p>First,  drag a <strong>CreateDataTable</strong> activity to the main sequence.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_create_data_table.png" src="images/openrpa_workflow_examples_using_datatables_create_data_table.png" />
</div>
<p>Now, create the variable in which the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> will be saved inside the <cite>New DataTable variable</cite> placeholder. In this example, the variable is named <code class="docutils literal notranslate"><span class="pre">sqldt</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to automatically create the variable when entering it upon an input field. Otherwise, the user can create it manually by clicking the <strong>Variables box</strong> under the bottom part of the screen. Use the right-hand side to enter the value which will be assigned to the variable.</p>
</div>
<p>The user must also define its headers inside the field containing the <cite>Array of DataTable columns</cite> placeholder. All of our datasets <code class="docutils literal notranslate"><span class="pre">features</span></code> will be added to the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> object, along with the default <code class="docutils literal notranslate"><span class="pre">int</span></code> datatype, which is the <code class="docutils literal notranslate"><span class="pre">Primary</span> <span class="pre">Key</span></code> and was defined by us in the previous section. Henceforth, our header must be set as <code class="docutils literal notranslate"><span class="pre">{&quot;id&quot;,</span> <span class="pre">&quot;name&quot;,</span> <span class="pre">&quot;host_id&quot;,</span> <span class="pre">&quot;host_name&quot;,</span> <span class="pre">&quot;neighbourhood_group&quot;,</span> <span class="pre">&quot;neighbourhood&quot;,</span> <span class="pre">&quot;latitude&quot;,</span> <span class="pre">&quot;longitude&quot;,</span> <span class="pre">&quot;room_type&quot;,</span> <span class="pre">&quot;price&quot;,</span> <span class="pre">&quot;minimum_nights&quot;,</span> <span class="pre">&quot;number_of_reviews&quot;,</span> <span class="pre">&quot;last_review&quot;,</span> <span class="pre">&quot;reviews_per_month&quot;,</span> <span class="pre">&quot;calculated_host_listings_count&quot;,</span> <span class="pre">&quot;availability_365&quot;}</span></code>.</p>
<p>The purpose of this <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> is to save all the data gathered from the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file and then later use a <code class="docutils literal notranslate"><span class="pre">DataView</span></code> to filter through and exhibit the data gathered from it.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_create_sql_storage_data_table.png" src="images/openrpa_workflow_examples_using_datatables_create_sql_storage_data_table.png" />
</div>
</div>
<div class="section" id="add-batch-no-column">
<h3>Add Batch No. Column<a class="headerlink" href="#add-batch-no-column" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to add a data column to a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> containing the current index of the entry being processed by using the <strong>AddDataColumn</strong> activity and also how to alter a table using <strong>MySQL Workbench</strong>.</p>
<p>First, drag an <strong>AddDataColumn</strong> activity into the main sequence. This one will add the <code class="docutils literal notranslate"><span class="pre">batch_no</span></code> which corresponds to the index of the entry currently being processed.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">sqldt</span></code> inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> placeholder.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">batch_no</span></code> inside the <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">columns</span> <span class="pre">name</span></code> placeholder.</p>
<p>Select its datatype inside the dropdown as <code class="docutils literal notranslate"><span class="pre">System.Data.Int64</span></code> by using the <code class="docutils literal notranslate"><span class="pre">Browse</span> <span class="pre">for</span> <span class="pre">types...</span></code> option.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_adddatacolumn_batchno.png" src="images/openrpa_workflow_examples_using_datatables_adddatacolumn_batchno.png" />
</div>
<p>Now we must alter the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> so it will also contain the <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code> feature <code class="docutils literal notranslate"><span class="pre">batch_no</span></code>.</p>
<p>Click with the right <cite>mouse</cite> button inside the <code class="docutils literal notranslate"><span class="pre">airbnbdata</span> <span class="pre">SQL</span> <span class="pre">Table</span></code> within <strong>MySQL Workbench</strong> and then click the <code class="docutils literal notranslate"><span class="pre">Alter</span> <span class="pre">Table...</span></code> button.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_alter_table.png" src="images/openrpa_workflow_examples_using_datatables_alter_table.png" />
</div>
<p>This will open a new tab, containing all settings pertaining to the <code class="docutils literal notranslate"><span class="pre">airbnbdata</span> <span class="pre">SQL</span> <span class="pre">Table</span></code> which allows us to add a new column. First, we must scroll down until the end of the features inside the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> and click twice in the empty field.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_alter_table_column_prompt.png" src="images/openrpa_workflow_examples_using_datatables_alter_table_column_prompt.png" />
</div>
<p>Right below <code class="docutils literal notranslate"><span class="pre">Column</span> <span class="pre">Name</span></code> and type <code class="docutils literal notranslate"><span class="pre">batch_no</span></code> into it. Then double click the empty field right below <code class="docutils literal notranslate"><span class="pre">Datatype</span></code> and type <code class="docutils literal notranslate"><span class="pre">BIGINT</span></code>. Also click the <code class="docutils literal notranslate"><span class="pre">NN</span></code> checkbox, which will make sure this field is never <code class="docutils literal notranslate"><span class="pre">NULL</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_alter_table_empty_column_prompt.png" src="images/openrpa_workflow_examples_using_datatables_alter_table_empty_column_prompt.png" />
</div>
<p>Now click the <code class="docutils literal notranslate"><span class="pre">Apply</span></code> button. A page where you can review the changes - ie. the actual <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">query</span></code> done - appears. Then click <code class="docutils literal notranslate"><span class="pre">Execute</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_adddatacolumn_batchno_apply_page.png" src="images/openrpa_workflow_examples_using_datatables_adddatacolumn_batchno_apply_page.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_alter_table_filled_column_prompt.png" src="images/openrpa_workflow_examples_using_datatables_alter_table_filled_column_prompt.png" />
</div>
<p>That’s it!  The user has now successfully added the <code class="docutils literal notranslate"><span class="pre">batch_no</span></code> both to the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> object which will initially hold the data and the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code>.</p>
</div>
<div class="section" id="connect-to-database">
<h3>Connect to Database<a class="headerlink" href="#connect-to-database" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to setup a <strong>MySQL</strong> connection to the database which was created in previous sections.</p>
<p>First, drag a <strong>Sequence</strong> activity to the main sequence so we can modularize our workflow and change its name to <code class="docutils literal notranslate"><span class="pre">Connect</span> <span class="pre">to</span> <span class="pre">Database</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_connect_to_database.png" src="images/openrpa_workflow_examples_using_datatables_connect_to_database.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To change the name, or  <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> - as set inside the activity’s parameters, the user can either click twice in the name of the activity, type the desired name and press <code class="docutils literal notranslate"><span class="pre">RETURN</span></code> or set the parameter <code class="docutils literal notranslate"><span class="pre">DisplayName</span></code> inside the <strong>Properties box</strong>.</p>
</div>
<p>Now drag a <strong>Database Scope</strong> activity to the <code class="docutils literal notranslate"><span class="pre">Connect</span> <span class="pre">to</span> <span class="pre">Database</span></code> sequence. We must set its parameters manually since <strong>MySQL</strong> is used.</p>
<p>First, set <code class="docutils literal notranslate"><span class="pre">ConnectionString</span></code> as <code class="docutils literal notranslate"><span class="pre">&quot;Server=localhost;Port=3306;Database=using_datatables;Uid=${USERNAME};Pwd='${PASSWORD}';&quot;</span></code>. where <code class="docutils literal notranslate"><span class="pre">${USERNAME}</span></code> is the username set for the database - it must also have access to write to the given database - and <code class="docutils literal notranslate"><span class="pre">${PASSWORD}</span></code> is the password for the given username.</p>
<p>Then, set the <code class="docutils literal notranslate"><span class="pre">DataProvider</span></code>, which in our case is “MySql.Data.MySqlClient”</p>
<p>Now finally set the <code class="docutils literal notranslate"><span class="pre">DataSource</span></code>, which is <code class="docutils literal notranslate"><span class="pre">&quot;using_datatables&quot;</span></code>. This is the <code class="docutils literal notranslate"><span class="pre">database</span> <span class="pre">or</span> <span class="pre">schema</span></code> which we created in <span class="xref std std-ref">Create Schema and Table which will hold the data inside MySQL</span>.</p>
<p>Now, the connection is successfully set up!</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_database_scope.png" src="images/openrpa_workflow_examples_using_datatables_database_scope.png" />
</div>
</div>
<div class="section" id="fetch-sql-table-to-datatable">
<h3>Fetch SQL Table to DataTable<a class="headerlink" href="#fetch-sql-table-to-datatable" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to fetch an existing <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> into a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code>.</p>
<p>First, drag an <strong>Execute Query</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">Database</span> <span class="pre">Connection</span></code> sequence.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">&quot;select</span> <span class="pre">*</span> <span class="pre">from</span> <span class="pre">airbnbdata;&quot;</span></code> into the edit field <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">query</span> <span class="pre">to</span> <span class="pre">execute</span></code>. This is the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Query</span></code> which will be executed to fetch all the data. Notice that the statement consists of a simple <code class="docutils literal notranslate"><span class="pre">select</span></code>, but this query can get as complex as it is needed.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code> into the edit the field <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">DataTable</span> <span class="pre">to</span> <span class="pre">save</span> <span class="pre">result</span> <span class="pre">into</span></code>. This is the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> object where data will be saved.</p>
<p>The purpose of this <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code> is to hold data that will be modified and then committed to the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> later on. When running the <code class="docutils literal notranslate"><span class="pre">querying</span></code> Activities in <strong>OpenRPA</strong>, the resulting object is a <code class="docutils literal notranslate"><span class="pre">DataView</span></code>, which is not connected to the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> at all - So by manipulating <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code>, with the results from many queries, at the later stages we can commit all the changes at once by using the <strong>Update from DataTable</strong> Activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_execute_query.png" src="images/openrpa_workflow_examples_using_datatables_execute_query.png" />
</div>
</div>
<div class="section" id="loop-through-dataset">
<h3>Loop through Dataset<a class="headerlink" href="#loop-through-dataset" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to loop through the <code class="docutils literal notranslate"><span class="pre">dataset</span></code> gathered, parse the data into the proper datatypes and use the <strong>If</strong> Activity to assign a default value to abnormal entries contained inside the dataset. Finally, the user will add the rows both to <code class="docutils literal notranslate"><span class="pre">sqldt</span></code> and <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code>. At the end of this section, a reference table is found for indexing the given <code class="docutils literal notranslate"><span class="pre">dataset</span> <span class="pre">features</span></code> along with its <code class="docutils literal notranslate"><span class="pre">datatypes</span></code>.</p>
<p>First, drag a <strong>Foreach DataRow</strong> activity into the sequence inside the <strong>Database Scope</strong> Activity. Inside the field containing the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">Expression</span></code>, insert <code class="docutils literal notranslate"><span class="pre">amsterdamdt</span></code>.</p>
<p>Similarly to the way <span class="xref std std-ref">Read Excel</span> Workflow example reads cells from the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> returned by the <strong>Read Excel</strong> activity, every feature of our <code class="docutils literal notranslate"><span class="pre">dataset</span></code> must be assigned to a variable.</p>
<p>Here 4 types of data are dealt with: <code class="docutils literal notranslate"><span class="pre">Int64</span></code>, <code class="docutils literal notranslate"><span class="pre">Double</span></code>, <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> and <code class="docutils literal notranslate"><span class="pre">String</span></code> - which correspond respectively to <code class="docutils literal notranslate"><span class="pre">bigint</span></code>, <code class="docutils literal notranslate"><span class="pre">double</span></code>, <code class="docutils literal notranslate"><span class="pre">date</span></code> and <code class="docutils literal notranslate"><span class="pre">varchar(255)</span></code> inside the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code>.</p>
<p>For the <code class="docutils literal notranslate"><span class="pre">Int64</span></code> type, the user must parse the data using the <code class="docutils literal notranslate"><span class="pre">Int64.Parse</span></code> method.</p>
<p>An example is shown where the user must set the <code class="docutils literal notranslate"><span class="pre">id_dataset</span></code> variable’s value as <code class="docutils literal notranslate"><span class="pre">Int64.Parse(row.Item(0).ToString)</span></code> and also set its type as <code class="docutils literal notranslate"><span class="pre">System.Data.Int64</span></code>. Go ahead and set the remaining ones! These are``host_id``, <code class="docutils literal notranslate"><span class="pre">price</span></code>, <code class="docutils literal notranslate"><span class="pre">minimum_nights</span></code>, <code class="docutils literal notranslate"><span class="pre">number_of_reviews</span></code>, <code class="docutils literal notranslate"><span class="pre">calculated_host_listings_count</span></code> and <code class="docutils literal notranslate"><span class="pre">availability_365</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_loop_through_dataset_assign_int64.png" src="images/openrpa_workflow_examples_using_datatables_loop_through_dataset_assign_int64.png" />
</div>
<p>For the features of type <code class="docutils literal notranslate"><span class="pre">Double</span></code>, for this specific InsideAirBnB dataset, they can be either a null value (ie. variable.ToString returns “”) or a numeric value that can be properly converted by using <code class="docutils literal notranslate"><span class="pre">CDbl()</span></code>.</p>
<p>As can be seen, an <code class="docutils literal notranslate"><span class="pre">If</span></code> Activity is used to distinguish between null and valid values.
To avoid writing <code class="docutils literal notranslate"><span class="pre">row.item(xx)[...]</span></code> extensively many times, some temp variable <code class="docutils literal notranslate"><span class="pre">&lt;featureNameValue&gt;</span></code> were used.</p>
<p>An example is shown below, with the <code class="docutils literal notranslate"><span class="pre">temp</span> <span class="pre">variable</span></code> set as <code class="docutils literal notranslate"><span class="pre">latitudeValue</span></code> and the actual value which will be inserted into the table as <code class="docutils literal notranslate"><span class="pre">latitude</span></code>. Go ahead and set the remaining ones! These are <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">reviews_per_month</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_loop_through_double_variables.png" src="images/openrpa_workflow_examples_using_datatables_loop_through_double_variables.png" />
</div>
<p>For the <code class="docutils literal notranslate"><span class="pre">DateTime</span></code> type, the user must also use a <code class="docutils literal notranslate"><span class="pre">temp</span> <span class="pre">variable</span></code> to check against abnormal entries. Here the <strong>If</strong> Activity is also used as was just shown above, the only difference is the default value is arbitrarily set as <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">System.DateTime(2011,10,12,0,0,0)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_loop_through_date_variable.png" src="images/openrpa_workflow_examples_using_datatables_loop_through_date_variable.png" />
</div>
<p>The last type is <code class="docutils literal notranslate"><span class="pre">String</span></code>. All the user has to do is find the given <code class="docutils literal notranslate"><span class="pre">i-th</span></code> entry in the row and match it to the given entry inside the dataset and cast it to <code class="docutils literal notranslate"><span class="pre">String</span></code> using the <code class="docutils literal notranslate"><span class="pre">.ToString</span></code> method. It is useful to remind the user that <strong>OpenRPA</strong> starts indexing at 0.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_loop_through_string_variables.png" src="images/openrpa_workflow_examples_using_datatables_loop_through_string_variables.png" />
</div>
<p>The table referencing each index follows below:</p>
<p>``
id_dataset - Int64 - 0
place_name - String - 1
host_id - Int64 - 2
host_name - String - 3
neighbourhood_group - String - 4
neighbourhood - String - 5
latitude - Double - 6
longitude - Double - 7
room_type - String - 8
price - Int64 - 9
minimum_nights - Int64 - 10
number_of_reviews - Int64 - 11
last_review - DateTime - 12
reviews_per_month - Double - 13
calculated_host_listings_count - Int64 - 14
availability_365 - Int64 - 15
``</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In OpenRPA, a <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> corresponds to a 2-dimensional non-serializable object used to hold values. Think of it as a matrix with <code class="docutils literal notranslate"><span class="pre">i</span></code> rows and <code class="docutils literal notranslate"><span class="pre">j</span></code> columns. The <code class="docutils literal notranslate"><span class="pre">i</span></code> rows are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Rows(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the row - starting from 0 - which you want to access. The <code class="docutils literal notranslate"><span class="pre">j</span></code> columns are accessible by using the <code class="docutils literal notranslate"><span class="pre">.Item(n)</span></code> attribute, where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of the column - starting from 0 - which you want to access. It is useful to remind here that the user must have accessed the <code class="docutils literal notranslate"><span class="pre">Rows</span></code> attribute, therefore, if the user wanted to access the 2nd column on the 3rd row of the datatable they would use <code class="docutils literal notranslate"><span class="pre">.Rows(2).Item(1)</span></code> attribute.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the .NET API, a <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">object</span></code> corresponds to one table of in-memory data contained in a <code class="docutils literal notranslate"><span class="pre">DataSet</span> <span class="pre">object</span></code> from the class equally named. When you read an <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>, it is automatically assigned to a <code class="docutils literal notranslate"><span class="pre">DataSet</span></code> class and all the <code class="docutils literal notranslate"><span class="pre">Sheets</span></code> are saved into <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> classes - numbered from 0 to the quantity of sheets inside the <code class="docutils literal notranslate"><span class="pre">Excel</span> <span class="pre">file</span></code>. Here it is reminded that <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> objects are case sensitive.</p>
</div>
</div>
<div class="section" id="incrementing-id-and-batch-no-variables">
<h3>Incrementing Id and Batch No. variables<a class="headerlink" href="#incrementing-id-and-batch-no-variables" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will use the <strong>Assign</strong> Activity to increment the variables <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">batch_no</span></code>, as shown below.</p>
<p>First, drag an <strong>Assign</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Processing</span> <span class="pre">Logic</span></code> sequence.</p>
<p>Assign <code class="docutils literal notranslate"><span class="pre">id</span></code> to <code class="docutils literal notranslate"><span class="pre">id</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
<p>Drag another <strong>Assign</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Processing</span> <span class="pre">Logic</span></code> sequence.</p>
<p>Assign <code class="docutils literal notranslate"><span class="pre">batch_no</span></code> to <code class="docutils literal notranslate"><span class="pre">batch_no</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_examples_using_datatables_loop_through_increment_variables.png" src="images/openrpa_workflow_examples_using_datatables_loop_through_increment_variables.png" />
</div>
</div>
<div class="section" id="adding-datarows-and-updating-sql-table">
<h3>Adding DataRows and updating SQL Table<a class="headerlink" href="#adding-datarows-and-updating-sql-table" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will insert the acquired values into the two <code class="docutils literal notranslate"><span class="pre">DataTables</span></code>; <code class="docutils literal notranslate"><span class="pre">sqldt</span></code>: used to filter through and exhibit the values - and <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code>: used to update the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code> and commit the changes by using the <strong>Update from DataTable</strong> Activity.</p>
<p>First, drag an <strong>AddDataRow</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Processing</span> <span class="pre">Logic</span></code> sequence.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">sqldt</span></code> in the field containing the <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">to</span> <span class="pre">insert</span> <span class="pre">into</span></code>.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">{id,</span> <span class="pre">id_dataset,</span> <span class="pre">place_name,</span> <span class="pre">host_id,</span> <span class="pre">host_name,</span> <span class="pre">neighbourhood_group,</span> <span class="pre">neighbourhood,</span> <span class="pre">latitude,</span> <span class="pre">longitude,</span> <span class="pre">room_type,</span> <span class="pre">price,</span> <span class="pre">minimum_nights,</span> <span class="pre">number_of_reviews,</span> <span class="pre">last_review,</span> <span class="pre">reviews_per_month,</span> <span class="pre">calculated_host_listings_count,</span> <span class="pre">availability_365,</span> <span class="pre">batch_no}</span></code> inside the field containing the <code class="docutils literal notranslate"><span class="pre">Array</span> <span class="pre">of</span> <span class="pre">DataTable</span> <span class="pre">columns</span></code>.</p>
<p>Again, drag another <strong>AddDataRow</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Processing</span> <span class="pre">Logic</span></code> sequence.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code> in the field containing the <code class="docutils literal notranslate"><span class="pre">DataTable</span> <span class="pre">to</span> <span class="pre">insert</span> <span class="pre">into</span></code>.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">{id,</span> <span class="pre">id_dataset,</span> <span class="pre">place_name,</span> <span class="pre">host_id,</span> <span class="pre">host_name,</span> <span class="pre">neighbourhood_group,</span> <span class="pre">neighbourhood,</span> <span class="pre">latitude,</span> <span class="pre">longitude,</span> <span class="pre">room_type,</span> <span class="pre">price,</span> <span class="pre">minimum_nights,</span> <span class="pre">number_of_reviews,</span> <span class="pre">last_review,</span> <span class="pre">reviews_per_month,</span> <span class="pre">calculated_host_listings_count,</span> <span class="pre">availability_365,</span> <span class="pre">batch_no}</span></code> in the field containing the <code class="docutils literal notranslate"><span class="pre">Array</span> <span class="pre">of</span> <span class="pre">DataTable</span> <span class="pre">columns</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_update_datatables.png" src="images/openrpa_workflow_using_datatables_update_datatables.png" />
</div>
<p>Drag an <strong>Update from DataTable</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">&quot;airbnbdata&quot;</span></code> inside the <code class="docutils literal notranslate"><span class="pre">TableName</span></code> input field - ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Table</span> <span class="pre">to</span> <span class="pre">insert</span> <span class="pre">rows</span> <span class="pre">into</span></code>.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">sqlrawdt</span></code> inside the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> input field - ie. the one containing the <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">DataTable</span> <span class="pre">to</span> <span class="pre">save</span> <span class="pre">result</span> <span class="pre">into</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_update_from_datatable.png" src="images/openrpa_workflow_using_datatables_update_from_datatable.png" />
</div>
<p>Drag a <strong>WriteLine</strong> into the end of the sequence and insert <code class="docutils literal notranslate"><span class="pre">&quot;&quot;Successfully</span> <span class="pre">added</span> <span class="pre">data</span> <span class="pre">into</span> <span class="pre">MySQL</span> <span class="pre">DB.</span> <span class="pre">Number</span> <span class="pre">of</span> <span class="pre">rows</span> <span class="pre">added:</span> <span class="pre">&quot;</span> <span class="pre">+</span> <span class="pre">result.ToString&quot;</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">VB</span> <span class="pre">Expression</span></code>.</p>
</div>
<div class="section" id="executing-queries-into-the-data-inserted-and-visualizing-data">
<h3>Executing Queries into the Data Inserted and visualizing Data<a class="headerlink" href="#executing-queries-into-the-data-inserted-and-visualizing-data" title="Permalink to this headline">¶</a></h3>
<p>In this section, the user will learn how to use the querying activities to work with data inserted into the <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Table</span></code>.</p>
<p>First, drag an <strong>Execute Non Query</strong> activity into the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence. This activity simply executes a <code class="docutils literal notranslate"><span class="pre">SQL</span> <span class="pre">Query</span></code> and saves the number of rows affected into an <code class="docutils literal notranslate"><span class="pre">Int32</span></code> variable.</p>
<p>Here the user will delete the row of an arbitrary entry - ie. <code class="docutils literal notranslate"><span class="pre">217</span></code> - and save the resulting value of the operation into the <code class="docutils literal notranslate"><span class="pre">return217</span></code> variable.</p>
<p>Insert <code class="docutils literal notranslate"><span class="pre">&quot;DELETE</span> <span class="pre">from</span> <span class="pre">using_datatables.airbnbdata</span> <span class="pre">WHERE</span> <span class="pre">id</span> <span class="pre">=</span> <span class="pre">217;&quot;</span></code> inside the <code class="docutils literal notranslate"><span class="pre">Query</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">to</span> <span class="pre">execute</span></code>. This will delete the entry containing <code class="docutils literal notranslate"><span class="pre">id</span></code> no. 217. Save its result into a variable called <code class="docutils literal notranslate"><span class="pre">return217</span></code> by entering its name inside the <code class="docutils literal notranslate"><span class="pre">Result</span></code> property in the Activity’s <strong>Property Box</strong> and pressing <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code>. If it properly deletes the row, it should return an <code class="docutils literal notranslate"><span class="pre">Int32</span></code> variable containing the value <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
<p>Now, drag an <strong>Execute Query</strong> activity into the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence.</p>
<p>Insert “SELECT * FROM using_datatables.airbnbdata;” inside the <code class="docutils literal notranslate"><span class="pre">Query</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">to</span> <span class="pre">execute</span></code> and also insert <code class="docutils literal notranslate"><span class="pre">resultsDT</span></code> into the <code class="docutils literal notranslate"><span class="pre">DataTable</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">DataTable</span> <span class="pre">to</span> <span class="pre">save</span> <span class="pre">result</span> <span class="pre">into</span></code> and press <code class="docutils literal notranslate"><span class="pre">Ctrl+K</span></code> to create it. This will select all entries from the <code class="docutils literal notranslate"><span class="pre">airbnbdata</span> <span class="pre">SQL</span> <span class="pre">Table</span></code> and save it to the <code class="docutils literal notranslate"><span class="pre">resultsDT</span> <span class="pre">DataTable</span></code>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_execute_non_query_and_execute_query.png" src="images/openrpa_workflow_using_datatables_execute_non_query_and_execute_query.png" />
</div>
<p>Here the user will acquire the <code class="docutils literal notranslate"><span class="pre">place_name</span></code> of an arbitrary entry - ie. <code class="docutils literal notranslate"><span class="pre">213</span></code> - and save it to a variable named <code class="docutils literal notranslate"><span class="pre">place_name_value</span></code>.</p>
<p>Now, drag an <strong>Execute Scalar&lt;&gt;</strong> activity into the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence. A window will open where the user can select the type which will be returned by the <code class="docutils literal notranslate"><span class="pre">query</span></code>, in our case it is a <code class="docutils literal notranslate"><span class="pre">String</span></code>. Also insert <code class="docutils literal notranslate"><span class="pre">&quot;SELECT</span> <span class="pre">place_name</span> <span class="pre">FROM</span> <span class="pre">using_datatables.airbnbdata</span> <span class="pre">WHERE</span> <span class="pre">id</span> <span class="pre">=</span> <span class="pre">213;&quot;</span></code> into the <code class="docutils literal notranslate"><span class="pre">Query</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Query</span> <span class="pre">to</span> <span class="pre">execute</span></code>, and also enter <code class="docutils literal notranslate"><span class="pre">place_name_value</span></code> into the <code class="docutils literal notranslate"><span class="pre">Result</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">result</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">query</span></code>. This query will select the <code class="docutils literal notranslate"><span class="pre">place_name</span></code> value from the entry containing <code class="docutils literal notranslate"><span class="pre">id</span></code> no. <code class="docutils literal notranslate"><span class="pre">213</span></code> and save it into the <code class="docutils literal notranslate"><span class="pre">place_name_value</span></code> variable.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_execute_scalar_string.png" src="images/openrpa_workflow_using_datatables_execute_scalar_string.png" />
</div>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_execute_scalar_string_activity.png" src="images/openrpa_workflow_using_datatables_execute_scalar_string_activity.png" />
</div>
<p>Now the user will visualize the data inserted.</p>
<p>Since the first value - <code class="docutils literal notranslate"><span class="pre">return217</span></code> - is a number containing the number of rows affected and the query being run is expected to affect a single row, the user can check if its value is equal to <code class="docutils literal notranslate"><span class="pre">1</span></code> by using an <strong>If</strong> Activity and then write data to the output, depending whether or not the goal was achieved.</p>
<p>Drag an <strong>If</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence. Inside the <code class="docutils literal notranslate"><span class="pre">Condition</span></code> input field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">VB</span> <span class="pre">Expression</span></code>, insert <code class="docutils literal notranslate"><span class="pre">return217</span> <span class="pre">=</span> <span class="pre">1</span></code>.</p>
<p>Drag a <strong>WriteLine</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Then</span></code> sequence inside the <strong>If</strong> Activity and insert <code class="docutils literal notranslate"><span class="pre">&quot;Successfully</span> <span class="pre">deleted</span> <span class="pre">row</span> <span class="pre">no.</span> <span class="pre">217&quot;</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">Expression</span></code>.</p>
<p>Now, drag a <strong>WriteLine</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Else</span></code> sequence inside the <strong>If</strong> Activity and insert <code class="docutils literal notranslate"><span class="pre">&quot;Unable</span> <span class="pre">to</span> <span class="pre">delete</span> <span class="pre">row</span> <span class="pre">no.</span> <span class="pre">217&quot;</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">Expression</span></code> placeholder. This will only happen if the Activity wasn’t able to delete the row containing the <code class="docutils literal notranslate"><span class="pre">id</span></code> equal to <code class="docutils literal notranslate"><span class="pre">217</span></code>.</p>
<p>Drag a <strong>WriteLine</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence. Insert <code class="docutils literal notranslate"><span class="pre">&quot;place_name</span> <span class="pre">of</span> <span class="pre">row</span> <span class="pre">no.</span> <span class="pre">178:</span> <span class="pre">&quot;</span> <span class="pre">+</span> <span class="pre">resultsDT.Rows(178).Item(2).ToString</span></code> into the <code class="docutils literal notranslate"><span class="pre">Text</span></code> field, ie. the one containing the <code class="docutils literal notranslate"><span class="pre">Enter</span> <span class="pre">a</span> <span class="pre">VB</span> <span class="pre">Expression</span></code> placeholder. This will show the <code class="docutils literal notranslate"><span class="pre">place_name</span></code> value of the <code class="docutils literal notranslate"><span class="pre">178-ith</span></code> row of the table gathered with the <strong>Execute Query</strong> Activity.</p>
<p>Finally, drag another <strong>WriteLine</strong> Activity into the end of the <code class="docutils literal notranslate"><span class="pre">Database</span> <span class="pre">Scope</span></code> sequence. Insert <code class="docutils literal notranslate"><span class="pre">&quot;place_name</span> <span class="pre">of</span> <span class="pre">row</span> <span class="pre">no.</span> <span class="pre">213&quot;</span> <span class="pre">+</span> <span class="pre">place_name_value</span></code>. This will show the value gathered from the query executed with the <strong>Execute Scalar&lt;&gt;</strong> Activity.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_visualize_data.png" src="images/openrpa_workflow_using_datatables_visualize_data.png" />
</div>
</div>
<div class="section" id="using-a-dataview-to-filter-through-the-data">
<h3>Using a DataView to filter through the Data<a class="headerlink" href="#using-a-dataview-to-filter-through-the-data" title="Permalink to this headline">¶</a></h3>
<p>Now the user will use a <code class="docutils literal notranslate"><span class="pre">DataView</span></code> type to filter through the data.</p>
<p>First, drag an <strong>Assign</strong> Activity into the outermost sequence and assign <code class="docutils literal notranslate"><span class="pre">sqldtview</span></code> to <code class="docutils literal notranslate"><span class="pre">sqldt.DefaultView</span></code>. Also set its type as <code class="docutils literal notranslate"><span class="pre">System.Data.DataView</span></code>, so <strong>OpenRPA</strong> will be able to filter through it.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_assign_dataview.png" src="images/openrpa_workflow_using_datatables_assign_dataview.png" />
</div>
<p>Now, drag another <strong>Assign</strong> Activity into the outermost sequence and assign <code class="docutils literal notranslate"><span class="pre">sqldtview.RowFilter</span></code> to <code class="docutils literal notranslate"><span class="pre">&quot;id</span> <span class="pre">&gt;</span> <span class="pre">162&quot;.</span> <span class="pre">This</span> <span class="pre">will</span> <span class="pre">filter</span> <span class="pre">the</span> <span class="pre">``sqldt</span> <span class="pre">DataTable</span></code> to only acquire values upon which the <code class="docutils literal notranslate"><span class="pre">id</span></code> is greater than 162.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_assign_rowfilter.png" src="images/openrpa_workflow_using_datatables_assign_rowfilter.png" />
</div>
<p>Now, drag a <strong>Foreach DataRow</strong> Activity so we can filter through the data. Insert <code class="docutils literal notranslate"><span class="pre">sqldtview</span></code> as <code class="docutils literal notranslate"><span class="pre">DataView</span></code> in the <strong>Properties Box</strong>.</p>
<div class="figure align-center">
<img alt="images/openrpa_workflow_using_datatables_for_each_datarow_filter.png" src="images/openrpa_workflow_using_datatables_for_each_datarow_filter.png" />
</div>
<p>Finally, add a <strong>WriteLine</strong> Activity into the <code class="docutils literal notranslate"><span class="pre">Then</span></code> sequence and insert <code class="docutils literal notranslate"><span class="pre">&quot;Place</span> <span class="pre">name</span> <span class="pre">of</span> <span class="pre">row</span> <span class="pre">&quot;</span> <span class="pre">+</span> <span class="pre">row.Item(0).ToString</span> <span class="pre">+</span> <span class="pre">&quot;</span> <span class="pre">is:</span> <span class="pre">&quot;</span> <span class="pre">+</span> <span class="pre">row.Item(2).ToString</span></code> to exhibit the <code class="docutils literal notranslate"><span class="pre">place_name</span></code> value of the given row.</p>
<div class="figure align-default">
<img alt="images/openrpa_workflow_using_datatables_for_each_datarow_filter_drag_writeline.png" src="images/openrpa_workflow_using_datatables_for_each_datarow_filter_drag_writeline.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Thiago Pestitschek, Diego Thijssen, Tiago Bentivoglio, Paulo Veras

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
    <p>Powered by <a href="https://bpatechnologies.com/">BPA Technologies</a></p>
     


</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
  
        <h4>>Powered by BPA Technologies - bpatechnologies.com</h4>


</body>
</html>